<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
<title>
</title>
<meta http-equiv="Content-Type" content="text/html;charset=windows-1251">
</head>
<body TEXT="#000000" BGCOLOR="#E7E3E7"  LINK="#004080" VLINK="#004080" olink="#008080">
<table COLS="3" WIDTH="16%">
<tr>
<td>
<font face="Verdana" size="3">
<a href="Index14.html">
<img SRC="Back.gif" BORDER="0">
</a>
</font>
</td>
<td WIDTH="10%">
<font face="Verdana" size="3">
<a href="../index.html">
<img SRC="Menu.gif" BORDER="0">
</a>
</font>
</td>
<td ALIGN="RIGHT">
<font face="Verdana" size="3">
<a href="Index16.html">
<img SRC="For.gif" BORDER="0">
</a>
</font>
</td>
</tr>
</table>
<P><font face="Verdana" size="3">
&nbsp;
</font ></P>
<p align="center"> <font face="Verdana" size="3"> <strong>Критическая 
  секция</strong> <br>
</font>
</P>
<p align="left">
<font face="Verdana" size="3">

</font ></P>
<P><font face="Verdana" size="3">
Работая в Delphi, программист может также использовать объект типа критическая секция
(<font face="Verdana" size="2">critical section</font>). Критические секции подобны взаимным
исключениям по сути, однако между ними существуют два главных отличия:
</font ></P>
<ul>
  <li><font size="3" face="Verdana, Arial, Helvetica, sans-serif">&nbsp;взаимные исключения могут быть совместно использованы 
    потоками в различных процессах, а критические секции — нет;</font></li>
  <li><font size="3" face="Verdana, Arial, Helvetica, sans-serif">&nbsp;если критическая секция принадлежит другому потоку, 
    ожидающий поток блокируется вплоть до освобождения критической секции. В отличие 
    от этого, взаимное исключение разрешает продолжение по истечении тайм-аута.</font></li>
</ul>
<P><font face="Verdana" size="3">
Критические секции и взаимные исключения очень схожи. На первый взгляд, выигрыш от использования критической секции вместо взаимного исключения не очевиден. Критические секции, однако, более эффективны, чем взаимные исключения, т. к. используют меньше системных ресурсов. Взаимные исключения могут быть установлены на определенный интервал времени, по истечении которого выполнение продолжается; критическая секция всегда ждет столько, сколько потребуется.
</font ></P>
<P><font face="Verdana" size="3">
Возьмем класс <font face="Verdana" size="2">TCriticalSection</font> (модуль SYNCOBJS.PAS). Логика использования его проста — &quot;держать и не пущать&quot;. В многопотоковом приложении создается и инициализируется общая для всех потоков критическая секция. Когда один из потоков достигает критически важного участка кода, он пытается захватить секцию вызовом метода
<font face="Verdana" size="2">Enter</font>:
</font ></P>
<blockquote>
<P><font face="Verdana" size="3">
<font face="Verdana" size="2">
MySection.Enter; try DoSomethingCritical;</font>
</font ></P>
<P><font face="Verdana" size="3">
<font face="Verdana" size="2">
finally</font>
</font ></P>
<P><font face="Verdana" size="3">
<font face="Verdana" size="2">
MySection.Leave;&nbsp;</font>
</font ></P>
<P><font face="Verdana" size="3">
<font face="Verdana" size="2">end;</font>
</font ></P>
</blockquote>
<P><font face="Verdana" size="3">
Когда другие потоки доходят до оператора захвата секции
<font face="Verdana" size="2"> Enter</font> и обнаруживают, что она уже захвачена, они приостанавливаются вплоть до освобождения секции первым потоком путем вызова метода
<font face="Verdana" size="2">Leave</font>. Обратите внимание, что вызов
<font face="Verdana" size="2"> Leave</font> помещен в конструкцию<font face="Verdana" size="2">
try. .finally</font> — здесь требуется стопроцентная надежность. Критические секции являются системными объектами и подлежат обязательному освобождению — впрочем, как и остальные рассматриваемые здесь объекты.
</font ></P>
<P><font face="Verdana" size="3">
&nbsp;
</font ></P>
<table COLS="3" WIDTH="16%">
<tr>
<td>
<font face="Verdana" size="3">
<a href="Index14.html">
<img SRC="Back.gif" BORDER="0">
</a>
</font>
</td>
<td WIDTH="10%">
<font face="Verdana" size="3">
<a href="../index.html">
<img SRC="Menu.gif" BORDER="0">
</a>
</font>
</td>
<td ALIGN="RIGHT">
<font face="Verdana" size="3">
<a href="Index16.html">
<img SRC="For.gif" BORDER="0">
</a>
</font>
</td>
</tr>
</table>
</body>
</html>
