<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
<title>
</title>
<meta http-equiv="Content-Type" content="text/html;charset=windows-1251">
</head>
<body TEXT="#000000" BGCOLOR="#E7E3E7"  LINK="#004080" VLINK="#004080" olink="#008080">
<table COLS="3" WIDTH="16%">
<tr>
<td>
<font face="Verdana" size="3">
<a href="Index23.html">
<img SRC="Back.gif" BORDER="0">
</a>
</font>
</td>
<td WIDTH="10%">
<font face="Verdana" size="3">
<a href="../index.html">
<img SRC="Menu.gif" BORDER="0">
</a>
</font>
</td>
<td ALIGN="RIGHT">
<font face="Verdana" size="3">
<a href="Index25.html">
<img SRC="For.gif" BORDER="0">
</a>
</font>
</td>
</tr>
</table>
<P><font face="Verdana" size="3">
&nbsp;
</font ></P>
<p align="center"> <font face="Verdana" size="3"><b>—осто€ние записи </b><br>
</font>
</P>
<p align="left">
<font face="Verdana" size="3">

</font ></P>
<P><font face="Verdana" size="3">
 ласс <font face="Verdana" size="2"> TCustomADODataSet</font> обладает дополнительными возможност€ми, которые позвол€ют отслеживать состо€ние каждой записи.
</font ></P>
<P><font face="Verdana" size="3">
ƒл€ текущей записи набора данных можно определить ее состо€ние. ƒл€ этого предназначено свойство
</font ></P>
<blockquote>
<P><font face="Verdana" size="3">
<font face="Verdana" size="2">
TRecordStatus  =   (rsOK,   rsNew,   rsModified,   rsDeleted,   rsUnmodified, rslnvalid,   rsMultipleChanges,   rsPendingChanges,   rsCanceled, rsCantRelease,   rsConcurrencyViolation,   rsIntegrityViolation, rsMaxChangesExceeded,   rsObjectOpen,   rsOutOfMemory,   rsPermissionDenied, rsSchemaViolation,   rsDBDeleted); property RecordStatus:   TRecordStatusSet;</font>
</font ></P>
</blockquote>
<P><font face="Verdana" size="3">
где <font face="Verdana" size="2"> rsOK</font> Ч запись успешно сохранена;
<font face="Verdana" size="2">rsNew</font> Ч запись добавлена;
<font face="Verdana" size="2"> rsModified</font> Ч запись была изменена;
<font face="Verdana" size="2"> rsDeleted</font> Ч запись удалена; rsUnmodified Ч запись без изменений;
<font face="Verdana" size="2"> rslnvalid</font> Ч запись не может быть сохранена из-за неверной закладки;
<font face="Verdana" size="2"> rsMultipleChanges</font> Ч запись не может быть сохранена из-за множественных изменений;
<font face="Verdana" size="2"> rsPendingChanges</font> Ч запись не может быть сохранена из-за ссылки на несохраненные изменени€;
<font face="Verdana" size="2"> rsCanceled</font> Ч операци€ с записью была отменена;
<font face="Verdana" size="2"> rsCantRelease</font> Ч запись заблокирована;
<font face="Verdana" size="2"> rsConcurrencyViolation</font> Ч запись не может быть сохранена из-за типа блокировки;
<font face="Verdana" size="2"> rsintegrityvioiation</font> Ч нарушена ссылочна€ целостность;
<font face="Verdana" size="2"> rsMaxChangesExceeded</font> Ч
слишком много изменений; <font face="Verdana" size="2"> rsObjectOpen</font> Ч конфликт с объектом базы данных;
<font face="Verdana" size="2"> rsoutofMemory</font> Ч недостаток пам€ти,
<font face="Verdana" size="2">rsPermissionDenied</font> Ч нет доступа;
<font face="Verdana" size="2"> rsSchemaViolation</font> Ч
нарушение структуры данных; <font face="Verdana" size="2"> rsDBDeleted</font> Ч запись удалена в Ѕƒ.
</font ></P>
<P><font face="Verdana" size="3">
 ак видите, благодар€ этому свойству состо€ние отдельной записи может
быть определено очень точно.
</font ></P>
<P><font face="Verdana" size="3">
 роме этого, метод
</font ></P>
<blockquote>
<P><font face="Verdana" size="3">
<font face="Verdana" size="2">
type</font>
</font ></P>
<P><font face="Verdana" size="3">
<font face="Verdana" size="2">
TUpdateStatus = (usUnmodified, usModifled, uslnserted, usDeleted);</font>
</font ></P>
<P><font face="Verdana" size="3">
<font face="Verdana" size="2">&nbsp;function UpdateStatus: TUpdateStatus; override;</font>
</font ></P>
</blockquote>
<P><font face="Verdana" size="3">
возвращает информацию о состо€нии текущей записи.
</font ></P>
<P><font face="Verdana" size="3">
—оответственно до и после изменени€ записи вызываютс€ методы-обработчики
</font ></P>
<blockquote>
<P><font face="Verdana" size="3">
<font face="Verdana" size="2">
TWillChangeRecordEvent = procedure(DataSet: TCustomADODataSet; const Reason: TEventReason;&nbsp;</font>
</font ></P>
<P><font face="Verdana" size="3">
<font face="Verdana" size="2"> const RecordCount: Integer;&nbsp;</font>
</font ></P>
<P><font face="Verdana" size="3">
<font face="Verdana" size="2"> var EventStatus: TEventStatus) of object;</font>
</font ></P>
<P><font face="Verdana" size="3">
<font face="Verdana" size="2">&nbsp;property OnWillChangeRecord: TWillChangeRecordEvent;</font>
</font ></P>
</blockquote>
<P><font face="Verdana" size="3">
»
</font ></P>
<blockquote>
<P><font face="Verdana" size="3">
<font face="Verdana" size="2">
TRecordChangeCompleteEvent = procedure(DataSet: TCustomADODataSet; const Reason:
TEventReason;</font>
</font ></P>
<P><font face="Verdana" size="3">
<font face="Verdana" size="2">const RecordCount: Integer; const Error: Error;&nbsp;</font>
</font ></P>
<P><font face="Verdana" size="3">
<font face="Verdana" size="2"> var EventStatus: TEventStatus) of object;</font>
</font ></P>
<P><font face="Verdana" size="3">
<font face="Verdana" size="2">property OnRecordChangeComplete:</font>
</font ></P>
<P><font face="Verdana" size="3">
<font face="Verdana" size="2">TrecordChangeCompleteEvent;</font>
</font ></P>
</blockquote>
<P><font face="Verdana" size="3">
где параметр <font face="Verdana" size="2"> Reason</font> позвол€ет узнать, какой метод изменил записи, а параметр
<font face="Verdana" size="2"> RecordCount</font> возвращает число измененных записей.
</font ></P>
<P><font face="Verdana" size="3">
&nbsp;
</font ></P>
<table COLS="3" WIDTH="16%">
<tr>
<td>
<font face="Verdana" size="3">
<a href="Index23.html">
<img SRC="Back.gif" BORDER="0">
</a>
</font>
</td>
<td WIDTH="10%">
<font face="Verdana" size="3">
<a href="../index.html">
<img SRC="Menu.gif" BORDER="0">
</a>
</font>
</td>
<td ALIGN="RIGHT">
<font face="Verdana" size="3">
<a href="Index25.html">
<img SRC="For.gif" BORDER="0">
</a>
</font>
</td>
</tr>
</table>
</body>
</html>
