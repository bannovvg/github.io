<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
<title>
</title>
<meta http-equiv="Content-Type" content="text/html;charset=windows-1251">
</head>
<body TEXT="#000000" BGCOLOR="#E7E3E7"  LINK="#004080" VLINK="#004080" olink="#008080">
<table COLS="3" WIDTH="16%">
<tr>
<td>
<font face="Verdana" size="3">
<a href="Index1.html">
<img SRC="Back.gif" BORDER="0">
</a>
</font>
</td>
<td WIDTH="10%">
<font face="Verdana" size="3">
<a href="../index.html">
<img SRC="Menu.gif" BORDER="0">
</a>
</font>
</td>
<td ALIGN="RIGHT">
<font face="Verdana" size="3">
<a href="Index3.html">
<img SRC="For.gif" BORDER="0">
</a>
</font>
</td>
</tr>
</table>
<P><font face="Verdana" size="3">
&nbsp;
</font ></P>
<p align="center">
<font face="Verdana" size="3">
<font size="4">Основы ADO</font>
<br>
</font>
</P>
<p align="left">
<font face="Verdana" size="3">

</font ></P>
<P><font face="Verdana" size="3">
Технология Microsoft ActiveX Data Objects обеспечивает универсальный доступ к источникам данных из приложений БД. Такую возможность предоставляют функции набора интерфейсов, созданные на основе общей модели объектов СОМ и описанные в спецификации OLE DB.
</font ></P>
<P><font face="Verdana" size="3">
Технология ADO и интерфейсы OLE DB обеспечивают для приложений единый способ доступа к источникам данных различных типов (рис. 19.1). Например, приложение, использующее ADO, может применять одинаково сложные операции и к данным, хранящимся на корпоративном сервере SQL, и к электронным таблицам, и локальным СУБД. Запрос SQL, направленный любому источнику данных через ADO, будет выполнен.
</font ></P>
<p align="center">
<div align="center"><IMG src="gl.19.1.gif" > </div>
<P align="center"><font face="Verdana" size="3"> <B>Рис. 19.1. </B>Схема доступа 
  к данным через ADO </font ></P>
<P><font face="Verdana" size="3"> Возникает вопрос: каким образом источники данных 
  смогут выполнить этот запрос? </font ></P>
<P><font face="Verdana" size="3"> За серверы БД беспокоиться не стоит, обработка 
  запросов SQL — это их основная обязанность. Но как быть с файловыми последовательностями, 
  электронными таблицами, файлами электронной почты и т. д.? Здесь на помощь приходят 
  механизмы ADO и интерфейсы OLE DB. </font ></P>
<P><font face="Verdana" size="3"> OLE DB представляет собой набор специализированных 
  объектов СОМ, инкапсулирующих стандартные функции обработки данных, и специализированные 
  функции конкретных источников данных и интерфейсов, обеспечивающих передачу 
  данных между объектами. </font ></P>
<P><font face="Verdana" size="3"> Согласно терминологии ADO, любой источник данных 
  (база данных, электронная таблица, файл) называется хранилищем данных, с которым 
  при помощи провайдера данных взаимодействует приложение. Минимальный набор компонентов 
  приложения может включать объект соединения, объект набора данных, объект процессора 
  запросов. </font ></P>
<P><font face="Verdana" size="3"> <B>Примечание&nbsp;</B> </font ></P>
<blockquote> 
  <P><font face="Verdana" size="3"> Объекты OLE DB создаются и функционируют так 
    же, как и другие объекты СОМ. Каждому объекту соответствует идентификатор 
    класса CLSID, хранящийся в системном реестре. Для создания объекта используется 
    метод <font face="Verdana" size="2"> CoCreateinstance</font> и соответствующая 
    фабрика класса. Объекту соответствует набор интерфейсов, к методам которых 
    можно обращаться после создания объекта. </font ></P>
</blockquote>
<P><font face="Verdana" size="3"> В результате приложение обращается не прямо 
  к источнику данных, а к объекту OLE DB, который &quot;умеет&quot; представить 
  данные (например, из файла электронной почты) в виде таблицы БД или результата 
  выполнения запроса SQL. </font ></P>
<P><font face="Verdana" size="3"> Технология ADO в целом включает в себя не только 
  сами объекты OLE DB, но и механизмы, обеспечивающие взаимодействие объектов 
  с данными и приложениями. На этом уровне важнейшую роль играют провайдеры ADO, 
  координирующие работу приложений с хранилищами данных различных типов. </font ></P>
<P><font face="Verdana" size="3"> Такая архитектура позволяет сделать набор объектов 
  и интерфейсов открытым и расширяемым. Набор объектов и соответствующий провайдер 
  может быть создан для любого хранилища данных без внесения изменений в исходную 
  структуру ADO. При этом существенно расширяется само понятие данных — ведь можно 
  разработать набор объектов и интерфейсов и для нетрадиционных табличных данных. 
  Например, это могут быть графические данные геоинформационных систем, древовидные 
  структуры из системных реестров, данные CASE-инструментов и т. д. </font ></P>
<P><font face="Verdana" size="3"> Так как технология ADO основана на стандартных 
  интерфейсах СОМ, которые являются системным механизмом Windows, это сокращает 
  общий объем работающего программного кода и позволяет распространять приложения 
  БД без вспомогательных программ и библиотек. </font ></P>
<P><font face="Verdana" size="3"> <B> Примечание&nbsp;</B> </font ></P>
<blockquote> 
  <P><font face="Verdana" size="3"> Нижеследующее описание спецификации OLE DB 
    представлено в соответствии с официальной терминологией Microsoft для данной 
    предметной области. </font ></P>
</blockquote>
<P><font face="Verdana" size="3"> Спецификация OLE DB различает следующие типы 
  объектов, которые будут рассмотрены ниже. </font ></P>
<ul>
  <li>&nbsp;<font size="3" face="Verdana, Arial, Helvetica, sans-serif">Перечислитель 
    (Enumerator) выполняет поиск источников данных или других перечислителей. 
    Используется для обеспечения функционирования провайдеров ADO.</font></li>
  <li><font size="3" face="Verdana, Arial, Helvetica, sans-serif">&nbsp;Объект-источник 
    данных (Data Source Object) представляет хранилище данных.</font></li>
  <li><font size="3" face="Verdana, Arial, Helvetica, sans-serif">&nbsp;Сессия 
    (Session) объединяет совокупность объектов, обращающихся к одному хранилищу 
    данных.</font></li>
  <li><font size="3" face="Verdana, Arial, Helvetica, sans-serif">&nbsp;Транзакция 
    (Trasaction) инкапсулирует механизм выполнения транзакции.</font></li>
  <li><font size="3" face="Verdana, Arial, Helvetica, sans-serif">&nbsp;Команда 
    (Command) содержит текст команды и обеспечивает ее выполнение. Командой может 
    быть запрос SQL, обращение к таблице БД и т. д.</font></li>
  <li><font size="3" face="Verdana, Arial, Helvetica, sans-serif">&nbsp;Набор 
    рядов (Rowset) представляет собой совокупность строк данных, являющихся результатом 
    выполнения команды ADO.</font></li>
  <li><font size="3" face="Verdana, Arial, Helvetica, sans-serif">&nbsp;Объект-ошибка 
    (Error) содержит информацию об исключительной ситуации.</font></li>
</ul>
<P><font face="Verdana" size="3"> Рассмотрим функциональные возможности основных 
  объектов и интерфейсов OLE DB. </font ></P>
<P><font face="Verdana" size="3"> &nbsp; </font ></P>
<table COLS="3" WIDTH="16%">
  <tr> 
    <td> <font face="Verdana" size="3"> <a href="Index1.html"> <img SRC="Back.gif" BORDER="0"> 
      </a> </font> </td>
    <td WIDTH="10%"> <font face="Verdana" size="3"> <a href="../index.html"> <img SRC="Menu.gif" BORDER="0"> 
      </a> </font> </td>
    <td ALIGN="RIGHT"> <font face="Verdana" size="3"> <a href="Index3.html"> <img SRC="For.gif" BORDER="0"> 
      </a> </font> </td>
  </tr>
</table>
</body>
</html>
