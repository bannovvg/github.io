<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
<title>
</title>
<meta http-equiv="Content-Type" content="text/html;charset=windows-1251">
</head>
<body TEXT="#000000" BGCOLOR="#E7E3E7"  LINK="#004080" VLINK="#004080" olink="#008080">
<table COLS="3" WIDTH="16%">
<tr>
<td>
<font face="Verdana" size="3">
<a href="Index1.html">
<img SRC="Back.gif" BORDER="0">
</a>
</font>
</td>
<td WIDTH="10%">
<font face="Verdana" size="3">
<a href="../index.html">
<img SRC="Menu.gif" BORDER="0">
</a>
</font>
</td>
<td ALIGN="RIGHT">
<font face="Verdana" size="3">
<a href="Index3.html">
<img SRC="For.gif" BORDER="0">
</a>
</font>
</td>
</tr>
</table>
<P><font face="Verdana" size="3">
&nbsp;
</font ></P>
<p align="center">
<font face="Verdana" size="3">
<font size="4">Как работает приложение баз данных</font>
<br>
</font>
</P>
<p align="left">
<font face="Verdana" size="3">

</font ></P>
<P><font face="Verdana" size="3">
В Репозитории Delphi отсутствует отдельный шаблон для приложения баз данных. Поэтому, как и любое другое приложение Delphi, приложение баз данных начинается с обычной формы. Безусловно, это оправданный подход, т. к. приложение баз данных имеет пользовательский интерфейс.
И этот интерфейс создается с использованием стандартных и специализированных визуальных компонентов на обычных формах.
</font ></P>
<P><font face="Verdana" size="3">
Визуальные компоненты отображения данных расположены на странице <B>Data Controls </B>Палитры компонентов. В большинстве они представляют собой модификации стандартных элементов управления, приспособленных для работы с набором данных (см. гл. 15).
</font ></P>
<P><font face="Verdana" size="3">
Приложение может содержать произвольное число форм и использовать любой интерфейс (MDI или SDI). Обычно одна форма отвечает за выполнение группы однородных операций, объединенных общим назначением.
</font ></P>
<P><font face="Verdana" size="3">
В основе любого приложения баз данных лежат наборы данных,
которые представляют собой группы записей (их удобно представить в виде таблиц в памяти), переданных из базы данных в приложение для просмотра и редактирования. Каждый набор данных инкапсулирован в специальном компоненте доступа к данным. В VCL Delphi реализован набор базовых классов, поддерживающих функциональность наборов данных, и практически идентичные по составу наборы дочерних компонентов для технологий доступа к данным. Их общий предок — класс
<font face="Verdana" size="2">TDataSet</font>. (Подробно наборы данных рассмотрены в гл. 12.)
</font ></P>
<P><font face="Verdana" size="3">
Для обеспечения связи набора данных с визуальными компонентами отображения данных используется специальный компонент
<font face="Verdana" size="2">TDataSource</font>. Его роль заключается в управлении потоками данных между набором данных и связанными с ним компонентами отображения данных. Этот компонент обеспечивает передачу данных в визуальные компоненты и возврат результатов редактирования в набор данных, отвечает за изменение состояния визуальных компонентов при изменении состояния набора данных, передает
сигналы управления от пользователя (визуальных компонентов) в набор данных. Компонент
<font face="Verdana" size="2"> TDataSource</font> расположен на странице <B>Data </B><b>Access</b> Палитры компонентов.
</font ></P>
<P><font face="Verdana" size="3">
Таким образом, базовый механизм доступа к данным создается триадой компонентов:
</font ></P>
<ul>
  <li>&nbsp;<font size="3" face="Verdana, Arial, Helvetica, sans-serif">компоненты, инкапсулирующие набор данных (потомки класса</font> 
    <font face="Verdana" size="2">TDataSet</font>);</li>
  <li> <B>&nbsp; </B><font size="3" face="Verdana, Arial, Helvetica, sans-serif">компоненты 
    </font><font face="Verdana" size="2">TDataSource</font>;</li>
  <li>&nbsp;<font size="3" face="Verdana, Arial, Helvetica, sans-serif">визуальные компоненты отображения данных.</font></li>
</ul>
<P><font face="Verdana" size="3">
Рассмотрим схему взаимодействия этих компонентов в приложении баз данных (рис. 11.1).
</font ></P>
<P><font face="Verdana" size="3">
В приложении с источником данных или промежуточным программным обеспечением взаимодействует компонент доступа к данным, который инкапсулирует набор данных и обращается к функциям соответствующей технологии доступа к данным для выполнения различных операций. Компонент доступа к данным представляет собой &quot;образ&quot; таблицы базы данных в приложении. Общее число таких компонентов в приложении не ограничено.
</font ></P>
<P><font face="Verdana" size="3">
С каждым компонентом доступа к данным может быть связан как минимум один компонент
<font face="Verdana" size="2">TDataSource</font>. В его обязанности входит соединение набора данных с визуальными компонентами отображения данных. Компонент
<font face="Verdana" size="2"> TDataSource</font> обеспечивает передачу в эти компоненты текущих значений полей из набора данных и возврат в него сделанных изменений.
</font ></P>
<P><font face="Verdana" size="3">
Еще одна функция компонента <font face="Verdana" size="2"> TDataSource</font> заключается в синхронизации поведения компонентов отображения данных с состоянием набора данных. Например, если набор данных не активен, то компонент
<font face="Verdana" size="2"> TDataSource</font> обеспечивает удаление данных из компонентов отображения данных и их перевод в неактивное состояние. Или, если набор данных работает в режиме &quot;только для чтения&quot;, то компонент
<font face="Verdana" size="2"> TDataSource</font> обязан передать в компоненты отображения данных запрещение на изменение данных.
</font ></P>
<P><font face="Verdana" size="3">
С одним компонентом <font face="Verdana" size="2"> TDataSource</font> могут быть связаны несколько визуальных компонентов отображения данных. Эти компоненты представляют собой модифицированные элементы управления, которые предназначены для показа информации из наборов данных.
</font ></P>
<P><font face="Verdana" size="3">
При открытии набора данных компонент обеспечивает передачу в набор данных записей из требуемой таблицы БД. Курсор набора данных устанавливается на первую запись. Компонент
<font face="Verdana" size="2"> TDataSource</font> организует передачу в компоненты отображения данных значений необходимых полей из текущей записи. При перемещении по записям набора данных текущие значения полей в компонентах отображения данных автоматически обновляются.
</font ></P>
<p align="center">
<div align="center"><IMG src="gl.11.1.gif" > </div>
<P align="center"><font face="Verdana" size="3"> <B>Рис. 11.1. </B>Механизм доступа 
  к данным приложения баз данных </font ></P>
<P><font face="Verdana" size="3"> Пользователь при помощи компонентов отображения 
  данных может просматривать и редактировать данные. Измененные значения сразу 
  же передаются из элемента управления в набор данных при помощи компонента <font face="Verdana" size="2">TDataSource</font>. 
  Затем изменения могут быть переданы в базу данных или отменены. </font ></P>
<P><font face="Verdana" size="3"> Теперь, имея общее представление о работе приложения 
  баз данных, перейдем к поэтапному рассмотрению процесса создания такого приложения. 
  </font ></P>
<P><font face="Verdana" size="3"> &nbsp; </font ></P>
<table COLS="3" WIDTH="16%">
  <tr> 
    <td> <font face="Verdana" size="3"> <a href="Index1.html"> <img SRC="Back.gif" BORDER="0"> 
      </a> </font> </td>
    <td WIDTH="10%"> <font face="Verdana" size="3"> <a href="../index.html"> <img SRC="Menu.gif" BORDER="0"> 
      </a> </font> </td>
    <td ALIGN="RIGHT"> <font face="Verdana" size="3"> <a href="Index3.html"> <img SRC="For.gif" BORDER="0"> 
      </a> </font> </td>
  </tr>
</table>
</body>
</html>
