<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
<title>
</title>
<meta http-equiv="Content-Type" content="text/html;charset=windows-1251">
</head>
<body TEXT="#000000" BGCOLOR="#E7E3E7"  LINK="#004080" VLINK="#004080" olink="#008080">
<table COLS="3" WIDTH="16%">
<tr>
<td>
<font face="Verdana" size="3">
<a href="Index11.html">
<img SRC="Back.gif" BORDER="0">
</a>
</font>
</td>
<td WIDTH="10%">
<font face="Verdana" size="3">
<a href="../index.html">
<img SRC="Menu.gif" BORDER="0">
</a>
</font>
</td>
<td ALIGN="RIGHT">
<font face="Verdana" size="3">
<a href="Index13.html">
<img SRC="For.gif" BORDER="0">
</a>
</font>
</td>
</tr>
</table>
<P><font face="Verdana" size="3">
&nbsp;
</font ></P>
<p align="center">
<font face="Verdana" size="3">
<font size="4">Создание нового компонента на базе элементов управления из библиотеки ComCtl32</font>
<br>
</font>
</P>
<p align="left">
<font face="Verdana" size="3">

</font ></P>
<P><font face="Verdana" size="3">
С каждой версией Internet Explorer Microsoft поставляет новую библиотеку ComQ132 с новыми элементами управления. Программисты Borland пытаются поспеть за ними, но получается это не всегда. Так что полезно было бы и самому научиться создавать оболочку для новых и необходимых элементов управления, тем более, что это несложно. Рассмотрим это на примере.
</font ></P>
<P><font face="Verdana" size="3">
Подходящей кандидатурой может служить редактор IP-адресов, появившийся в версии библиотеки 4.71 (Internet Explorer 4.0). Это элемент, упрощающий редактирование адресов для многих Internet-компонентов и приложений.
</font ></P>
<p align="center"> 
<div align="center"><IMG src="gl.5.8.gif" > </div>
<P align="center"><font face="Verdana" size="3"> <B>Рис. 5.8. </B>Мастер создания 
  новых компонентов Delphi 7 </font ></P>
<P><font face="Verdana" size="3"> Мастер создания новых компонентов (рис. 5.8) 
  создаст для нас шаблон. Поскольку элементы из состава библиотеки ComCtl32 есть 
  не что иное, как окна со специфическими свойствами, наш компонент мы породим 
  от <font face="Verdana" size="2">TWinControl</font>. IP-редактор представляет 
  собой окно класса <font face="Verdana" size="2">WC_IPADDRESS</font>. </font ></P>
<P><font face="Verdana" size="3"> Название нового компонента выбрано <font face="Verdana" size="2">TCustomiPEdit</font>. 
  Такая схема принята разработчиками Delphi для большинства компонентов VCL. Непосредственным 
  предком, допустим, <font face="Verdana" size="2"> TEdit</font> является компонент 
  <font face="Verdana" size="2">TCustomEdit</font>. </font ></P>
<P><font face="Verdana" size="3"> Первым делом при создании компонента — особо 
  не раздумывая — следует опубликовать типовые свойства и события, которые есть 
  у большинства визуальных компонентов. Чтобы не занимать место в книге, позаимствуем 
  их список у любого другого компонента из модуля <font face="Verdana" size="2">ComCtrls.</font>pas. 
  </font ></P>
<P><font face="Verdana" size="3"> Далее приступим к описанию свойств, которыми 
  будет отличаться наш компонент от других. Возможности, предоставляемые IP-редактором, 
  описаны в справочной системе MSDN. Визуально он состоит из четырех полей, разделенных 
  точками (рис. 5.9). </font ></P>
<p align="center">
 
<div align="center"><IMG src="gl.5.9.gif" > </div>
<P align="center"><font face="Verdana" size="3"> <B>Рис. 5.9. </B>Тестовое приложение, 
  содержащее IP-редактор (внизу) </font ></P>
<P><font face="Verdana" size="3"> Для каждого из полей можно задать отдельно верхнюю 
  и нижнюю границы допустимых значений. Это удобно, если вы планируете работать 
  с адресами какой-либо конкретной IP-сети. По умолчанию границы равны 0—255. 
  </font ></P>
<P><font face="Verdana" size="3"> Элемент управления обрабатывает шесть сообщений 
  (см. документацию MSDN), которые сведены в табл. 5.8. </font ></P>
<P align="center"><font face="Verdana" size="3"> <B>Таблица 5.8. </B>Сообщения, 
  обрабатываемые элементом управления<font face="Verdana" size="2"> IP Address 
  Control</font> </font ></P>
<TABLE FRAME="BOX" RULES="ALL" BORDER="1" CELLSPACING="0" CELLPADDING="0" WIDTH="510" HEIGHT="214">
  <TR ALIGN="LEFT" VALIGN="TOP"> 
    <TD COLSPAN="1" ALIGN="LEFT" VALIGN="TOP" WIDTH="139" HEIGHT="31"> <DIV WIDTH="183" HEIGHT="31" style="width: 86; height: 31"> 
        <P><font face="Verdana" size="3"> <b> Сообщение</b> </font ></P>
      </DIV></TD>
    <TD COLSPAN="1" ALIGN="LEFT" VALIGN="TOP" WIDTH="379" HEIGHT="31"> <DIV WIDTH="444" HEIGHT="31" style="width: 98; height: 31"> 
        <P><font face="Verdana" size="3"> <b> Назначение</b> </font ></P>
      </DIV></TD>
  </TR>
  <TR ALIGN="LEFT" VALIGN="TOP"> 
    <TD COLSPAN="1" ROWSPAN="1" ALIGN="LEFT" VALIGN="TOP" WIDTH="139" HEIGHT="31"> 
      <DIV WIDTH="183" HEIGHT="31" style="width: 133; height: 31"> 
        <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> IPM CLEARADDRESS</font> 
          </font ></P>
      </DIV></TD>
    <TD COLSPAN="1" ROWSPAN="1" ALIGN="LEFT" VALIGN="TOP" WIDTH="379" HEIGHT="31"> 
      <DIV WIDTH="444" HEIGHT="31" style="width: 161; height: 31"> 
        <P><font face="Verdana" size="3"> Очистить поле адреса </font ></P>
      </DIV></TD>
  </TR>
  <TR ALIGN="LEFT" VALIGN="TOP"> 
    <TD COLSPAN="1" ROWSPAN="1" ALIGN="LEFT" VALIGN="TOP" WIDTH="139" HEIGHT="31"> 
      <DIV WIDTH="183" HEIGHT="31" style="width: 117; height: 32"> 
        <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> IPM GETADDRESS</font> 
          </font ></P>
      </DIV></TD>
    <TD COLSPAN="1" ROWSPAN="1" ALIGN="LEFT" VALIGN="TOP" WIDTH="379" HEIGHT="31"> 
      <DIV WIDTH="444" HEIGHT="31" style="width: 111; height: 31"> 
        <P><font face="Verdana" size="3"> Считать адрес </font ></P>
      </DIV></TD>
  </TR>
  <TR ALIGN="LEFT" VALIGN="TOP"> 
    <TD COLSPAN="1" ROWSPAN="1" ALIGN="LEFT" VALIGN="TOP" WIDTH="139" HEIGHT="29"> 
      <DIV WIDTH="183" HEIGHT="29" style="width: 92; height: 29"> 
        <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> IPM_ISBLANK</font> 
          </font ></P>
      </DIV></TD>
    <TD COLSPAN="1" ROWSPAN="1" ALIGN="LEFT" VALIGN="TOP" WIDTH="379" HEIGHT="29"> 
      <DIV WIDTH="444" HEIGHT="29" style="width: 257; height: 29"> 
        <P><font face="Verdana" size="3"> Проверить, не пустое ли поле адреса 
          </font ></P>
      </DIV></TD>
  </TR>
  <TR ALIGN="LEFT" VALIGN="TOP"> 
    <TD COLSPAN="1" ROWSPAN="1" ALIGN="LEFT" VALIGN="TOP" WIDTH="139" HEIGHT="23"> 
      <DIV WIDTH="183" HEIGHT="23" style="width: 115; height: 23"> 
        <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> IPM SETADDRESS</font> 
          </font ></P>
      </DIV></TD>
    <TD COLSPAN="1" ROWSPAN="1" ALIGN="LEFT" VALIGN="TOP" WIDTH="379" HEIGHT="23"> 
      <DIV WIDTH="444" HEIGHT="23" style="width: 129; height: 23"> 
        <P><font face="Verdana" size="3"> Установить адрес </font ></P>
      </DIV></TD>
  </TR>
  <TR ALIGN="LEFT" VALIGN="TOP"> 
    <TD COLSPAN="1" ROWSPAN="1" ALIGN="LEFT" VALIGN="TOP" WIDTH="139" HEIGHT="31"> 
      <DIV WIDTH="183" HEIGHT="31" style="width: 99; height: 31"> 
        <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> IPM_SETFOCUS</font> 
          </font ></P>
      </DIV></TD>
    <TD COLSPAN="1" ROWSPAN="1" ALIGN="LEFT" VALIGN="TOP" WIDTH="379" HEIGHT="31"> 
      <DIV WIDTH="444" HEIGHT="31" style="width: 375; height: 31"> 
        <P><font face="Verdana" size="3"> Передать фокус заданному полю элемента 
          управления </font ></P>
      </DIV></TD>
  </TR>
  <TR ALIGN="LEFT" VALIGN="TOP"> 
    <TD COLSPAN="1" ROWSPAN="1" ALIGN="LEFT" VALIGN="TOP" WIDTH="139" HEIGHT="38"> 
      <DIV WIDTH="183" HEIGHT="38" style="width: 101; height: 38"> 
        <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> IPM_SETRANGE</font> 
          </font ></P>
      </DIV></TD>
    <TD COLSPAN="1" ROWSPAN="1" ALIGN="LEFT" VALIGN="TOP" WIDTH="379" HEIGHT="38"> 
      <DIV WIDTH="444" HEIGHT="38" style="width: 375; height: 38"> 
        <P><font face="Verdana" size="3"> Установить ограничения на значения в 
          заданном поле </font ></P>
      </DIV></TD>
  </TR>
</TABLE>
<P><font face="Verdana" size="3"> Кроме перечисленных, IP-редактор извещает приложение 
  об изменениях, произведенных пользователем, путем посылки ему сообщения <font face="Verdana" size="2">WM_NOTIFY</font>. 
  </font ></P>
<P><font face="Verdana" size="3"> Следует иметь в виду, что IP-редактор не является 
  потомком обычного редактора (<font face="Verdana" size="2">TCustomEdit</font>) 
  и не обрабатывает характерные для того сообщения <font face="Verdana" size="2"> 
  ЕМ_ХХХХ</font>, так что название <font face="Verdana" size="2"> TCustomipEdit</font> 
  отражает только внешнее сходство. </font ></P>
<P><font face="Verdana" size="3"> В создаваемом коде компонента первым делом нужно 
  переписать конструктор <font face="Verdana" size="2"> Create</font> и метод 
  <font face="Verdana" size="2">createParams</font>. Последний метод вызывается 
  перед созданием окна для установки его будущих параметров. Именно здесь нужно 
  инициализировать библиотеку общих элементов управления ComCtl32 и породить новый 
  класс окна. </font ></P>
<blockquote> 
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> constructor 
    TIPEditor.Create(AOwner: TComponent);</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2">&nbsp;begin</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> inherited Create(AOwner);</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> ControlStyle 
    := [csCaptureMouse, csClickEvents, csDoubleClicks, csOpaque];</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> Color := clBtnFace;</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> Width := 160;</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> Height := 25;</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> Align := alNone;&nbsp;</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2">end;</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> procedure TIPEditor.CreateParams(var 
    Params: TCreateParams);</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2">&nbsp;begin</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> InitCommonControl(ICC_INTERNET_CLASSES);</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> inherited CreateParams(Params);</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> CreateSubClass(Params, 
    WC_IPADDRESS);&nbsp;</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2">end;</font> 
    </font ></P>
</blockquote>
<P><font face="Verdana" size="3"> После создания свое значение получает дескриптор 
  окна <font face="Verdana" size="2"> Handle</font> (это свойство унаследовано 
  от <font face="Verdana" size="2">TwinControl</font>). Все чтение/запись свойств 
  элемента происходит путем обмена сообщениями с использованием этого дескриптора. 
  Минимально необходимыми для работы являются свойства IP (задает IP-адрес в редакторе), 
  <font face="Verdana" size="2"> ipstring</font> (отображает его в виде текстовой 
  строки) и процедура <font face="Verdana" size="2"> clear</font> (очищает редактор). 
  </font ></P>
<P><font face="Verdana" size="3"> Реализовано это следующим образом: </font ></P>
<P align="center"><font face="Verdana" size="3"> <B>&nbsp;Листинг 5.2. </B> Исходный 
  код компонента <font face="Verdana" size="2"> TCustomlPEdit</font>&nbsp; </font ></P>
<blockquote> 
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> unit uIPEdit;&nbsp;</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> interface</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> uses</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> Windows, Messages, 
    SysUtils, Classes, Controls;</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> type</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> TCustomlPEdit 
    = class(TWinControl)</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2">&nbsp;private</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> { Private declarations 
    }</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2">&nbsp;FIPAddress: 
    DWORD;</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2">&nbsp;FIPLimits: 
    array [0..3] of word;</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2">&nbsp;FCurrentField 
    : Integer;</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> //procedure 
    CMWantSpecialKey(var Msg: TCMWantSpecialKey);</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2">&nbsp;message 
    CM_WANTSPECIALKEY;</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> procedure WMGetDlgCode(var 
    Message: TWMGetDlgCode);</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2">message WM_GETDLGCODE;</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> procedure CMDialogChar(var 
    Message: TCMDialogChar);</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2">&nbsp;message 
    CM_DIALOGCHAR;</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> //procedure 
    CMDialogKey(var Message: TCMDialogKey);</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2">&nbsp;message 
    CM_DIALOGKEY;</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> procedure CNNotify(var 
    Message: TWMNotify);&nbsp;</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> message CN_NOTIFY;&nbsp;</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> protected</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> { Protected 
    declarations }</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> function GetIP(Index: 
    Integer): Byte;</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> procedure SetIP(Index: 
    Integer; Value: Byte);</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> function GetMinIP(Index: 
    Integer): Byte;</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> procedure SetMinIP(Index: 
    Integer; Value: Byte);</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> function GetMaxIP(Index: 
    Integer): Byte;</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> procedure SetMaxIP(Index: 
    Integer; Value: Byte);</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> function GetlPString: 
    string;</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> procedure SetlPString(Value: 
    string);</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> function IsBlank: 
    boolean;</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> procedure SetCurrentFieldfIndex: 
    Integer);</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> //</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> procedure CreateParams(var 
    Params: TCreateParams); override;</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> procedure CreateWnd; 
    override;</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> //procedure 
    KeyDown(var Key: Word; Shift: TShiftState);override;</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> function IPDwordToString(dw: 
    DWORD): string;</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> function IPStringToDword(s: 
    string): DWORD;&nbsp;</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> public</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> { Public declarations 
    }</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> constructor 
    Create(AOwner: TComponent);&nbsp;</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2">override;</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> property IP[Index: 
    Integer]: byte read GetIP write SetIP;</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> property MinIP[Index: 
    Integer]: byte read GetMinIP write SetMinIP;</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> property MaxIP[Index: 
    Integer]: byte read GetMaxIP write SetMaxIP;</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> property IPString 
    : string read GetlPString write SetlPString;</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> property CurrentField 
    : Integer read FCurrentField write SetCurrentField;</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2">&nbsp;procedure 
    Clear;</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> end;</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> TIPEdit = class(TCustomlPEdit)</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2">published</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> property Align;</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> property Anchors;</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> property BorderWidth;</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> property DragCursor;</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> property DragKind;</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> property DragMode;</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> property Enabled;</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> property Font;</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> property Hint;</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> property Constraints;</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> property ParentShowHint;</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> property PopupMenu;</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> property ShowHint;</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> property TabOrder;</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> property TabStop;</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> property Visible;</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> property OnContextPopup;</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> property OnDragDrop;</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> property OnDragOver;</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> property OnEndDock;</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> property OnEndDrag;</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> property OnEnter;</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> property OnExit;</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> property OnMouseDown;</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> property OnMouseMove;</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> property OnMouseUp;</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> property OnStartDock;</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> property OnStartDrag;</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> { Published 
    declarations }</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> property IPString;&nbsp;</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2">end;</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> procedure Register;</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> implementation</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> uses Graphics, 
    commctrl, comctrls;</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> constructor 
    TCustomlPEdit.Create(AOwner: TComponent);&nbsp;</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> begin</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> inherited Create(AOwner);</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> FIPAddress 
    := 0;</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> ControlStyle 
    := [csCaptureMouse, csClickEvents, csDoubleClicks, csOpaque];</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> Color := clBtnFace;</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> Width := 160;</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> Height := 25;</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> Align := alNone;</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> TabStop := 
    True; end;</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> procedure TCustomlPEdit.CreateParams(var 
    Params: TCreateParams);</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2">&nbsp;begin</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> InitCommonControl(ICC_INTERNET_CLASSES);&nbsp;</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> inherited CreateParams(Params); 
    CreateSubClass(Params, WC_IPADDRESS);&nbsp;</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> with Params 
    do&nbsp;</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> begin</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> Style := WS_VISIBLE 
    or WS_BORDER or WS_CHILD;</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> if NewStyleControls 
    and CtlSD then</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> begin</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> Style := Style 
    and not WS_BORDER; ExStyle := ExStyle or WS_EX_CLIENTEDGE;&nbsp;</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2">end;&nbsp;</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2">end;</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2">&nbsp;end;</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> procedure TCustomlPEdit.CreateWnd;</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2">&nbsp;var i: 
    Integer;&nbsp;</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> begin</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> inherited CreateWnd; 
    Clear;</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> { for i := 
    0 to 3 do</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2">&nbsp;begin</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> MinIP[i] := 
    0; MaxIP[i] := $FF; end; }</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> CurrentField 
    := 0;</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2">&nbsp;end;</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> procedure TCustomlPEdit.WMGetDlgCode(var 
    Message: TWMGetDlgCode);</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2">&nbsp;begin</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> inherited;</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> Message.Result 
    := {Message.Result or} DLGC_WANTTAB;&nbsp;</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2">end;</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> procedure TCustomlPEdit.CNNotify(var 
    Message: TWMNotify);</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2">&nbsp;begin</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> with Message.NMHdr&quot; 
    do</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2">&nbsp;begin 
    case Code of</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> IPN_FIELDCHANGED 
    : begin</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> FCurrentField 
    := PNMIPAddress(Message.NMHdr)~.iField; {if Assigned(OnlpFieldChange) then</font> 
    </font ></P>
  <P><font face="Verdana" size="3"><font face="Verdana" size="2"> with PNMIPAdress(Message.NMHdr)^ 
    do begin&nbsp;</font> </font ></P>
  <P><font face="Verdana" size="3"><font face="Verdana" size="2">OnIPFieldChange(Self, 
    iField, iValue);}</font> </font ></P>
  <P><font face="Verdana" size="3"> &nbsp;<font face="Verdana" size="2">end;&nbsp;</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2">end;&nbsp;</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2">end;&nbsp;</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2">end;</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> (procedure 
    TCustomlPEdit.KeyDown(var Key: Word; Shift: TShiftState);&nbsp;</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> begin</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> inherited KeyDown(Key, 
    Shift);</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2">&nbsp;if Key 
    = VKJTAB then if ssShift in Shift then</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> CurrentField 
    := (CurrentField -1+4) mod 4</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2">&nbsp;else</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> CurrentField 
    := (CurrentField + I) mod 4; end; }</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> {procedure 
    TCustomlPEdit.CMWantSpecialKey(var Msg: TCMWantSpecialKey);&nbsp;</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> begin</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> inherited;</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> //Msg.Result 
    := Ord(Char(Msg.CharCode) = #9) ; end;}</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> procedure TCustomlPEdit.CMDialogChar(var 
    Message: TCMDialogChar);&nbsp;</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> begin with 
    Message do</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> if CharCode 
    = VKJTAB then&nbsp;</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> begin</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> Message.Result 
    := 0; if GetKeyState(VK_SHIFT)&lt;&gt;0 then&nbsp;</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> begin</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> if (CurrentField=0) 
    then Exit; CurrentField := CurrentField — 1;</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2">&nbsp;end</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> else&nbsp;</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> begin</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> if (CurrentField=3) 
    then Exit; CurrentField := CurrentField + 1;&nbsp;</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2">end;</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> Message.Result 
    := 1; end //VK_TAB&nbsp;</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> else</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> inherited; 
    end;</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> {procedure 
    TCustomlPEdit.CMDialogKey(var Message: TCMDialogKey);&nbsp;</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> begin</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> if (Focused 
    or Windows.IsChild(Handle, Windows.GetFocus))&nbsp;</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> and</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> (Message.CharCode 
    = VK_TAB) and (GetKeyState(VK_CONTROL) &lt; 0) then&nbsp;</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> begin&nbsp;</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> if GetKeyState 
    (VK_SHIFT) 00 then</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> CurrentField 
    := (CurrentField -1+4) mod 4&nbsp;</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> else</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> CurrentField 
    := (CurrentField + 1) ir.oci 4; Message.Result := 1;&nbsp;</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> end else</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> inherited; 
    end; }</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> function TCustomlPEdit.GetIP(Index: 
    Integer): Byte;</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2">&nbsp;begin</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> SendMessage</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> (Handle,IPM_GETADDRESS,0,longint(@FipAddress));</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> case Index 
    of</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> 1 : Result 
    := FIRST_IPADDRESS(FipAddress);</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> 2 : Result 
    := SECOND_IPADDRESS(FipAddress) ;</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> 3 : Result 
    := THIRD_IPADDRESS(FipAddress);</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> 4 : Result 
    := FOURTH_IPADDRESS(FipAddress); else Result := 0;&nbsp;</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2">end;</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2">&nbsp;end;</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> procedure TCustomlPEdit.SetIP(Index: 
    Integer; Value: Byte);</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2">&nbsp;begin</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2">&nbsp;case Index 
    of</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> 1: FIPAddress 
    := FIPAddress AND $FFFFFF or DWORD(Value) shl 24;</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> 2: FIPAddress 
    := FIPAddress AND $FFOOFFFF or DWORD(Value) shl 16;</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> 3: FIPAddress 
    := FIPAddress AND $FFFFOOFF or DWORD(Value) shl 8;</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> 4: FIPAddress 
    := FIPAddress AND $FFFFFFOO or DWORD(Value);</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> else Exit;</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2">&nbsp;end;</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> SendMessage(Handle, 
    IPM_SETADDRESS, 0, FIPAddress);&nbsp;</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2">end;</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> function TCustomlPEdit.GetMinIP(Index: 
    Integer): Byte; begin if (Index&lt;0) or (Index&gt;3) then</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> Result := 0</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2">else</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> Result := LoByte(FIPLimits[Index]);</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2">&nbsp;end;</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> procedure TCustomlPEdit.SetMinIP(Index: 
    Integer; Value: Byte);&nbsp;</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> begin</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> if (Index&lt;0) 
    or (Index&gt;3)</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2">&nbsp;then Exit;</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> FIPLimits[Index] 
    := MAKEIPRANGE(HiByte(FIPLimits[Index]), Value);</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> SendMessage(Handle, 
    IPM_SETRANGE, Index, FIPLimits[Index]);</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2">&nbsp;end;</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> function TCustomlPEdit.GetMaxIP(Index: 
    Integer): Byte; begin if (Index&lt;0) or (Index&gt;3)&nbsp;</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> then</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> Result := 0&nbsp;</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> else</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> Result := HiByte(FIPLimits[Index]);</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2">&nbsp;end;</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> procedure TCustomlPEdit.SetMaxIP(Index: 
    Integer; Value: Byte);</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2">&nbsp;begin</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> if (Index&lt;0) 
    or (Index&gt;3) then Exit;</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> FIPLimits[Index] 
    := MAKEIPRANGE(Value, LoByte(FIPLimits[Index]));</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> SendMessage(Handle, 
    IPM_SETRANGE, Index, FIPLimits[Index]);</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2">&nbsp;end;</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> procedure TCustomlPEdit.Clear,</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2">&nbsp;begin</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> SendMessage(Handle, 
    IPM_CLEARADDRESS, 0, 0);&nbsp;</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2">end;</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> function TCustomlPEdit.IsBlank: 
    boolean;</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2">&nbsp;begin</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> Result:= SendMessage(Handle, 
    IPM_ISBLANK, 0, 0) = 0;&nbsp;</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2">end;</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> procedure TCustomlPEdit.SetCurrentField(Index: 
    Integer);&nbsp;</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> begin</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> if (Index&lt;0) 
    or (Index&gt;3)</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2">&nbsp;then Exit;</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> FCurrentField 
    := Index;</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> SendMessage(Handle, 
    IPM_SETFOCUS, wParam(FCurrentField), 0) ;</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2">&nbsp;end;</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> function TCustomlPEdit.IPDwordToString(dw: 
    DWORD): string;</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2">&nbsp;begin</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> Result := Format('%d.%d.%d.%d',</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> [FIRST_IPADDRESS(dw),</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> SECOND_IPADDRESS(dw),</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> THIRD_IPADDRESS(dw),</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2">FOURTH_IPADDRESS(dw)]);</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2">&nbsp;end;</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> function TCustomlPEdit.IPStringToDword(s: 
    string): DWORD;&nbsp;</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> var i,j : Integer;</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> NewAddr, Part 
    : DWORD;</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2">begin</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> NewAddr := 
    0;&nbsp;</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> try</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> i := 0; repeat</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> j := PosC. 
    ', s); if j&lt;=l then if i&lt;3 then</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> Abort else</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> Part := StrToInt(s) 
    else</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> Part := StrToInt(Copy(s, 
    I, j-1));</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2">&nbsp;if Part&gt;255 
    then Abort; Delete(s, 1, j);</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> NewAddr := 
    (NewAddr shl 8) or Part;&nbsp;</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2">Inc(i);&nbsp;</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> until i&gt;3;&nbsp;</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> Result := NewAddr;</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> //Windows.MessageBox(0, 
    pChar(IntToHex(FIPAddress, 8)), '', MB_Ok);&nbsp;</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> except end;</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> end;</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> function TCustomlPEdit.GetlPString: 
    string;</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2">&nbsp;begin</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> SendMessage(Handle,IPM_GETADDRESS, 
    0, longint(SFIPAddress));</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> Result := IpDwordToString(FIPAddress);&nbsp;</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2">end;</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> procedure TCustomlPEdit.SetlPString(Value: 
    string);</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2">&nbsp;begin</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> FIPAddress 
    := IPStringToDword(Value);</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> SendMessage(Handle, 
    IPM_SETADDRESS, 0, FIPAddress);&nbsp;</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2">end;</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> procedure Register;&nbsp;</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> begin</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2">RegisterComponents('Samples', 
    [TIPEdit]);&nbsp;</font> </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2">end;</font> 
    </font ></P>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2">end.</font> 
    </font ></P>
</blockquote>
<P><font face="Verdana" size="3"> Для удобства пользования полезно было бы добавить 
  к компоненту <font face="Verdana" size="2"> CustomiPEdit</font> задание диапазона 
  для каждого из четырех составляющих и средства преобразования текстовой строки 
  в двоичный адрес. Но это уже совсем другая история, к библиотеке ComQ132 отношения 
  не имеющая. </font ></P>
<P><font face="Verdana" size="3"> &nbsp; </font ></P>
<table COLS="3" WIDTH="16%">
  <tr> 
    <td> <font face="Verdana" size="3"> <a href="Index11.html"> <img SRC="Back.gif" BORDER="0"> 
      </a> </font> </td>
    <td WIDTH="10%"> <font face="Verdana" size="3"> <a href="../index.html"> <img SRC="Menu.gif" BORDER="0"> 
      </a> </font> </td>
    <td ALIGN="RIGHT"> <font face="Verdana" size="3"> <a href="Index13.html"> 
      <img SRC="For.gif" BORDER="0"> </a> </font> </td>
  </tr>
</table>
</body>
</html>
