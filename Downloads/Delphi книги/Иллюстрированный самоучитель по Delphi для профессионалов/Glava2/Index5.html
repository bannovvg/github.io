<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
<title>
</title>
<meta http-equiv="Content-Type" content="text/html;charset=windows-1251">
</head>
<body TEXT="#000000" BGCOLOR="#E7E3E7"  LINK="#004080" VLINK="#004080" olink="#008080">
<table COLS="3" WIDTH="16%">
<tr>
<td>
<font face="Verdana" size="3">
<a href="Index4.html">
<img SRC="Back.gif" BORDER="0">
</a>
</font>
</td>
<td WIDTH="10%">
<font face="Verdana" size="3">
<a href="../index.html">
<img SRC="Menu.gif" BORDER="0">
</a>
</font>
</td>
<td ALIGN="RIGHT">
<font face="Verdana" size="3">
<a href="Index6.html">
<img SRC="For.gif" BORDER="0">
</a>
</font>
</td>
</tr>
</table>
<P><font face="Verdana" size="3">
&nbsp;
</font ></P>
<p align="center">
<font face="Verdana" size="3">
<font size="4">Класс TComponent</font>
<br>
</font>
</P>
<p align="left">
<font face="Verdana" size="3">

</font ></P>
<P><font face="Verdana" size="3">
Класс <font face="Verdana" size="2"> TComponent</font> является предком всех компонентов VCL. Он используется в качестве основы для создания невизуальных компонентов и реализует основные механизмы, которые обеспечивают функционирование любого компонента. В нем появляются первые свойства, которые отображаются в Инспекторе объектов. Это свойство
</font ></P>
<P><font face="Verdana" size="3">
<font face="Verdana" size="2">
property Name: TComponentName;</font>
</font ></P>
<P><font face="Verdana" size="3">
Оно содержит имя экземпляра компонента, которое используется для идентификации компонента в приложении.
</font ></P>
<P><font face="Verdana" size="3">
<B>        Примечание&nbsp;</B>
</font ></P>
<blockquote> 
  <blockquote>
    <p><font face="Verdana" size="3"> Тип <font face="Verdana" size="2"> TComponentName</font> 
      представляет собой обычную строку: </font ></p>
  </blockquote>
  <P><font face="Verdana" size="3"> <font face="Verdana" size="2"> type TComponentName 
    = type string;</font> </font ></P>
</blockquote>
<P><font face="Verdana" size="3">
Свойство
</font ></P>
<P><font face="Verdana" size="3">
<font face="Verdana" size="2">
property Tag: Longint;</font>
</font ></P>
<P><font face="Verdana" size="3">
является вспомогательным и не влияет на работу компонента. Оно отдано на откуп разработчику, который может присваивать ему значения по своему усмотрению. Например, это свойство можно использовать для дополнительной, более удобной идентификации компонентов.
</font ></P>
<P><font face="Verdana" size="3">
Для компонентов существует своя иерархия, поэтому в классе введен механизм учета и управления компонентами, для которых данный компонент является владельцем. Свойства и методы, которые отвечают за управление, приведены в табл. 2.1.
</font ></P>
<P align="center"><font face="Verdana" size="3"> <B>Таблица 2.1. </B>Свойства 
  и методы для управления списком компонентов </font ></P>
<TABLE FRAME="BOX" RULES="ALL" BORDER="1" CELLSPACING="0" CELLPADDING="0" WIDTH="475" HEIGHT="234">
<TR ALIGN="LEFT" VALIGN="TOP">
<TD COLSPAN="1" ALIGN="LEFT" VALIGN="TOP" WIDTH="232" HEIGHT="33">
<DIV WIDTH="346" HEIGHT="33" style="width: 154; height: 33">
<P><font face="Verdana" size="3">
<b>
Свойство (метод)</b>
</font ></P>
</DIV>
</TD>
<TD COLSPAN="1" ALIGN="LEFT" VALIGN="TOP" WIDTH="238" HEIGHT="33">
<DIV WIDTH="308" HEIGHT="33" style="width: 81; height: 33">
<P><font face="Verdana" size="3">
<b>
Описание</b>
</font ></P>
</DIV>
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD COLSPAN="1" ROWSPAN="1" ALIGN="LEFT" VALIGN="TOP" WIDTH="232" HEIGHT="88">
<DIV WIDTH="346" HEIGHT="88" style="width: 234; height: 42">
<P><font face="Verdana" size="3">
<font face="Verdana" size="2">
property Components [Index:   Integer]: TComponent ;</font>
</font ></P>
</DIV>
</TD>
<TD COLSPAN="1" ROWSPAN="1" ALIGN="LEFT" VALIGN="TOP" WIDTH="238" HEIGHT="88">
<DIV WIDTH="308" HEIGHT="88" style="width: 209; height: 88">
<P><font face="Verdana" size="3">
Содержит индексированный список указателей всех компонентов, для которых данный компонент является владельцем (<font face="Verdana" size="2">owner</font>)
</font ></P>
</DIV>
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD COLSPAN="1" ROWSPAN="1" ALIGN="LEFT" VALIGN="TOP" WIDTH="232" HEIGHT="27">
<DIV WIDTH="346" HEIGHT="27" style="width: 226; height: 27">
<P><font face="Verdana" size="3">
<font face="Verdana" size="2">
property ComponentCount :   Integer;</font>
</font ></P>
</DIV>
</TD>
<TD COLSPAN="1" ROWSPAN="1" ALIGN="LEFT" VALIGN="TOP" WIDTH="238" HEIGHT="27">
<DIV WIDTH="308" HEIGHT="27" style="width: 238; height: 27">
<P><font face="Verdana" size="3">
Число подчиненных компонентов
</font ></P>
</DIV>
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD COLSPAN="1" ROWSPAN="1" ALIGN="LEFT" VALIGN="TOP" WIDTH="232" HEIGHT="46">
<DIV WIDTH="346" HEIGHT="46" style="width: 223; height: 29">
<P><font face="Verdana" size="3">
<font face="Verdana" size="2">
property Owner:   TComponent;</font>
</font ></P>
</DIV>
</TD>
<TD COLSPAN="1" ROWSPAN="1" ALIGN="LEFT" VALIGN="TOP" WIDTH="238" HEIGHT="46">
<DIV WIDTH="308" HEIGHT="46" style="width: 218; height: 46">
<P><font face="Verdana" size="3">
Указывается, какой компонент является владельцем данного
</font ></P>
</DIV>
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD COLSPAN="1" ROWSPAN="1" ALIGN="LEFT" VALIGN="TOP" WIDTH="232" HEIGHT="40">
<DIV WIDTH="346" HEIGHT="64" style="width: 195; height: 32">
<P><font face="Verdana" size="3">
<font face="Verdana" size="2">
property Componentlndex:   Integer;</font>
</font ></P>
</DIV>
</TD>
<TD COLSPAN="1" ROWSPAN="1" ALIGN="LEFT" VALIGN="TOP" WIDTH="238" HEIGHT="40">
<DIV WIDTH="308" HEIGHT="64" style="width: 207; height: 39">
<P><font face="Verdana" size="3">
Индекс данного компонента в списке владельца
</font ></P>
</DIV>
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD COLSPAN="1" ALIGN="LEFT" VALIGN="TOP" WIDTH="344" HEIGHT="46">
<DIV WIDTH="344" HEIGHT="46" style="width: 224; height: 31">
<P><font face="Verdana" size="3">
<font face="Verdana" size="2">
procedure InsertComponent (AComponent : TComponent) ;</font>
</font ></P>
</DIV>
</TD>
<TD COLSPAN="1" ALIGN="LEFT" VALIGN="TOP" WIDTH="279" HEIGHT="46">
<DIV WIDTH="279" HEIGHT="46" style="width: 155; height: 46">
<P><font face="Verdana" size="3">
Вставляет компонент <font face="Verdana" size="2"> AComponent</font> в список
</font ></P>
</DIV>
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD COLSPAN="1" ROWSPAN="1" ALIGN="LEFT" VALIGN="TOP" WIDTH="344" HEIGHT="48">
<DIV WIDTH="344" HEIGHT="48" style="width: 216; height: 48">
<P><font face="Verdana" size="3">
<font face="Verdana" size="2">
procedure RemoveComponent (AComponent : TComponent};</font>
</font ></P>
</DIV>
</TD>
<TD COLSPAN="1" ROWSPAN="1" ALIGN="LEFT" VALIGN="TOP" WIDTH="279" HEIGHT="48">
<DIV WIDTH="279" HEIGHT="48" style="width: 166; height: 48">
<P><font face="Verdana" size="3">
Удаляет компонент <font face="Verdana" size="2"> AComponent</font> из списка
</font ></P>
</DIV>
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD COLSPAN="1" ROWSPAN="1" ALIGN="LEFT" VALIGN="TOP" WIDTH="344" HEIGHT="44">
<DIV WIDTH="344" HEIGHT="44" style="width: 236; height: 38">
<P><font face="Verdana" size="3">
<font face="Verdana" size="2">
procedure FindComponent (AName: string): TComponent;</font>
</font ></P>
</DIV>
</TD>
<TD COLSPAN="1" ROWSPAN="1" ALIGN="LEFT" VALIGN="TOP" WIDTH="279" HEIGHT="44">
<DIV WIDTH="279" HEIGHT="44" style="width: 203; height: 44">
<P><font face="Verdana" size="3">
Осуществляет поиск компонента по имени <font face="Verdana" size="2"> AName</font>
</font ></P>
</DIV>
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD COLSPAN="1" ROWSPAN="1" ALIGN="LEFT" VALIGN="TOP" WIDTH="344" HEIGHT="68">
<DIV WIDTH="344" HEIGHT="68" style="width: 227; height: 32">
<P><font face="Verdana" size="3">
<font face="Verdana" size="2">
procedure DestroyComponents;</font>
</font ></P>
</DIV>
</TD>
<TD COLSPAN="1" ROWSPAN="1" ALIGN="LEFT" VALIGN="TOP" WIDTH="279" HEIGHT="68">
<DIV WIDTH="279" HEIGHT="68" style="width: 224; height: 68">
<P><font face="Verdana" size="3">
Предназначен для уничтожения всех компонентов, подчиненных данному
</font ></P>
</DIV>
</TD>
</TR>
</TABLE>
<P><font face="Verdana" size="3">
Очень важное свойство
</font ></P>
<P><font face="Verdana" size="3">
<font face="Verdana" size="2">
type TComponentState = set of (csLoading, csReading, csWriting, csDestroying, csDesigning, csAncestor, csllpdating,
csFixups, csFreeNotification, cslnline, csDesignlnstance); property ComponentState: TComponentState;</font>
</font ></P>
<P><font face="Verdana" size="3">
дает представление о текущем состоянии компонента. В табл. 2.2 описаны возможные состояния компонента. Состояние может измениться в результате получения компонентом некоторого сообщения, действий разработчика, выполнения акции и т. д. Это свойство активно используется средой разработки.
</font ></P>
<P align="center"><font face="Verdana" size="3"> <B>Таблица 2.2. </B>Возможные 
  состояния компонента </font ></P>
<TABLE FRAME="BOX" RULES="ALL" BORDER="1" CELLSPACING="0" CELLPADDING="0" WIDTH="400" HEIGHT="332">
<TR ALIGN="LEFT" VALIGN="TOP">
<TD COLSPAN="1" ALIGN="LEFT" VALIGN="TOP" WIDTH="139" HEIGHT="27">
<DIV WIDTH="162" HEIGHT="27" style="width: 84; height: 27">
<P><font face="Verdana" size="3">
<b>
Состояние</b>
</font ></P>
</DIV>
</TD>
<TD COLSPAN="1" ALIGN="LEFT" VALIGN="TOP" WIDTH="274" HEIGHT="27">
<DIV WIDTH="461" HEIGHT="27" style="width: 85; height: 27">
<P><font face="Verdana" size="3">
<b>
Описание</b>
</font ></P>
</DIV>
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD COLSPAN="1" ROWSPAN="1" ALIGN="LEFT" VALIGN="TOP" WIDTH="139" HEIGHT="40">
<DIV WIDTH="162" HEIGHT="40" style="width: 77; height: 40">
<P><font face="Verdana" size="3">
<font face="Verdana" size="2">
csLoading</font>
</font ></P>
</DIV>
</TD>
<TD COLSPAN="1" ROWSPAN="1" ALIGN="LEFT" VALIGN="TOP" WIDTH="274" HEIGHT="40">
<DIV WIDTH="461" HEIGHT="40" style="width: 209; height: 40">
<P><font face="Verdana" size="3">
Устанавливается при загрузке компонента из потока
</font ></P>
</DIV>
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD COLSPAN="1" ROWSPAN="1" ALIGN="LEFT" VALIGN="TOP" WIDTH="139" HEIGHT="23">
<DIV WIDTH="162" HEIGHT="23" style="width: 76; height: 23">
<P><font face="Verdana" size="3">
<font face="Verdana" size="2">
csReading</font>
</font ></P>
</DIV>
</TD>
<TD COLSPAN="1" ROWSPAN="1" ALIGN="LEFT" VALIGN="TOP" WIDTH="274" HEIGHT="23">
<DIV WIDTH="461" HEIGHT="23" style="width: 207; height: 23">
<P><font face="Verdana" size="3">
Устанавливается при чтении значений свойств из потока
</font ></P>
</DIV>
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD COLSPAN="1" ROWSPAN="1" ALIGN="LEFT" VALIGN="TOP" WIDTH="139" HEIGHT="29">
<DIV WIDTH="162" HEIGHT="29" style="width: 78; height: 29">
<P><font face="Verdana" size="3">
<font face="Verdana" size="2">
csWriting</font>
</font ></P>
</DIV>
</TD>
<TD COLSPAN="1" ROWSPAN="1" ALIGN="LEFT" VALIGN="TOP" WIDTH="274" HEIGHT="29">
<DIV WIDTH="461" HEIGHT="29" style="width: 203; height: 29">
<P><font face="Verdana" size="3">
Устанавливается при записи значений свойств в поток
</font ></P>
</DIV>
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD COLSPAN="1" ROWSPAN="1" ALIGN="LEFT" VALIGN="TOP" WIDTH="139" HEIGHT="25">
<DIV WIDTH="162" HEIGHT="25" style="width: 102; height: 25">
<P><font face="Verdana" size="3">
<font face="Verdana" size="2">
csDestroying</font>
</font ></P>
</DIV>
</TD>
<TD COLSPAN="1" ROWSPAN="1" ALIGN="LEFT" VALIGN="TOP" WIDTH="274" HEIGHT="25">
<DIV WIDTH="461" HEIGHT="25" style="width: 184; height: 25">
<P><font face="Verdana" size="3">
Устанавливается при уничтожении компонента
</font ></P>
</DIV>
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD COLSPAN="1" ROWSPAN="1" ALIGN="LEFT" VALIGN="TOP" WIDTH="139" HEIGHT="44">
<DIV WIDTH="162" HEIGHT="44" style="width: 89; height: 44">
<P><font face="Verdana" size="3">
<font face="Verdana" size="2">
csDesigning</font>
</font ></P>
</DIV>
</TD>
<TD COLSPAN="1" ROWSPAN="1" ALIGN="LEFT" VALIGN="TOP" WIDTH="274" HEIGHT="44">
<DIV WIDTH="461" HEIGHT="44" style="width: 210; height: 44">
<P><font face="Verdana" size="3">
Состояние разработки. Устанавливается при работе с формой во время разработки
</font ></P>
</DIV>
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD COLSPAN="1" ROWSPAN="1" ALIGN="LEFT" VALIGN="TOP" WIDTH="139" HEIGHT="58">
<DIV WIDTH="162" HEIGHT="58" style="width: 81; height: 58">
<P><font face="Verdana" size="3">
<font face="Verdana" size="2">
csAncestor</font>
</font ></P>
</DIV>
</TD>
<TD COLSPAN="1" ROWSPAN="1" ALIGN="LEFT" VALIGN="TOP" WIDTH="274" HEIGHT="58">
<DIV WIDTH="461" HEIGHT="58" style="width: 247; height: 58">
<P><font face="Verdana" size="3">
Устанавливается при переносе компонента на форму. Для перехода в это состояние должно быть уже установлено состояние
<font face="Verdana" size="2"> csDesigning</font>
</font ></P>
</DIV>
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD COLSPAN="1" ROWSPAN="1" ALIGN="LEFT" VALIGN="TOP" WIDTH="139" HEIGHT="86">
<DIV WIDTH="162" HEIGHT="86" style="width: 81; height: 86">
<P><font face="Verdana" size="3">
<font face="Verdana" size="2">
csUpdating</font>
</font ></P>
</DIV>
</TD>
<TD COLSPAN="1" ROWSPAN="1" ALIGN="LEFT" VALIGN="TOP" WIDTH="274" HEIGHT="86">
<DIV WIDTH="461" HEIGHT="86" style="width: 254; height: 95">
<P><font face="Verdana" size="3">
Устанавливается при изменении значений свойств и отображения результата на форме-владельце. Для перехода в это состояние должно быть уже установлено состояние
<font face="Verdana" size="2">csAncestor</font>
</font ></P>
</DIV>
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD COLSPAN="1" ALIGN="LEFT" VALIGN="TOP" WIDTH="146" HEIGHT="65">
<DIV WIDTH="169" HEIGHT="65" style="width: 62; height: 65">
<P><font face="Verdana" size="3">
<font face="Verdana" size="2">
CsFixups</font>
</font ></P>
</DIV>
</TD>
<TD COLSPAN="1" ALIGN="LEFT" VALIGN="TOP" WIDTH="280" HEIGHT="65">
<DIV WIDTH="467" HEIGHT="65" style="width: 248; height: 74">
<P><font face="Verdana" size="3">
Устанавливается,  если  компонент связан с  компонентом другой формы, которая еще не загружена в среду разработки
</font ></P>
</DIV>
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD COLSPAN="1" ROWSPAN="1" ALIGN="LEFT" VALIGN="TOP" WIDTH="146" HEIGHT="48">
<DIV WIDTH="169" HEIGHT="48" style="width: 136; height: 48">
<P><font face="Verdana" size="3">
<font face="Verdana" size="2">
csFreeNotification</font>
</font ></P>
</DIV>
</TD>
<TD COLSPAN="1" ROWSPAN="1" ALIGN="LEFT" VALIGN="TOP" WIDTH="280" HEIGHT="48">
<DIV WIDTH="467" HEIGHT="48" style="width: 240; height: 48">
<P><font face="Verdana" size="3">
Если это состояние устанавливается, другие компоненты, связанные с данным, уведомляются о его уничтожении
</font ></P>
</DIV>
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD COLSPAN="1" ROWSPAN="1" ALIGN="LEFT" VALIGN="TOP" WIDTH="146" HEIGHT="64">
<DIV WIDTH="169" HEIGHT="64" style="width: 70; height: 64">
<P><font face="Verdana" size="3">
<font face="Verdana" size="2">
cslnline</font>
</font ></P>
</DIV>
</TD>
<TD COLSPAN="1" ROWSPAN="1" ALIGN="LEFT" VALIGN="TOP" WIDTH="280" HEIGHT="64">
<DIV WIDTH="467" HEIGHT="64" style="width: 262; height: 64">
<P><font face="Verdana" size="3">
Определяет компонент верхнего уровня  в иерархии.  Используется для обозначения корневого объекта в разворачивающихся свойствах
</font ></P>
</DIV>
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD COLSPAN="1" ROWSPAN="1" ALIGN="LEFT" VALIGN="TOP" WIDTH="146" HEIGHT="33">
<DIV WIDTH="169" HEIGHT="33" style="width: 132; height: 33">
<P><font face="Verdana" size="3">
<font face="Verdana" size="2">
csDesignlnstance</font>
</font ></P>
</DIV>
</TD>
<TD COLSPAN="1" ROWSPAN="1" ALIGN="LEFT" VALIGN="TOP" WIDTH="280" HEIGHT="33">
<DIV WIDTH="467" HEIGHT="33" style="width: 258; height: 33">
<P><font face="Verdana" size="3">
Определяет корневой компонент на этапе разработки
</font ></P>
</DIV>
</TD>
</TR>
</TABLE>
<P><font face="Verdana" size="3">
Для   обеспечения   работы   механизма   действий   (см. гл. 8)
предназначен
</font ></P>
<P><font face="Verdana" size="3">
метод
</font ></P>
<blockquote>
<P><font face="Verdana" size="3">
<font face="Verdana" size="2">
function ExecuteAction(Action: TBasicAction): Boolean; dynamic;</font>
</font ></P>
</blockquote>
<P><font face="Verdana" size="3">
Он вызывается автоматически при необходимости выполнить акцию, предназначенную для данного компонента.
</font ></P>
<P><font face="Verdana" size="3">
На  уровне   класса <font face="Verdana" size="2">   TComponent</font>   обеспечена   поддержка   СОМ-интерфейсов
<font face="Verdana" size="2">IUnknown</font> и <font face="Verdana" size="2"> IDispatch</font>.
</font ></P>
<P><font face="Verdana" size="3">
Через свойство
</font ></P>
<blockquote>
<P><font face="Verdana" size="3">
<font face="Verdana" size="2">
property ComObject: IUnknown;</font>
</font ></P>
</blockquote>
<P><font face="Verdana" size="3">
вы можете обеспечить применение методов этих интерфейсов.
</font ></P>
<P><font face="Verdana" size="3">
Таким образом, класс <font face="Verdana" size="2"> TComponent</font> имеет все для использования в качестве предка, для создания собственных невизуальных компонентов.
</font ></P>


<P><font face="Verdana" size="3">
&nbsp;
</font ></P>
<table COLS="3" WIDTH="16%">
<tr>
<td>
<font face="Verdana" size="3">
<a href="Index4.html">
<img SRC="Back.gif" BORDER="0">
</a>
</font>
</td>
<td WIDTH="10%">
<font face="Verdana" size="3">
<a href="../index.html">
<img SRC="Menu.gif" BORDER="0">
</a>
</font>
</td>
<td ALIGN="RIGHT">
<font face="Verdana" size="3">
<a href="Index6.html">
<img SRC="For.gif" BORDER="0">
</a>
</font>
</td>
</tr>
</table>
</body>
</html>
