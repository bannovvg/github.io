<html>

<head>
<title>Анализ временных рядов</title>
</head>

<body BACKGROUND="../tile1.gif">
<font SIZE="5" COLOR="AA0000"><b>

<p align="center"><a NAME="index"></a>Анализ временных рядов</b></font>
</p>

<hr SIZE="1">

<ul>
  <li><a HREF="sttimser.html#1general">Общее введение</a> </li>
  <li><a HREF="sttimser.html#main">Две основные цели</a> </li>
  <li><a HREF="sttimser.html#identifying">Идентификация модели
    временных рядов</a> <ul>
      <li><a HREF="sttimser.html#systematic">Систематическая
        составляющая и случайный шум</a> </li>
      <li><a HREF="sttimser.html#two">Два общих типа компонент
        временных рядов</a> </li>
      <li><a HREF="sttimser.html#trend">Анализ тренда</a> </li>
      <li><a HREF="sttimser.html#analysis">Анализ сезонности</a> </li>
    </ul>
  </li>
  <li><a HREF="sttimser.html#arima">АРПСС (Бокс и Дженкинс) и
    автокорреляции</a> <ul>
      <li><a HREF="sttimser.html#ageneral">Общее введение</a> </li>
      <li><a HREF="sttimser.html#atwo">Два основных процесса</a> </li>
      <li><a HREF="sttimser.html#aarima">Модель АРПСС</a> </li>
      <li><a HREF="sttimser.html#identification">Идентификация</a> </li>
      <li><a HREF="sttimser.html#parameter">Оценивание параметров</a> </li>
      <li><a HREF="sttimser.html#evaluation">Оценивание модели</a> </li>
    </ul>
  </li>
  <li><a HREF="sttimser.html#interrupted">Прерванные временные ряды</a>
  </li>
  <li><a HREF="sttimser.html#exponential">Экспоненциальное
    сглаживание</a> <ul>
      <li><a HREF="sttimser.html#egeneral">Общее введение</a> </li>
      <li><a HREF="sttimser.html#simple">Простое экспоненциальное
        сглаживание</a> </li>
      <li><a HREF="sttimser.html#choosing">Выбор лучшего значения
        параметра a (альфа)</a> </li>
      <li><a HREF="sttimser.html#indices">Индексы качества подгонки</a> </li>
      <li><a HREF="sttimser.html#seasonal">Сезонная и несезонная модели
        с трендом или без тренда</a> </li>
    </ul>
  </li>
  <li><a HREF="sttimser.html#census">Сезонная декомпозиция (метод
    Census I)</a> <ul>
      <li><a HREF="sttimser.html#ggeneral">Общее введение</a> </li>
      <li><a HREF="sttimser.html#gcomputations">Вычисления</a> </li>
    </ul>
  </li>
  <li><a HREF="sttimser.html#x">Сезонная корректировка <i>X-11</i>
    (метод Census II)</a> <ul>
      <li><a HREF="sttimser.html#aseasonal">Сезонная корректировка:
        основные идеи и термины</a> </li>
      <li><a HREF="sttimser.html#workit">Метод Census II</a> </li>
      <li><a HREF="sttimser.html#result">Таблицы результатов
        корректировки <i>X-11</i></a> </li>
      <li><a HREF="sttimser.html#specific">Подробное описание всех
        таблиц результатов, вычисляемых в методе <i>X-11</i></a>
      </li>
    </ul>
  </li>
  <li><a HREF="sttimser.html#lags">Анализ распределенных лагов</a> <ul>
      <li><a HREF="sttimser.html#dgeneral">Общая цель</a> </li>
      <li><a HREF="sttimser.html#model">Общая модель</a> </li>
      <li><a HREF="sttimser.html#almon">Распределенный лаг Алмона</a> </li>
    </ul>
  </li>
  <li><a HREF="sttimser.html#single">Одномерный анализ Фурье</a> </li>
  <li><a HREF="sttimser.html#cross">Кросс-спектральный анализ</a> <ul>
      <li><a HREF="sttimser.html#sgeneral">Общее введение</a> </li>
      <li><a HREF="sttimser.html#notation">Основные понятия и принципы</a>
      </li>
      <li><a HREF="sttimser.html#results">Результаты для каждой
        переменной</a> </li>
      <li><a HREF="sttimser.html#periodogram">Кросс-периодограмма,
        кросс-плотность, квадратурная плотность и
        кросс-амплитуда</a> </li>
      <li><a HREF="sttimser.html#squared">Квадрат когерентности,
        усиление и фазовый сдвиг</a> </li>
      <li><a HREF="sttimser.html#hows">Как создавались данные для
        примера</a> </li>
    </ul>
  </li>
  <li><a HREF="sttimser.html#spectrum">Спектральный анализ -
    Основные понятия и принципы</a> <ul>
      <li><a HREF="sttimser.html#frequency">Частота и период</a> </li>
      <li><a HREF="sttimser.html#tgeneral">Общая структура модели</a> </li>
      <li><a HREF="sttimser.html#simpleb">Простой пример</a> </li>
      <li><a HREF="sttimser.html#period">Периодограмма</a> </li>
      <li><a HREF="sttimser.html#problem">Проблема рассеяния</a> </li>
      <li><a HREF="sttimser.html#padding">Добавление констант во
        временной ряд (пэддинг)</a> </li>
      <li><a HREF="sttimser.html#tapering">Косинус-сглаживание</a> </li>
      <li><a HREF="sttimser.html#estimates">Окна данных и оценки
        спектральной плотности</a> </li>
      <li><a HREF="sttimser.html#preparing">Подготовка данных к анализу</a>
      </li>
      <li><a HREF="sttimser.html#results2">Результаты для случая, когда в
        ряде отсутствует периодичность</a> </li>
    </ul>
  </li>
  <li><a HREF="sttimser.html#fast">Быстрое преобразование Фурье</a> <ul>
      <li><a HREF="sttimser.html#ugeneral">Общее введение</a> </li>
      <li><a HREF="sttimser.html#computation2">Вычисление БПФ во временных
        рядах</a> </li>
    </ul>
  </li>
</ul>

<hr SIZE="1">

<p>В следующих разделах мы вначале представим
обзор методов, используемых для идентификации
моделей временных рядов (таких как сглаживание,
подгонка и автокорреляции). Затем опишем общий
класс моделей, которые могут быть использованы
для описания рядов и построения прогнозов
(модели авторегрессии и скользящего среднего).
Наконец, расскажем о некоторых простых, но часто
используемых методах, основанных на линейной
регрессии. За дальнейшей информацией обратитесь
к соответствующим разделам. </p>

<p>&nbsp; <a NAME="1general"></a> </p>

<p><font SIZE="5" COLOR="navy">Общее введение </font></p>

<p>Вначале дадим краткий обзор методов анализа
данных, представленных в виде временных рядов,
т.е. в виде последовательностей измерений,
упорядоченных в неслучайные моменты времени. В
отличие от анализа случайных выборок, анализ
временных рядов основывается на предположении,
что последовательные значения в файле данных
наблюдаются через равные промежутки времени
(тогда как в других методах нам не важна и часто
не интересна привязка наблюдений ко времени). </p>

<p>Подробное обсуждение этих методов можно найти
в следующих работах: Anderson (1976), Бокс и Дженкинс
(1976), Kendall (1984), Kendall and Ord (1990), Montgomery, Johnson, and Gardiner (1990),
Pankratz (1983), Shumway (1988), Vandaele (1983), Walker (1991), Wei (1989). </p>

<p>&nbsp; <a NAME="main"></a> </p>

<p><font SIZE="5" COLOR="navy">Две основные цели </font></p>

<p>Существуют две основные цели анализа временных
рядов: (1) определение природы ряда и (2)
прогнозирование (предсказание будущих значений
временного ряда по настоящим и прошлым
значениям). Обе эти цели требуют, чтобы модель
ряда была идентифицирована и, более или менее,
формально описана. Как только модель определена,
вы можете с ее помощью интерпретировать
рассматриваемые данные (например, использовать в
вашей теории для понимания сезонного изменения
цен на товары, если занимаетесь экономикой). Не
обращая внимания на глубину понимания и
справедливость теории, вы можете
экстраполировать затем ряд на основе найденной
модели, т.е. предсказать его будущие значения. </p>

<table ALIGN="RIGHT">
  <tr>
    <td><font SIZE="1"><a HREF="sttimser.html#index">В начало</a></font> </td>
  </tr>
</table>

<p><br CLEAR="RIGHT">
</p>

<hr SIZE="1">

<p>&nbsp;<a NAME="identifying"></a> </p>

<p><font SIZE="5" COLOR="navy">Идентификация модели временных
рядов</font> 

<ul>
  <li><a HREF="sttimser.html#systematic">Систематическая
    составляющая и случайный шум</a> </li>
  <li><a HREF="sttimser.html#two">Два общих типа компонент
    временных рядов</a> </li>
  <li><a HREF="sttimser.html#trend">Анализ тренда</a> </li>
  <li><a HREF="sttimser.html#analysis">Анализ сезонности</a> </li>
</ul>

<p>За более полной информацией о простых
автокорреляциях (обсуждаемых в этом разделе) и
других автокорреляциях, см. Anderson (1976), Box and Jenkins
(1976), Kendall (1984), Pankratz (1983), and Vandaele (1983). См. также: 

<ul>
  <li><a HREF="sttimser.html#arima">АРПСС (Бокс и Дженкинс) и
    автокорреляции</a> </li>
  <li><a HREF="sttimser.html#interrupted">Прерванные временные ряды</a>
  </li>
  <li><a HREF="sttimser.html#exponential">Экспоненциальное
    сглаживание</a> </li>
  <li><a HREF="sttimser.html#census">Сезонная декомпозиция (метод
    Census I)</a> </li>
  <li><a HREF="sttimser.html#x">Сезонная корректировка <i>X-11</i>
    (метод Census II)</a> </li>
  <li><a HREF="sttimser.html#result">Таблицы результатов
    корректировки <i>X-11</i></a> </li>
  <li><a HREF="sttimser.html#lags">Анализ распределенных лагов</a> </li>
  <li><a HREF="sttimser.html#single">Одномерный анализ Фурье</a> </li>
  <li><a HREF="sttimser.html#cross">Кросс-спектральный анализ</a> </li>
  <li><a HREF="sttimser.html#spectrum">Основные понятия и принципы</a>
  </li>
  <li><a HREF="sttimser.html#fast">Быстрое преобразование Фурье</a> </li>
</ul>

<p>&nbsp;<a NAME="systematic"></a> </p>

<p><font SIZE="4" COLOR="navy">Систематическая составляющая и
случайный шум </font></p>

<p>Как и большинство других видов анализа, анализ
временных рядов предполагает, что данные
содержат систематическую составляющую (обычно
включающую несколько компонент) и случайный шум
(ошибку), который затрудняет обнаружение
регулярных компонент. Большинство методов
исследования временных рядов включает различные
способы фильтрации шума, позволяющие увидеть
регулярную составляющую более отчетливо. </p>

<p>&nbsp;<a NAME="two"></a> </p>

<p><font SIZE="4" COLOR="navy">Два общих типа компонент
временных рядов </font></p>

<p>Большинство регулярных составляющих временных
рядов принадлежит к двум классам: они являются
либо трендом, либо сезонной составляющей. Тренд
представляет собой общую систематическую
линейную или нелинейную компоненту, которая
может изменяться во времени. Сезонная
составляющая - это периодически повторяющаяся
компонента. Оба эти вида регулярных компонент
часто присутствуют в ряде одновременно.
Например, продажи компании могут возрастать из
года в год, но они также содержат сезонную
составляющую (как правило, 25% годовых продаж
приходится на декабрь и только 4% на август). </p>

<p><img BORDER="0" SRC="../popups/popup18.gif" alt="График" WIDTH="306" HEIGHT="218"> </p>

<p>Эту общую модель можно понять на
&quot;классическом&quot; ряде - <i>Ряд G</i> (Бокс и
Дженкинс, 1976, стр. 531), представляющем месячные
международные авиаперевозки (в тысячах) в
течение 12 лет с 1949 по 1960 (см. файл <i>Series_g.sta)</i>.
График месячных перевозок ясно показывает почти
линейный тренд, т.е. имеется устойчивый рост
перевозок из года в год (примерно в 4 раза больше
пассажиров перевезено в 1960 году, чем в 1949). В то же
время характер месячных перевозок повторяется,
они имеют почти один и тот же характер в каждом
годовом периоде (например, перевозок больше в
отпускные периоды, чем в другие месяцы). Этот
пример показывает довольно определенный тип
модели временного ряда, в которой амплитуда
сезонных изменений увеличивается вместе с
трендом. Такого рода модели называются моделями
с <i>мультипликативной сезонностью</i>. </p>

<p>&nbsp;<a NAME="trend"></a> </p>

<p><font SIZE="4" COLOR="navy">Анализ тренда </font></p>

<p>Не существует &quot;автоматического&quot; способа
обнаружения тренда в временном ряде. Однако если
тренд является монотонным (устойчиво возрастает
или устойчиво убывает), то анализировать такой
ряд обычно нетрудно. Если временные ряды
содержат значительную ошибку, то первым шагом
выделения тренда является сглаживание. </p>

<p><b>Сглаживание. </b>Сглаживание всегда включает
некоторый способ локального усреднения данных,
при котором несистематические компоненты
взаимно погашают друг друга. Самый общий метод
сглаживания - <i>скользящее среднее,</i> в котором
каждый член ряда заменяется простым или
взвешенным средним <i>n</i> соседних членов, где <i>n</i>
- ширина &quot;окна&quot; (см. Бокс и Дженкинс, 1976; Velleman
and Hoaglin, 1981). Вместо среднего можно использовать
медиану значений, попавших в окно. Основное
преимущество медианного сглаживания, в
сравнении со сглаживанием скользящим средним,
состоит в том, что результаты становятся более
устойчивыми к выбросам (имеющимся внутри окна).
Таким образом, если в данных имеются выбросы
(связанные, например, с ошибками измерений), то
сглаживание медианой обычно приводит к более
гладким или, по крайней мере, более
&quot;надежным&quot; кривым, по сравнению со
скользящим средним с тем же самым окном. Основной
недостаток медианного сглаживания в том, что при
отсутствии явных выбросов, он приводит к более
&quot;зубчатым&quot; кривым (чем сглаживание
скользящим средним) и не позволяет использовать
веса. </p>

<p>Относительно реже, когда ошибка измерения
очень большая, используется метод <i>сглаживания
методом наименьших квадратов, взвешенных
относительно расстояния </i>или метод <i>отрицательного
экспоненциально взвешенного сглаживания</i>. Все
эти методы отфильтровывают шум и преобразуют
данные в относительно гладкую кривую (см.
соответствующие разделы, где каждый из этих
методов описан более подробно). Ряды с
относительно небольшим количеством наблюдений и
систематическим расположением точек могут быть
сглажены с помощью <i>бикубических сплайнов</i>. </p>

<p><b>Подгонка функции. </b>Многие монотонные
временные ряды можно хорошо приблизить линейной
функцией. Если же имеется явная монотонная
нелинейная компонента, то данные вначале следует
преобразовать, чтобы устранить нелинейность.
Обычно для этого используют логарифмическое,
экспоненциальное или (менее часто)
полиномиальное преобразование данных. </p>

<p>&nbsp;<a NAME="analysis"></a> </p>

<p><font SIZE="4" COLOR="navy">Анализ сезонности </font></p>

<p>Периодическая и сезонная зависимость
(сезонность) представляет собой другой общий тип
компонент временного ряда. Это понятие было
проиллюстрировано ранее на примере
авиаперевозок пассажиров. Можно легко видеть,
что каждое наблюдение очень похоже на соседнее;
дополнительно, имеется повторяющаяся сезонная
составляющая, это означает, что каждое
наблюдение также похоже на наблюдение, имевшееся
в том же самом месяце год назад. В общем,
периодическая зависимость может быть формально
определена как корреляционная зависимость
порядка <i>k</i> между каждым <i>i-</i>м элементом ряда и
<i>(i-k)</i>-м элементом (Kendall, 1976). Ее можно измерить с
помощью автокорреляции (т.е. корреляции между
самими членами ряда); <i>k</i> обычно называют <i>лагом
</i>(иногда используют эквивалентные термины:
сдвиг, запаздывание). Если ошибка измерения не
слишком большая, то сезонность можно определить
визуально, рассматривая поведение членов ряда
через каждые <i>k</i> временных единиц. </p>

<p><b>Автокорреляционная коррелограмма. </b>Сезонные
составляющие временного ряда могут быть найдены
с помощью коррелограммы. Коррелограмма
(автокоррелограмма) показывает численно и
графически автокорреляционную функцию (AКФ),
иными словами коэффициенты автокорреляции (и их
стандартные ошибки) для последовательности
лагов из определенного диапазона (например, от 1
до 30). На коррелограмме обычно отмечается
диапазон в размере двух стандартных ошибок на
каждом лаге, однако обычно величина
автокорреляции более интересна, чем ее
надежность, потому что интерес в основном
представляют очень сильные (а, следовательно,
высоко значимые) автокорреляции (см. <a HREF="../esc.html"><i>Элементарные
понятия статистики</i></a>). </p>

<p><b>Исследование коррелограмм. </b>При изучении
коррелограмм следует помнить, что
автокорреляции последовательных лагов
формально зависимы между собой. Рассмотрим
следующий пример. Если первый член ряда тесно
связан со вторым, а второй с третьим, то первый
элемент должен также каким-то образом зависеть
от третьего и т.д. Это приводит к тому, что
периодическая зависимость может существенно
измениться после удаления автокорреляций
первого порядка, т.е. после взятия разности с
лагом 1). </p>

<p><img BORDER="0" SRC="../popups/popup19.gif" alt="Автокоррелограмма до и после взятия разности ряда" WIDTH="306" HEIGHT="443">
</p>

<p><b>Частные автокорреляции. </b>Другой полезный
метод исследования периодичности состоит в
исследовании частной автокорреляционной
функции (<i>ЧАКФ</i>), представляющей собой
углубление понятия обычной автокорреляционной
функции. В ЧАКФ устраняется зависимость между
промежуточными наблюдениями (наблюдениями <i>внутри</i>
лага). Другими словами, частная автокорреляция на
данном лаге аналогична обычной автокорреляции,
за исключением того, что при вычислении из нее
удаляется влияние автокорреляций с меньшими
лагами (см. Бокс и Дженкинс, 1976; см. также McDowall,
McCleary, Meidinger, and Hay, 1980). На лаге <i>1</i> (когда нет
промежуточных элементов внутри лага), частная
автокорреляция равна, очевидно, обычной
автокорреляции. На самом деле, частная
автокорреляция дает более &quot;чистую&quot; картину
периодических зависимостей. </p>

<p><b>Удаление периодической зависимости. </b>Как
отмечалось выше, периодическая составляющая для
данного лага <i>k</i> может быть удалена взятием
разности соответствующего порядка. Это означает,
что из каждого <i>i</i>-го элемента ряда вычитается <i>(i-k)</i>-й
элемент. Имеются два довода в пользу таких
преобразований. </p>

<p>Во-первых, таким образом можно определить
скрытые периодические составляющие ряда.
Напомним, что автокорреляции на
последовательных лагах зависимы. Поэтому
удаление некоторых автокорреляций изменит
другие автокорреляции, которые, возможно,
подавляли их, и сделает некоторые другие
сезонные составляющие более заметными. </p>

<p>Во-вторых, удаление сезонных составляющих
делает ряд <a HREF="../glossary/gloss_s.html#Stationary Series (in Time Series)"><i>стационарным</i></a>,
что необходимо для применения <a HREF="sttimser.html#arima">АРПСС</a>
и других методов, например, спектрального
анализа. </p>

<table ALIGN="RIGHT">
  <tr>
    <td><font SIZE="1"><a HREF="sttimser.html#index">В начало</a></font> </td>
  </tr>
</table>

<p><br CLEAR="RIGHT">
</p>

<hr SIZE="1">

<p>&nbsp;<a NAME="arima"></a></p>
<font SIZE="5" COLOR="navy">

<p>АРПСС </font>

<ul>
  <li><a HREF="sttimser.html#ageneral">Общее введение</a> </li>
  <li><a HREF="sttimser.html#atwo">Два основных процесса</a> </li>
  <li><a HREF="sttimser.html#aarima">Модель АРПСС</a> </li>
  <li><a HREF="sttimser.html#identification">Идентификация</a> </li>
  <li><a HREF="sttimser.html#parameter">Оценивание параметров</a> </li>
  <li><a HREF="sttimser.html#evaluation">Оценивание модели</a> </li>
</ul>

<p>Дополнительная информация о методах <i>Анализа
временных рядов</i> дана также в следующих
разделах: 

<ul>
  <li><a HREF="sttimser.html#identifying">Идентификация модели
    временных рядов</a> </li>
  <li><a HREF="sttimser.html#interrupted">Прерванные временные ряды</a>
  </li>
  <li><a HREF="sttimser.html#exponential">Экспоненциальное
    сглаживание</a> </li>
  <li><a HREF="sttimser.html#census">Сезонная декомпозиция (метод
    Census I)</a> </li>
  <li><a HREF="sttimser.html#x">Сезонная корректировка <i>X-11</i>
    (метод Census II)</a> </li>
  <li><a HREF="sttimser.html#result">Таблицы результатов
    корректировки <i>X-11</i></a> </li>
  <li><a HREF="sttimser.html#lags">Анализ распределенных лагов</a> </li>
  <li><a HREF="sttimser.html#single">Одномерный анализ Фурье</a> </li>
  <li><a HREF="sttimser.html#cross">Кросс-спектральный анализ</a> </li>
  <li><a HREF="sttimser.html#spectrum">Основные понятия и принципы</a>
  </li>
  <li><a HREF="sttimser.html#fast">Быстрое преобразование Фурье</a> </li>
</ul>

<p>&nbsp;<a NAME="ageneral"> </a></p>

<p><font SIZE="4" COLOR="navy">Общее введение </font></p>

<p>Процедуры оценки параметров и прогнозирования,
описанные в разделе <a HREF="sttimser.html#identifying"><i>Идентификация
модели временных рядов</i></a>, предполагают, что
математическая модель процесса известна. В
реальных данных часто нет отчетливо выраженных
регулярных составляющих. Отдельные наблюдения
содержат значительную ошибку, тогда как вы
хотите не только выделить регулярные компоненты,
но также построить прогноз. Методология АРПСС,
разработанная Боксом и Дженкинсом (1976), позволяет
это сделать. Данный метод чрезвычайно популярен
во многих приложениях, и практика подтвердила
его мощность и гибкость (Hoff, 1983; Pankratz, 1983; Vandaele, 1983).
Однако из-за мощности и гибкости, АРПСС - сложный
метод. Его не так просто использовать, и
требуется большая практика, чтобы овладеть им.
Хотя часто он дает удовлетворительные
результаты, они зависят от квалификации
пользователя (Bails and Peppers, 1982). Следующие разделы
познакомят вас с его основными идеями. Для
интересующихся кратким, рассчитанным на
применение, (нематематическим) введением в АРПСС,
рекомендуем книгу McCleary, Meidinger, and Hay (1980). </p>

<p>&nbsp;<a NAME="atwo"> </a></p>

<p><font SIZE="4" COLOR="navy">Два основных процесса </font></p>

<p><b>Процесс авторегрессии. </b>Большинство
временных рядов содержат элементы, которые
последовательно зависят друг от друга. Такую
зависимость можно выразить следующим
уравнением: </p>

<p><font color="blue">x<sub>t</sub> = <img src="../graphics/xiblue.gif" align="absmiddle" WIDTH="11" HEIGHT="18">
+ <img src="../graphics/lilphibl.gif" align="absmiddle" WIDTH="11" HEIGHT="17"><sub>1</sub>*x<sub>(t-1)</sub> + <img src="../graphics/lilphibl.gif" align="absmiddle" WIDTH="11" HEIGHT="17"><sub>2</sub>*x<sub>(t-2)</sub> + <img src="../graphics/lilphibl.gif" align="absmiddle" WIDTH="11" HEIGHT="17"><sub>3</sub>*x<sub>(t-3)</sub> + ... + <img src="../graphics/errorblu.gif" align="absmiddle" WIDTH="10" HEIGHT="14"> </font></p>

<p>Здесь:<br>
&nbsp;<img src="../graphics/xiblue.gif" align="absmiddle" WIDTH="11" HEIGHT="18">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-
константа (свободный член),<br>
&nbsp;<img src="../graphics/lilphibl.gif" align="absmiddle" WIDTH="11" HEIGHT="17"><font color="blue"><sub>1</sub></font>,
<img src="../graphics/lilphibl.gif" align="absmiddle" WIDTH="11" HEIGHT="17"><font color="blue"><sub>2</sub></font>,
<img src="../graphics/lilphibl.gif" align="absmiddle" WIDTH="11" HEIGHT="17"><font color="blue"><sub>3</sub></font>&nbsp;&nbsp;
- параметры авторегрессии. </p>

<p>Вы видите, что каждое наблюдение есть сумма
случайной компоненты (случайное воздействие, <img src="../graphics/errorblu.gif" alt="errorblu.gif (835 bytes)" WIDTH="10" HEIGHT="14">) и линейной
комбинации предыдущих наблюдений. </p>

<p><b>Требование стационарности. </b>Заметим, что
процесс авторегрессии будет стационарным
только, если его параметры лежат в определенном
диапазоне. Например, если имеется только один
параметр, то он должен находиться в интервале -1&lt;<img SRC="../graphics/lilphi.gif" ALIGN="ABSMIDDLE" WIDTH="11" HEIGHT="17">&lt;+1. В противном случае,
предыдущие значения будут накапливаться и
значения последующих <i>x<sub>t</sub></i> могут быть
неограниченными, следовательно, ряд не будет<i> </i><a HREF="../glossary/gloss_s.html#Stationary Series (in Time Series)">стационарным</a>.
Если имеется несколько параметров
авторегрессии, то можно определить аналогичные
условия, обеспечивающие стационарность (см.
например, Бокс и Дженкинс, 1976; Montgomery, 1990). </p>

<p><b>Процесс скользящего среднего.</b> В отличие от
процесса авторегрессии, в процессе скользящего
среднего каждый элемент ряда подвержен
суммарному воздействию предыдущих ошибок. В
общем виде это можно записать следующим образом: </p>

<p><font color="blue">x<sub>t</sub> = µ + <img src="../graphics/errorblu.gif" align="absmiddle" WIDTH="10" HEIGHT="14"><sub>t</sub> - <img src="../graphics/thetablu.gif" align="absmiddle" WIDTH="9" HEIGHT="15"><sub>1</sub>*<img src="../graphics/errorblu.gif" align="absmiddle" WIDTH="10" HEIGHT="14"><sub>(t-1)</sub> - <img src="../graphics/thetablu.gif" align="absmiddle" WIDTH="9" HEIGHT="15"><sub>2</sub>*<img src="../graphics/errorblu.gif" align="absmiddle" WIDTH="10" HEIGHT="14"><sub>(t-2)</sub> - <img src="../graphics/thetablu.gif" align="absmiddle" WIDTH="9" HEIGHT="15"><sub>3</sub>*<img src="../graphics/errorblu.gif" align="absmiddle" WIDTH="10" HEIGHT="14"><sub>(t-3)</sub> - ... </font></p>

<p>Здесь:<br>
&nbsp;<font color="blue">µ</font>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-
константа,<br>
&nbsp;<font color="blue"><img src="../graphics/thetablu.gif" align="absmiddle" WIDTH="9" HEIGHT="15"><sub>1</sub></font>,
<img src="../graphics/thetablu.gif" align="absmiddle" WIDTH="9" HEIGHT="15"><font color="blue"><sub>2</sub></font>,
<img src="../graphics/thetablu.gif" align="absmiddle" WIDTH="9" HEIGHT="15"><font color="blue"><sub>3</sub></font>&nbsp;&nbsp;-
параметры скользящего среднего. </p>

<p>Другими словами, текущее наблюдение ряда
представляет собой сумму случайной компоненты
&nbsp; (случайное воздействие, <img src="../graphics/errorblu.gif" alt="errorblu.gif (835 bytes)" WIDTH="10" HEIGHT="14">) в данный момент и линейной
комбинации случайных воздействий в предыдущие
моменты времени. </p>

<p><b>Обратимость. </b>Не вдаваясь в детали, отметим,
что существует &quot;двойственность&quot; между
процессами скользящего среднего и авторегрессии
(см. например, Бокс и Дженкинс, 1976; Montgomery, Johnson, and
Gardiner, 1990). Это означает, что приведенное выше
уравнение скользящего среднего можно переписать
(<i>обратить</i>) в виде уравнения авторегрессии
(неограниченного порядка), и наоборот. Это так
называемое свойство обратимости. Имеются
условия, аналогичные приведенным выше условиям <a HREF="../glossary/gloss_s.html#Stationary Series (in Time Series)">стационарности</a>,
обеспечивающие обратимость модели. </p>

<p>&nbsp;<a NAME="aarima"></a> </p>

<p><font SIZE="4" COLOR="navy">Модель АРПСС </font></p>

<p><b>Модель авторегрессии и скользящего среднего. </b>Общая
модель, предложенная Боксом и Дженкинсом (1976)
включает как параметры авторегрессии, так и
параметры скользящего среднего. Именно, имеется
три типа параметров модели: параметры
авторегрессии (<i>p</i>), порядок разности (<i>d), </i>параметры
скользящего среднего (<i>q</i>). В обозначениях Бокса
и Дженкинса модель записывается как АРПСС (<i>p, d, q</i>).
Например, модель (<i>0</i>, <i>1</i>,<i> 2</i>) содержит 0
(нуль) параметров авторегрессии (<i>p</i>) и 2
параметра скользящего среднего (<i>q</i>), которые
вычисляются для ряда после взятия разности с
лагом 1. </p>

<p><b>Идентификация. </b>Как отмечено ранее, для
модели АРПСС необходимо, чтобы ряд был <a HREF="../glossary/gloss_s.html#Stationary Series (in Time Series)">стационарным</a>,
это означает, что его среднее постоянно, а
выборочные дисперсия и автокорреляция не
меняются во времени. Поэтому обычно необходимо
брать разности ряда до тех пор, пока он не станет<i>
</i><a HREF="../glossary/gloss_s.html#Stationary Series (in Time Series)">стационарным</a>
(часто также применяют логарифмическое
преобразование для стабилизации дисперсии).
Число разностей, которые были взяты, чтобы
достичь стационарности, определяются параметром
<i>d</i> (см. предыдущий раздел). Для того чтобы
определить необходимый порядок разности, нужно
исследовать график ряда и автокоррелограмму.
Сильные изменения уровня (сильные скачки вверх
или вниз) обычно требуют взятия несезонной
разности первого порядка (лаг=<i>1</i>). Сильные
изменения наклона требуют взятия разности
второго порядка. Сезонная составляющая требует
взятия соответствующей сезонной разности (см.
ниже). Если имеется медленное убывание
выборочных коэффициентов автокорреляции в
зависимости от лага, обычно берут разность
первого порядка. Однако следует помнить, что для
некоторых временных рядов нужно брать разности
небольшого порядка или вовсе не брать их.
Заметим, что <em>чрезмерное количество взятых
разностей</em> приводит к менее стабильным оценкам
коэффициентов.</p>

<p>На этом этапе (который обычно называют <i>идентификацией
</i>порядка модели, см. ниже) вы также должны
решить, как много параметров авторегрессии (<i>p</i>)
и скользящего среднего (<i>q</i>) должно
присутствовать в эффективной и <i>экономной </i>модели
процесса. (<i>Экономность </i>модели означает, что в
ней имеется наименьшее число параметров и
наибольшее число степеней свободы среди всех
моделей, которые подгоняются к данным). На
практике очень редко бывает, что число
параметров <i>p</i> или <i>q</i> больше 2 (см. ниже более
полное обсуждение). </p>

<p><b>Оценивание и прогноз.</b> Следующий, после
идентификации, шаг (<i>Оценивание</i>) состоит в
оценивании параметров модели (для чего
используются процедуры минимизации функции
потерь, см. ниже; более подробная информация о
процедурах минимизации дана в разделе <a HREF="stnonlin.html"><i>Нелинейное оценивание</i></a>).
Полученные оценки параметров используются на
последнем этапе (<i>Прогноз</i>) для того, чтобы
вычислить новые значения ряда и построить
доверительный интервал для прогноза. Процесс
оценивания проводится по преобразованным данным
(подвергнутым применению разностного оператора).
До построения прогноза нужно выполнить обратную
операцию (<i>интегрировать </i>данные). Таким
образом, прогноз методологии будет сравниваться
с соответствующими исходными данными. На
интегрирование данных указывает буква <i>П</i> в
общем названии модели (АРПСС = Авторегрессионное
Проинтегрированное Скользящее Среднее). </p>

<p><b>Константа в моделях АРПСС. </b>Дополнительно
модели АРПСС могут содержать константу,
интерпретация которой зависит от подгоняемой
модели. Именно, если (1) в модели нет параметров
авторегрессии, то константа <img SRC="../graphics/mu.gif" ALIGN="ABSMIDDLE" WIDTH="14" HEIGHT="19"> есть среднее значение ряда, если (2)
параметры авторегрессии имеются, то константа
представляет собой свободный член. Если бралась
разность ряда, то константа представляет собой
среднее или свободный член преобразованного
ряда. Например, если бралась первая разность
(разность первого порядка), а параметров
авторегрессии в модели нет, то константа
представляет собой среднее значение
преобразованного ряда и, следовательно, <i>коэффициент
наклона линейного тренда </i>исходного. </p>

<p>&nbsp;<a NAME="identification"></a> </p>

<p><font SIZE="4" COLOR="navy">Идентификация </font></p>

<p><b>Число оцениваемых параметров. </b>Конечно, до
того, как начать оценивание, вам необходимо
решить, какой тип модели будет подбираться к
данным, и какое количество параметров
присутствует в модели, иными словами, нужно
идентифицировать модель АРПСС. Основными
инструментами идентификации порядка модели
являются графики, автокорреляционная функция
(АКФ), частная автокорреляционная функция (ЧАКФ).
Это решение не является простым и требуется
основательно поэкспериментировать с
альтернативными моделями. Тем не менее,
большинство встречающихся на практике временных
рядов можно с достаточной степенью точности
аппроксимировать одной из 5 основных моделей (см.
ниже), которые можно идентифицировать по виду
автокорреляционной (АКФ) и частной
автокорреляционной функции (ЧАКФ). Ниже дается
список этих моделей, основанный на рекомендациях
Pankratz (1983); дополнительные практические советы
даны в Hoff (1983), McCleary and Hay (1980), McDowall, McCleary, Meidinger, and Hay
(1980), and Vandaele (1983). Отметим, что число параметров
каждого вида невелико (меньше 2), поэтому нетрудно
проверить альтернативные модели. 

<ol>
  <li><i>Один параметр (p)</i>:<i> </i>АКФ - экспоненциально
    убывает; ЧАКФ - имеет резко выделяющееся значение
    для лага <i>1</i>, нет корреляций на других лагах. </li>
  <li><i>Два параметра авторегрессии (p)</i>: АКФ имеет
    форму синусоиды или экспоненциально убывает;
    ЧАКФ имеет резко выделяющиеся значения на лагах <i>1</i>,
    <i>2</i>, нет корреляций на других лагах. </li>
  <li><i>Один параметр скользящего среднего (q)</i>: АКФ
    имеет резко выделяющееся значение на лаге <i>1</i>,
    нет корреляций на других лагах. ЧАКФ
    экспоненциально убывает. </li>
  <li><i>Два параметра скользящего среднего (q)</i>: АКФ
    имеет резко выделяющиеся значения на лагах <i>1</i>, <i>2</i>,
    нет корреляций на других лагах. ЧАКФ имеет форму
    синусоиды или экспоненциально убывает. </li>
  <li><i>Один параметр авторегрессии (p) и один параметр
    скользящего среднего (q)</i>: АКФ экспоненциально
    убывает с лага <i>1</i>; ЧАКФ - экспоненциально
    убывает с лага <i>1</i>. </li>
</ol>
<b>

<p>Сезонные модели. </b>Мультипликативная сезонная
АРПСС представляет естественное развитие и
обобщение обычной модели АРПСС на ряды, в которых
имеется периодическая сезонная компонента. В
дополнении к несезонным параметрам, в модель
вводятся сезонные параметры для определенного
лага (устанавливаемого на этапе идентификации
порядка модели). Аналогично параметрам простой
модели АРПСС, эти параметры называются: сезонная
авторегрессия (<i>ps</i>), сезонная разность (<i>ds</i>) и
сезонное скользящее среднее (<i>qs</i>). Таким
образом, полная сезонная АРПСС может быть
записана как АРПСС (<i>p</i>,<i>d</i>,<i>q</i>)(<i>ps</i>,<i>ds</i>,<i>qs</i>).
Например, модель <i>(0,1,2)(0,1,1) </i>включает 0
регулярных параметров авторегрессии, 2
регулярных параметра скользящего среднего и 1
параметр сезонного скользящего среднего. Эти
параметры вычисляются для рядов, получаемых
после взятия одной разности с лагом <i>1 </i>и далее
сезонной разности. Сезонный лаг, используемый
для сезонных параметров, определяется на этапе
идентификации порядка модели. </p>

<p>Общие рекомендации относительно выбора
обычных параметров (с помощью АКФ и ЧАКФ)
полностью применимы к сезонным моделям. Основное
отличие состоит в том, что в сезонных рядах АКФ и
ЧАКФ имеют существенные значения на лагах,
кратных сезонному лагу (в дополнении к
характерному поведению этих функций,
описывающих регулярную (несезонную) компоненту
АРПСС). </p>

<p>&nbsp;<a NAME="parameter"></a> </p>

<p><font SIZE="4" COLOR="navy">Оценивание параметров </font></p>

<p>Существуют различные методы оценивания
параметров, которые дают очень похожие оценки, но
для данной модели одни оценки могут быть более
эффективны, а другие менее эффективны. В общем, во
время оценивания порядка модели используется
так называемый <i>квазиньютоновский </i><a HREF="../glossary/gloss_a.html#Algorithm">алгоритм</a>
максимизации правдоподобия (вероятности)
наблюдения значений ряда по значениям
параметров (см. <a HREF="stnonlin.html"><i>Нелинейное
оценивание</i></a>). Практически это требует
вычисления (условных) сумм квадратов (<i>SS</i>)
остатков модели. Имеются различные способы
вычисления суммы квадратов остатков <i>SS</i>; вы
можете выбрать: (1) приближенный метод
максимального правдоподобия МакЛеода и Сейлза
(1983), (2) приближенный метод максимального
правдоподобия с итерациями назад, (3)точный метод
максимального правдоподобия по Meларду (1984). </p>

<p><b>Сравнение методов. </b>В общем, все методы дают
очень похожие результаты. Также все методы
показали примерно одинаковую эффективность на
реальных данных. Однако метод <i>1</i> (см. выше) -
самый быстрый, и им можно пользоваться для
исследования очень длинных рядов (например,
содержащих более 30,000 наблюдений). Метод Меларда
(номер <i>3</i>) может оказаться неэффективным, если
оцениваются параметры сезонной модели с большим
сезонным лагом (например, 365 дней). С другой
стороны, вы можете использовать вначале
приближенный метод максимального правдоподобия
(для того, чтобы найти прикидочные оценки
параметров), а затем точный метод; обычно
требуется только несколько итераций точного
метода (номер <i>3</i>,<i> </i>выше), чтобы получить
окончательные оценки. </p>

<p><b>Стандартные ошибки оценок. </b>Для всех оценок
параметров вычисляются так называемые <i>асимптотические
стандартные ошибки</i>, для вычисления которых
используется матрица частных производных
второго порядка, аппроксимируемая конечными
разностями (см. также раздел <a HREF="stnonlin.html"><i>Нелинейное
оценивание</i></a>). </p>

<p><b>Штраф. </b>Процедура оценивания минимизирует
(условную) сумму квадратов остатков модели. Если
модель не является адекватной, может случиться
так, что оценки параметров на каком-то шаге
станут неприемлемыми - очень большими (например,
не удовлетворяют условию стационарности). В
таком случае, SS будет приписано очень большое
значение (<i>штрафное значение</i>). Обычно это
&quot;заставляет&quot; итерационный процесс удалить
параметры из недопустимой области. Однако в
некоторых случаях и эта стратегия может
оказаться неудачной, и вы все равно увидите на
экране (во время <i>процедуры оценивания</i>) очень
большие значения SS на серии итераций. В таких
случаях следует с осторожностью оценивать
пригодность модели. Если модель содержит много
параметров и, возможно, имеется интервенция (см.
ниже), то следует несколько раз испытать процесс
оценивания с различными начальными. Если модель
содержит много параметров и, возможно,
интервенцию (см. ниже), вам следует повторить
процедуру с различными начальными значениями
параметров. </p>

<p>&nbsp;<a NAME="evaluation"></a> </p>

<p><font SIZE="4" COLOR="navy">Оценивание модели </font></p>

<p><b>Оценки параметров. </b>Если значения
вычисляемой <i>t</i> статистики не значимы,
соответствующие параметры в большинстве случаев
удаляются из модели без ущерба подгонки. </p>

<p><b>Другой критерий качества. </b>Другой обычной
мерой надежности модели является сравнение
прогноза, построенного по урезанному ряду с
&quot;известными (исходными) данными&quot;. </p>

<p><img BORDER="0" SRC="../popups/popup20.gif" alt="График прогноза" WIDTH="323" HEIGHT="236"> </p>

<p>Однако качественная модель должна не только
давать достаточно точный прогноз, но быть
экономной и иметь независимые остатки,
содержащие только шум без систематических
компонент (в частности, АКФ остатков не должна
иметь какой-либо периодичности). Поэтому
необходим всесторонний анализ остатков. Хорошей
проверкой модели являются: (a) график остатков и
изучение их трендов, (b) проверка АКФ остатков (на
графике АКФ обычно отчетливо видна
периодичность). </p>

<p><b>Анализ остатков. </b>Если остатки
систематически распределены (например,
отрицательны в первой части ряда и примерно
равны нуля во второй) или включают некоторую
периодическую компоненту, то это
свидетельствует о неадекватности модели. Анализ
остатков чрезвычайно важен и необходим при
анализе временных рядов. Процедура оценивания
предполагает, что остатки не коррелированы и
нормально распределены. </p>

<p><b>Ограничения. </b>Следует напомнить, что модель
АРПСС является подходящей только для рядов,
которые являются <a HREF="../glossary/gloss_s.html#Stationary Series (in Time Series)">стационарными</a>
(среднее, дисперсия и автокорреляция примерно
постоянны во времени); для нестационарных рядов
следует брать разности. Рекомендуется иметь, как
минимум, 50 наблюдений в файле исходных данных.
Также предполагается, что параметры модели
постоянны, т.е. не меняются во времени. </p>

<p>&nbsp;<a NAME="interrupted"></a> </p>

<p><font SIZE="5" COLOR="navy">Прерванные временные ряды </font></p>

<p>Обычный вопрос, возникающий при анализе
временных рядов, состоит в следующем,
воздействует или нет внешнее событие на
последовательность наблюдений. Например,
привела ли новая экономическая политика к росту
экономики, как обещалось; изменил ли новый закон
интенсивность преступлений и т.д. В общем, нужно
оценивать воздействия одного или нескольких
дискретных событий на значения ряда. Этот вид
анализа прерванных временных рядов подробно
описан в книге McDowall, McCleary, Meidinger, and Hay (1980).
Различают следующие три типа воздействий: (1)
устойчивое скачкообразное, (2) устойчивое
постепенное, (3) скачкообразное временное. См.
также следующие разделы: 

<ul>
  <li><a HREF="sttimser.html#identifying">Идентификация модели
    временных рядов</a> </li>
  <li><a HREF="sttimser.html#arima">АРПСС</a> </li>
  <li><a HREF="sttimser.html#exponential">Экспоненциальное
    сглаживание</a> </li>
  <li><a HREF="sttimser.html#census">Сезонная декомпозиция (метод
    Census I)</a> </li>
  <li><a HREF="sttimser.html#x">Сезонная корректировка <i>X-11</i>
    (метод Census II)</a> </li>
  <li><a HREF="sttimser.html#result">Таблицы результатов
    корректировки <i>X-11</i></a> </li>
  <li><a HREF="sttimser.html#lags">Анализ распределенных лагов</a> </li>
  <li><a HREF="sttimser.html#single">Одномерный анализ Фурье</a> </li>
  <li><a HREF="sttimser.html#cross">Кросс-спектральный анализ</a> </li>
  <li><a HREF="sttimser.html#spectrum">Основные понятия и принципы</a>
  </li>
  <li><a HREF="sttimser.html#fast">Быстрое преобразование Фурье</a> </li>
</ul>

<table ALIGN="RIGHT">
  <tr>
    <td><font SIZE="1"><a HREF="sttimser.html#index">В начало</a></font> </td>
  </tr>
</table>

<p><br CLEAR="RIGHT">
</p>

<hr SIZE="1">

<p>&nbsp;<a NAME="exponential"></a></p>
<font SIZE="5" COLOR="navy">

<p>Экспоненциальное сглаживание</font> 

<ul>
  <li><a HREF="sttimser.html#egeneral">Общее введение</a> </li>
  <li><a HREF="sttimser.html#simple">Простое экспоненциальное
    сглаживание</a> </li>
  <li><a HREF="sttimser.html#choosing">Выбор лучшего значения
    параметра a (альфа)</a> </li>
  <li><a HREF="sttimser.html#indices">Индексы качества подгонки</a> </li>
  <li><a HREF="sttimser.html#seasonal">Сезонная и несезонная модели
    с трендом или без тренда</a> </li>
</ul>

<p>См. также: 

<ul>
  <li><a HREF="sttimser.html#identifying">Идентификация модели
    временных рядов</a> </li>
  <li><a HREF="sttimser.html#arima">АРПСС (Бокс и Дженкинс) и
    автокорреляции</a> </li>
  <li><a HREF="sttimser.html#interrupted">Прерванные временные ряды</a>
  </li>
  <li><a HREF="sttimser.html#census">Сезонная декомпозиция (метод
    Census I)</a> </li>
  <li><a HREF="sttimser.html#x">Сезонная корректировка <i>X-11</i>
    (метод Census II)</a> </li>
  <li><a HREF="sttimser.html#result">Таблицы результатов
    корректировки <i>X-11</i></a> </li>
  <li><a HREF="sttimser.html#lags">Анализ распределенных лагов</a> </li>
  <li><a HREF="sttimser.html#single">Одномерный анализ Фурье</a> </li>
  <li><a HREF="sttimser.html#cross">Кросс-спектральный анализ</a> </li>
  <li><a HREF="sttimser.html#spectrum">Основные понятия и принципы</a>
  </li>
  <li><a HREF="sttimser.html#fast">Быстрое преобразование Фурье</a> </li>
</ul>

<p>&nbsp;<a NAME="egeneral"></a> </p>

<p><font SIZE="4" COLOR="navy">Общее введение </font></p>

<p>Экспоненциальное сглаживание - это очень
популярный метод прогнозирования многих
временных рядов. Исторически метод был
независимо открыт Броуном и Холтом. Броун служил
на флоте США во время второй мировой войны, где
занимался обнаружением подводных лодок и
системами наведения. Позже он применил открытый
им метод для прогнозирования спроса на запасные
части. Свои идеи он описал в книге, вышедшей в
свет в 1959 году. Исследования Холта были
поддержаны Департаментом военно-морского флота
США. Независимо друг от друга, Броун и Холт
открыли экспоненциальное сглаживание для
процессов с постоянным трендом, с линейным
трендом и для рядов с сезонной составляющей. </p>

<p>Gardner (1985), предложил &quot;единую&quot; классификацию
методов экспоненциального сглаживания.
Превосходное введение в эти методы можно найти в
книгах Makridakis, Wheelwright, and McGee (1983), Makridakis and Wheelwright (1989),
Montgomery, Johnson, and Gardiner (1990). </p>

<p>&nbsp;<a NAME="simple"></a> </p>

<p><font SIZE="4" COLOR="navy">Простое экспоненциальное
сглаживание </font></p>

<p>Простая и прагматически ясная модель
временного ряда имеет следующий вид: X<sub>t</sub> = b + <img src="../graphics/epsilon.gif" align="absmiddle" WIDTH="10" HEIGHT="14"><sub>t</sub>, где <i>b</i> -
константа и <img SRC="../graphics/epsilon.gif" align="absmiddle" WIDTH="10" HEIGHT="14">
(эпсилон) - случайная ошибка. Константа <i>b </i>относительно
стабильна на каждом временном интервале, но
может также медленно изменяться со временем.
Один из интуитивно ясных способов выделения <i>b</i>
состоит в том, чтобы использовать сглаживание
скользящим средним, в котором последним
наблюдениям приписываются большие веса, чем
предпоследним, предпоследним большие веса, чем
пред-предпоследним и т.д. Простое
экспоненциальное именно так и устроено. Здесь
более старым наблюдениям приписываются
экспоненциально убывающие веса, при этом, в
отличие от скользящего среднего, учитываются <i>все</i>
предшествующие наблюдения ряда, а не те, что
попали в определенное окно. Точная формула
простого экспоненциального сглаживания имеет
следующий вид: </p>

<p><font color="blue">S<sub>t</sub> = <img src="../graphics/alphablu.gif" align="absmiddle" WIDTH="16" HEIGHT="9">*X<sub>t</sub> + (1-<img src="../graphics/alphablu.gif" align="absmiddle" WIDTH="16" HEIGHT="9">)*S<sub>t-1</sub> </font></p>

<p>Когда эта формула применяется рекурсивно, то
каждое новое сглаженное значение (которое
является также прогнозом) вычисляется как
взвешенное среднее текущего наблюдения и
сглаженного ряда. Очевидно, результат
сглаживания зависит от параметра <img SRC="../graphics/alphablu.gif" ALIGN="middle" WIDTH="16" HEIGHT="9"> (<i>альфа</i>). Если <img SRC="../graphics/alphablu.gif" ALIGN="middle" WIDTH="16" HEIGHT="9"> равно <i>1</i>, то
предыдущие наблюдения полностью игнорируются.
Если <img SRC="../graphics/alphablu.gif" ALIGN="middle" WIDTH="16" HEIGHT="9"> равно <i>0, </i>то
игнорируются текущие наблюдения. Значения <img SRC="../graphics/alphablu.gif" ALIGN="absmiddle" WIDTH="16" HEIGHT="9"> между <i>0, 1</i> дают
промежуточные результаты.</p>

<p>Эмпирические исследования Makridakis и др. (1982;
Makridakis, 1983) показали, что весьма часто простое
экспоненциальное сглаживание дает достаточно
точный прогноз. </p>

<p>&nbsp;<a NAME="choosing"></a> </p>

<p><font SIZE="4" COLOR="navy">Выбор лучшего значения
параметра <img SRC="../graphics/alphanav.gif" ALIGN="middle" WIDTH="16" HEIGHT="13"> (альфа) </font></p>

<p>Gardner (1985) обсуждает различные теоретические и
эмпирические аргументы в пользу выбора
определенного параметра сглаживания. Очевидно,
из формулы, приведенной выше, следует, что <img SRC="../graphics/alpha.gif" WIDTH="16" HEIGHT="13"> должно попадать в интервал между <i>0</i>
(нулем) и <i>1</i> (хотя Brenner et al., 1968, для дальнейшего
применения анализа АРПСС считают, что <i>0</i>&lt;<img SRC="../graphics/alpha.gif" ALIGN="ABSMIDDLE" WIDTH="16" HEIGHT="13">&lt;<i>2</i>). Gardner (1985)
сообщает, что на практике обычно рекомендуется
брать <img SRC="../graphics/alpha.gif" ALIGN="ABSMIDDLE" WIDTH="16" HEIGHT="13"> меньше <i>.30</i>.
Однако в исследовании Makridakis et al., (1982), <img SRC="../graphics/alpha.gif" ALIGN="ABSMIDDLE" WIDTH="16" HEIGHT="13"> большее <i>.30</i>, часто
дает лучший прогноз. После обзора литературы,
Gardner (1985) приходит к выводу, что лучше оценивать
оптимально <img SRC="../graphics/alpha.gif" ALIGN="ABSMIDDLE" WIDTH="16" HEIGHT="13"> по данным
(см. ниже), чем просто &quot;гадать&quot; или
использовать искусственные рекомендации. </p>

<p><b>Оценивание лучшего значения <img SRC="../graphics/alpha.gif" ALIGN="ABSMIDDLE" WIDTH="16" HEIGHT="13"> с помощью данных. </b>На
практике параметр сглаживания часто ищется с <i>поиском
на сетке</i>. Возможные значения параметра
разбиваются сеткой с определенным шагом.
Например, рассматривается сетка значений от <img SRC="../graphics/alpha.gif" ALIGN="ABSMIDDLE" WIDTH="16" HEIGHT="13"> = <i>0.1</i> до <img SRC="../graphics/alpha.gif" ALIGN="ABSMIDDLE" WIDTH="16" HEIGHT="13"> = <i>0.9</i>, с шагом <i>0.1</i>.
Затем выбирается <img SRC="../graphics/alpha.gif" ALIGN="ABSMIDDLE" WIDTH="16" HEIGHT="13">,
для которого сумма квадратов (или средних
квадратов) остатков (наблюдаемые значения минус
прогнозы на шаг вперед) является минимальной. </p>

<p>&nbsp;<a NAME="indices"></a> </p>

<p><font SIZE="4" COLOR="navy">Индексы качества подгонки </font></p>

<p>Самый прямой способ оценки прогноза,
полученного на основе определенного значения <img SRC="../graphics/alpha.gif" ALIGN="ABSMIDDLE" WIDTH="16" HEIGHT="13"> - построить график
наблюдаемых значений и прогнозов на один шаг
вперед. Этот график включает в себя также остатки
(отложенные на правой оси <i>Y</i>). Из графика ясно
видно, на каких участках прогноз лучше или хуже. </p>

<p><img BORDER="0" SRC="../popups/popup21.gif" alt="График прогноза" WIDTH="306" HEIGHT="218"> </p>

<p>Такая визуальная проверка точности прогноза
часто дает наилучшие результаты. Имеются также
другие меры ошибки, которые можно использовать
для определения оптимального параметра <img SRC="../graphics/alpha.gif" ALIGN="ABSMIDDLE" WIDTH="16" HEIGHT="13"> (см. Makridakis, Wheelwright, and McGee,
1983): </p>

<p><strong>Средняя ошибка.</strong> Средняя ошибка (СО)
вычисляется простым усреднением ошибок на
каждом шаге. Очевидным недостатком этой меры
является то, что положительные и отрицательные
ошибки аннулируют друг друга, поэтому она не
является хорошим индикатором качества прогноза.</p>

<p><strong>Средняя абсолютная ошибка.</strong> Средняя
абсолютная ошибка (САО) вычисляется как среднее <i>абсолютных
</i>ошибок. Если она равна <i>0</i> (нулю), то имеем
совершенную подгонку (прогноз). В сравнении со
средней <i>квадратической </i>ошибкой, эта мера
&quot;не придает слишком большого значения&quot;
выбросам.</p>

<p><strong>Сумма квадратов ошибок (SSE),
среднеквадратическая ошибка.</strong> Эти величины
вычисляются как сумма (или среднее) квадратов
ошибок. Это наиболее часто используемые индексы
качества подгонки.</p>

<p><strong>Относительная ошибка (ОО).</strong> Во всех
предыдущих мерах использовались действительные
значения ошибок. Представляется естественным
выразить индексы качества подгонки в терминах <i>относительных</i>
ошибок. Например, при прогнозе месячных продаж,
которые могут сильно флуктуировать (например, по
сезонам) из месяца в месяц, вы можете быть вполне
удовлетворены прогнозом, если он имеет точность
?10%. Иными словами, при прогнозировании
абсолютная ошибка может быть не так интересна
как относительная. Чтобы учесть относительную
ошибку, было предложено несколько различных
индексов (см. Makridakis, Wheelwright, and McGee, 1983). В первом
относительная ошибка вычисляется как: </p>

<p><font color="blue">ОО<sub>t</sub> = 100*(X<sub>t</sub> - F<sub>t</sub> )/X<sub>t</sub>
</font></p>

<p>где <font color="blue"><i>X<sub>t</sub></i></font> - наблюдаемое
значение в момент времени <font color="blue"><i>t</i></font>, и <font color="blue"><i>F<sub>t</sub></i></font> - прогноз (сглаженное
значение).</p>

<p><strong>Средняя относительная ошибка (СОО).</strong>
Это значение вычисляется как среднее
относительных ошибок.</p>

<p><strong>Средняя абсолютная относительная ошибка
(САОО). </strong>Как и в случае с обычной средней
ошибкой отрицательные и положительные
относительные ошибки будут подавлять друг друга.
Поэтому для оценки качества подгонки в целом (для
всего ряда) лучше использовать среднюю <i>абсолютную
</i>относительную ошибку. Часто эта мера более
выразительная, чем среднеквадратическая ошибка.
Например, знание того, что точность прогноза ±5%,
полезно само по себе, в то время как значение 30.8
для средней квадратической ошибки не может быть
так просто проинтерпретировано. </p>

<p><strong>Автоматический поиск лучшего параметра.</strong>
Для минимизации средней квадратической ошибки,
средней абсолютной ошибки или средней
абсолютной относительной ошибки используется
квази-ньютоновская процедура (та же, что и в <a HREF="sttimser.html#arima">АРПСС</a>). В большинстве случаев
эта процедура более эффективна, чем обычный
перебор на сетке (особенно, если параметров
сглаживания несколько), и оптимальное значение <img src="../graphics/alphanav.gif" alt="alphanav.gif (845 bytes)" WIDTH="16" HEIGHT="13"> можно быстро
найти. </p>

<p><strong>Первое сглаженное значение </strong><i><b>S<sub>0</sub></b><strong>.</strong></i>
Если вы взгляните снова на формулу простого
экспоненциального сглаживания, то увидите, что
следует иметь значение <i>S<sub>0</sub> </i>для
вычисления первого сглаженного значения
(прогноза). В зависимости от выбора параметра <img SRC="../graphics/alpha.gif" ALIGN="ABSMIDDLE" WIDTH="16" HEIGHT="13"> (в частности, если <img SRC="../graphics/alpha.gif" ALIGN="ABSMIDDLE" WIDTH="16" HEIGHT="13"> близко к 0), начальное
значение сглаженного процесса может оказать
существенное воздействие на прогноз для многих
последующих наблюдений. Как и в других
рекомендациях по применению экспоненциального
сглаживания, рекомендуется брать начальное
значение, дающее наилучший прогноз. С другой
стороны, влияние выбора уменьшается с длиной
ряда и становится некритичным при большом числе
наблюдений. </p>

<p>&nbsp;<a NAME="seasonal"></a> </p>

<p><font SIZE="4" COLOR="navy">Сезонная и несезонная модели с
трендом или без тренда </font></p>

<p>В дополнение к простому экспоненциальному
сглаживанию, были предложены более сложные
модели, включающие сезонную компоненту и
трендом. Общая идея таких моделей состоит в том,
что прогнозы вычисляются не только по предыдущим
наблюдениям (как в простом экспоненциальном
сглаживании), но и с некоторыми задержками, что
позволяет независимо оценить тренд и сезонную
составляющую. Gardner (1985) обсудил различные модели в
терминах сезонности (отсутствует, аддитивная
сезонность, мультипликативная) и тренда
(отсутствует, линейный тренд, экспоненциальный,
демпфированный).</p>

<p><strong>Аддитивная и мультипликативная
сезонность.</strong> Многие временные ряды имеют
сезонные компоненты. Например, продажи игрушек
имеют пики в ноябре, декабре и, возможно, летом,
когда дети находятся на отдыхе. Эта
периодичность имеет место каждый год. Однако
относительный размер продаж может слегка
изменяться из года в год. Таким образом, имеет
смысл независимо экспоненциально сгладить
сезонную компоненту с дополнительным
параметром, обычно обозначаемым как <img SRC="../graphics/delta.gif" ALIGN="ABSMIDDLE" WIDTH="15" HEIGHT="17"> (<i>дельта</i>). Сезонные
компоненты, по природе своей, могут быть
аддитивными или мультипликативными. Например, в
течение декабря продажи определенного вида
игрушек увеличиваются на 1 миллион долларов
каждый год. Для того чтобы учесть сезонное
колебание, вы можете добавить в прогноз на каждый
декабрь 1 миллион долларов (сверх
соответствующего годового среднего). В этом
случае сезонность - аддитивная. Альтернативно,
пусть в декабре продажи увеличились на 40%, т.е. в 1.4
раза. Тогда, если общие продажи малы, то
абсолютное (в долларах) увеличение продаж в
декабре тоже относительно мало (процент роста
константа). Если в целом продажи большие, то
абсолютное (в долларах) увеличение продаж будет
пропорционально больше. Снова, в этом случае
продажи увеличатся в определенное число раз, и
сезонность будет мультипликативной (в данном
случае мультипликативная сезонная составляющая
была бы равна 1.4). На графике различие между двумя
видами сезонности состоит в том, что в аддитивной
модели сезонные флуктуации не зависят от
значений ряда, тогда как в мультипликативной
модели величина сезонных флуктуаций зависит от
значений временного ряда.</p>

<p><strong>Параметр сезонного сглаживания <img SRC="../graphics/delta.gif" ALIGN="ABSMIDDLE" WIDTH="15" HEIGHT="17">.</strong> В общем, прогноз
на один шаг вперед вычисляется следующим образом
(для моделей без тренда; для моделей с линейным и
экспоненциальным трендом, тренд добавляется; см.
ниже): </p>

<p>Аддитивная модель:</p>

<p><font color="blue">Прогноз<sub>t</sub> = S<sub>t</sub> + I<sub>t-p</sub> </font></p>

<p>Мультипликативная модель:</p>

<p><font color="blue">Прогноз<sub>t</sub> = S<sub>t</sub>*I<sub>t-p</sub> </font></p>

<p>В этой формуле <font color="blue"><i>S<sub>t</sub></i></font>
обозначает (простое) экспоненциально сглаженное
значение ряда в момент <font color="blue"><i>t</i></font>, и <font color="blue"><i>I<sub>t-p</sub></i></font> обозначает сглаженный
сезонный фактор в момент <font color="blue"><i>t</i></font>
минус <i><font color="blue">p</font> </i>(<i><font color="blue">p</font> </i>-
длина сезона). Таким образом, в сравнении с
простым экспоненциальным сглаживанием, прогноз
&quot;улучшается&quot; добавлением или умножением
сезонной компоненты. Эта компонента оценивается
независимо с помощью простого экспоненциального
сглаживания следующим образом: </p>

<p>Аддитивная модель:</p>

<p><font color="blue">I<sub>t</sub> = I<sub>t-p</sub> + <img src="../graphics/deltablu.gif" align="absmiddle" WIDTH="15" HEIGHT="17">*(1-<img src="../graphics/alphablu.gif" align="absmiddle" WIDTH="16" HEIGHT="9">)*e<sub>t</sub> </font></p>

<p>Мультипликативная модель:</p>

<p><font color="blue">I<sub>t</sub> = I<sub>t-p</sub> + <img src="../graphics/deltablu.gif" align="absmiddle" WIDTH="15" HEIGHT="17">*(1-<img src="../graphics/alphablu.gif" align="absmiddle" WIDTH="16" HEIGHT="9">)*e<sub>t</sub>/S<sub>t</sub> </font></p>

<p>Обратите внимание, что предсказанная сезонная
компонента в момент <font color="blue"><i>t</i></font>
вычисляется, как соответствующая компонента на
последнем сезонном цикле плюс ошибка (<font color="blue"><i>e<sub>t</sub></i></font>,
наблюдаемое минус прогнозируемое значение в
момент <font color="blue"><i>t</i></font>). Ясно, что параметр <img SRC="../graphics/deltablu.gif" ALIGN="ABSMIDDLE" WIDTH="15" HEIGHT="17"> принимает значения
между <i>0</i> и <i>1</i>. Если он равен нулю, то сезонная
составляющая на следующем цикле та же, что и на
предыдущем. Если <img SRC="../graphics/deltablu.gif" ALIGN="ABSMIDDLE" WIDTH="15" HEIGHT="17">
равен <i>1</i>, то сезонная составляющая
&quot;максимально&quot; меняется на каждом шаге из-за
соответствующей ошибки (множитель&nbsp; <font color="blue">(1-<img SRC="../graphics/alphablu.gif" align="absmiddle" WIDTH="16" HEIGHT="9">)</font> не
рассматривается из-за краткости введения). В
большинстве случаев, когда сезонность
присутствует, оптимальное значение <img SRC="../graphics/deltablu.gif" ALIGN="ABSMIDDLE" WIDTH="15" HEIGHT="17"> лежит между <i>0</i> и <i>1.</p>
</i>

<p><strong>Линейный, экспоненциальный,
демпфированный тренд. </strong>Возвращаясь к примеру
с игрушками, мы можем увидеть наличие линейного
тренда (например, каждый год продажи
увеличивались на 1 миллион), экспоненциального
(например, каждый год продажи возрастают в 1.3
раза) или демпфированного тренда (в первом году
продажи возросли на 1 миллион долларов; во втором
увеличение составило только 80% по сравнению с
предыдущим, т.е. на $800,000; в следующем году вновь
увеличение было только на 80%, т.е. на $800,000 * .8 = $640,000
и т.д.). Каждый тип тренда по-своему проявляется в
данных. В целом изменение тренда - медленное в
течение времени, и опять (как и сезонную
компоненту) имеет смысл экспоненциально
сгладить его с отдельным параметром
[обозначаемым <img SRC="../graphics/gamma.gif" ALIGN="ABSMIDDLE" WIDTH="15" HEIGHT="19"> (<i>гамма</i>)
- для линейного и экспоненциального тренда, <img SRC="../graphics/phi.gif" ALIGN="ABSMIDDLE" WIDTH="11" HEIGHT="22"> (<i>фи</i>) - для
демпфированного тренда]. </p>

<p><b>Параметры сглаживания <img SRC="../graphics/gamma.gif" ALIGN="ABSMIDDLE" WIDTH="15" HEIGHT="19"> (линейный и экспоненциальный тренд) и <img SRC="../graphics/phi.gif" ALIGN="ABSMIDDLE" WIDTH="11" HEIGHT="22"> (демпфированный тренд). </b>Аналогично
сезонной компоненте&nbsp; компонента тренда
включается в процесс экспоненциального
сглаживания. Сглаживание ее производится в
каждый момент времени независимо от других
компонент с соответствующими параметрами. Если <img SRC="../graphics/gamma.gif" ALIGN="ABSMIDDLE" WIDTH="15" HEIGHT="19"> равно <i>0,</i> то тренд
постоянен для всех значений временного ряда (и
для всех прогнозов). Если <img SRC="../graphics/gamma.gif" ALIGN="ABSMIDDLE" WIDTH="15" HEIGHT="19"> равно <i>1</i>, то тренд &quot;максимально&quot;
определяется ошибками наблюдений. Параметр <img SRC="../graphics/phi.gif" ALIGN="ABSMIDDLE" WIDTH="11" HEIGHT="22"> учитывает, как сильно
изменяется тренд, т.е. как быстро он
&quot;демпфируется&quot; или, наоборот, возрастает. </p>

<table ALIGN="RIGHT">
  <tr>
    <td><font SIZE="1"><a HREF="sttimser.html#index">В начало</a></font> </td>
  </tr>
</table>

<p><br CLEAR="RIGHT">
</p>

<hr SIZE="1">

<p>&nbsp;<a NAME="census"> </a></p>
<font SIZE="5" COLOR="navy">

<p>Сезонная декомпозиция (метод Census I)</font> 

<ul>
  <li><a HREF="sttimser.html#ggeneral">Общее введение</a> </li>
  <li><a HREF="sttimser.html#gcomputations">Вычисления</a> </li>
</ul>

<p>См. также: 

<ul>
  <li><a HREF="sttimser.html#identifying">Идентификация модели
    временных рядов</a> </li>
  <li><a HREF="sttimser.html#arima">АРПСС (Бокс и Дженкинс) и
    автокорреляции</a> </li>
  <li><a HREF="sttimser.html#interrupted">Прерванные временные ряды</a>
  </li>
  <li><a HREF="sttimser.html#exponential">Экспоненциальное
    сглаживание</a> </li>
  <li><a HREF="sttimser.html#x">Сезонная корректировка <i>X-11</i>
    (метод Census II)</a> </li>
  <li><a HREF="sttimser.html#result">Таблицы результатов
    корректировки <i>X-11</i></a> </li>
  <li><a HREF="sttimser.html#lags">Анализ распределенных лагов</a> </li>
  <li><a HREF="sttimser.html#single">Одномерный анализ Фурье</a> </li>
  <li><a HREF="sttimser.html#cross">Кросс-спектральный анализ</a> </li>
  <li><a HREF="sttimser.html#spectrum">Основные понятия и принципы</a>
  </li>
  <li><a HREF="sttimser.html#fast">Быстрое преобразование Фурье</a> </li>
</ul>

<p>&nbsp;<a NAME="ggeneral"></a></p>
<font SIZE="4" COLOR="navy">

<p>Общее введение </font></p>

<p>Предположим, что у вас имеются ежемесячные
данные о пассажиропотоке на международных
авиалиниях за 12 лет (см. Бокс и Дженкинс, 1976). Если
изобразить эти данные на графике, то будет хорошо
видно, что (1) объем пассажиропотока имеет во
времени возрастающий линейный тренд, и (2) в ряде
имеется ежегодно повторяющаяся закономерность - <i>сезонность
</i>(большинство перевозок приходится на летние
месяцы, кроме того, имеется пик меньшей высоты в
районе декабрьских каникул). Цель сезонной
декомпозиции и корректировки как раз и состоит в
том, чтобы отделить эти компоненты, то есть
разложить ряд на составляющую тренда, сезонную
компоненту и оставшуюся нерегулярную
составляющую. &quot;Классический&quot; прием,
позволяющий выполнить такую декомпозицию,
известен как метод <i>Census I</i>. Этот метод
описывается и обсуждается в работах Makridakis,
Wheelwright, and McGee (1983) и Makridakis and Wheelwright (1989). </p>

<p><strong>Общая модель.</strong> Основная идея сезонной
декомпозиции проста. В общем случае временной
ряд типа того, который описан выше, можно
представить себе состоящим из четырех различных
компонент: (1) сезонной компоненты (обозначается <i>S<sub>t</sub></i>,
где <i>t </i>обозначает момент времени), (2) тренда (<i>T<sub>t</sub></i>),
(3) циклической компоненты (<i>C<sub>t</sub></i>) и (4)
случайной, нерегулярной компоненты или
флуктуации (<i>I<sub>t</sub></i>). Разница между
циклической и сезонной компонентой состоит в
том, что последняя имеет регулярную (сезонную)
периодичность, тогда как циклические факторы
обычно имеют более длительный эффект, который к
тому же меняется от цикла к циклу. В методе Census I
тренд и циклическую компоненту обычно
объединяют в одну <i>тренд-циклическую компоненту
</i>(<i>TC<sub>t</sub></i>). Конкретные функциональные
взаимосвязи между этими компонентами могут
иметь самый разный вид. Однако, можно выделить
два основных способа, с помощью которых они могут
взаимодействовать: <i>аддитивно </i>и <i>мультипликативно</i>:<i></p>
</i>

<p>Аддитивная модель: </p>

<p><font color="blue">X<sub>t</sub> = TC<sub>t</sub> + S<sub>t</sub> + I<sub>t</sub> </font></p>

<p>Мультипликативная модель:</p>

<p><font color="blue">X<sub>t</sub> = T<sub>t</sub>*C<sub>t</sub>*S<sub>t</sub>*I<sub>t</sub>
</font></p>

<p>Здесь <font color="blue"><i>X<sub>t</sub></i></font> обозначает
значение временного ряда в момент времени <i><font color="blue">t</font>. </i>Если имеются какие-то <i>априорные </i>сведения
о циклических факторах, влияющих на ряд
(например, циклы деловой конъюнктуры), то можно
использовать оценки для различных компонент для
составления прогноза будущих значений ряда.
(Однако для прогнозирования предпочтительнее <a HREF="sttimser.html#exponential"><i>экспоненциальное
сглаживание</i></a>, позволяющее учитывать сезонную
составляющую и тренд.)</p>

<p><strong>Аддитивная и мультипликативная
сезонность.</strong> Рассмотрим на примере различие
между аддитивной и мультипликативной сезонными
компонентами. График объема продаж детских
игрушек, вероятно, будет иметь ежегодный пик в
ноябре-декабре, и другой - существенно меньший по
высоте - в летние месяцы, приходящийся на
каникулы. Такая сезонная закономерность будет
повторяться каждый год. По своей природе
сезонная компонента может быть аддитивной или
мультипликативной. Так, например, каждый год
объем продаж некоторой конкретной игрушки может
увеличиваться в декабре на 3 миллиона долларов.
Поэтому вы можете учесть эти сезонные изменения, <i>прибавляя
</i>к своему прогнозу на декабрь 3 миллиона. Здесь
мы имеем <i>аддитивную </i>сезонность<i>.</i> Может
получиться иначе. В декабре объем продаж
некоторой игрушки может увеличиваться на 40%, то
есть умножаться на <i>множитель </i>1.4. Это значит,
например, что если средний объем продаж этой
игрушки невелик, то абсолютное (в денежном
выражении) увеличение этого объема в декабре
также будет относительно небольшим (но в
процентном исчислении оно будет постоянным);
если же игрушка продается хорошо, то и абсолютный
(в долларах) рост объема продаж будет
значительным. Здесь опять, объем продаж
возрастает в число раз, равное определенному <i>множителю</i>,
а сезонная компонента, по своей природе,<i>
мультипликативная </i>компонента (в данном случае
равная 1.4). Если перейти к графикам временных
рядов, то различие между этими двумя видами
сезонности будет проявляться так: в аддитивном
случае ряд будет иметь постоянные сезонные
колебания, величина которых не зависит от общего
уровня значений ряда; в мультипликативном случае
величина сезонных колебаний будет меняться в
зависимости от общего уровня значений ряда. </p>

<p><b>Аддитивный и мультипликативный тренд-цикл. </b>Рассмотренный
пример можно расширить, чтобы проиллюстрировать
понятия аддитивной и мультипликативной
тренд-циклических компонент. В случае с
игрушками, <i>тренд </i>&quot;моды&quot; может привести к
устойчивому росту продаж (например, это может
быть общий тренд в сторону игрушек
образовательной направленности). Как и сезонная
компонента, этот тренд может быть по своей
природе аддитивным (продажи ежегодно
увеличиваются на 3 миллиона долларов) или
мультипликативным (продажи ежегодно
увеличиваются на 30%, или возрастают в 1.3 раза).
Кроме того, объем продаж может содержать
циклические компоненты. Повторим еще раз, что
циклическая компонента отличается от сезонной
тем, что она обычно имеет большую временную
протяженность и проявляется через неравные
промежутки времени. Так, например, некоторая
игрушка может быть особенно &quot;горячей&quot; в
течение летнего сезона (например, кукла,
изображающая персонаж популярного мультфильма,
которая к тому же агрессивно рекламируется). Как
и в предыдущих случаях, такая циклическая
компонента может изменять объем продаж
аддитивно, либо мультипликативно. </p>

<p>&nbsp;<a NAME="gcomputations"></a> </p>

<p><font SIZE="4" COLOR="navy">Вычисления </font></p>

<p>В вычислительном отношении процедура метода <i>Сезонной
декомпозиции (Census I) </i>следует стандартным
формулам, см. Makridakis, Wheelwright, and McGee (1983) или Makridakis and
Wheelwright (1989). </p>

<p><img BORDER="0" SRC="../popups/popup22.gif" alt="График" WIDTH="306" HEIGHT="218"> </p>

<p><strong>Скользящее среднее.</strong> Сначала
вычисляется скользящее среднее для временного
ряда, при этом ширина окна берется равной периоду
сезонности. Если период сезонности - четное
число, пользователь может выбрать одну из двух
возможностей: брать скользящее среднее с
одинаковыми весами или же с неравными весами так,
что первое и последнее наблюдения в окне имеют
усредненные веса. </p>

<p><strong>Отношения или разности.</strong> После взятия
скользящих средних вся сезонная (т.е. внутри
сезона) изменчивость будет исключена, и поэтому
разность (в случае аддитивной модели) или
отношение (для мультипликативной модели) между
наблюдаемым и сглаженным рядом будет выделять
сезонную составляющую (плюс нерегулярную
компоненту). Более точно, ряд скользящих средних
вычитается из наблюдаемого ряда (в аддитивной
модели) или же значения наблюдаемого ряда
делятся на значения скользящих средних (в
мультипликативной модели).</p>

<p><strong>Сезонная составляющая.</strong> На следующем
шаге вычисляется сезонная составляющая, как
среднее (для аддитивных моделей) или урезанное
среднее (для мультипликативных моделей) всех
значений ряда, соответствующих данной точке
сезонного интервала. </p>

<p><img BORDER="0" SRC="../popups/popup23.gif" alt="График" WIDTH="306" HEIGHT="218"> </p>

<p><strong>Сезонная корректировка ряда.</strong> Исходный
ряд можно скорректировать, вычитая из него
(аддитивная модель) или деля его значения на
(мультипликативная модель) значения сезонной
составляющей. </p>

<p><img BORDER="0" SRC="../popups/popup24.gif" alt="График" WIDTH="306" HEIGHT="218"> </p>

<p>Получающийся в результате ряд называется
сезонной корректировкой ряда (из ряда убрана
сезонная составляющая).. </p>

<p><strong>Тренд-циклическая компонента.</strong>
Напомним, что циклическая компонента отличается
от сезонной компоненты тем, что
продолжительность цикла, как правило, больше, чем
один сезонный период, и разные циклы могут иметь
разную продолжительность. Приближение для
объединенной тренд-циклической компоненты можно
получить, применяя к ряду с сезонной поправкой
процедуру 5-точечного (центрированного)
взвешенного скользящего среднего с весами 1, 2, 3, 2,
1.</p>

<p><strong>Случайная или нерегулярная компонента.</strong>
На последнем шаге выделяется случайная или
нерегулярная компонента (погрешность) путем
вычитания из ряда с сезонной поправкой
(аддитивная модель) или делением этого ряда
(мультипликативная модель) на тренд-циклическую
компоненту. </p>

<table ALIGN="RIGHT">
  <tr>
    <td><font SIZE="1"><a HREF="sttimser.html#index">В начало</a></font> </td>
  </tr>
</table>

<p><br CLEAR="RIGHT">
</p>

<hr SIZE="1">

<p>&nbsp;<a NAME="x"></a> </p>
<font SIZE="5" COLOR="navy">

<p>Сезонная корректировка <i>X-11</i> (метод Census II)</font></p>

<p>Общие идеи, лежащие в основе сезонной
декомпозиции и корректировки, изложены в
разделе, посвященном методу сезонной
корректировки Census I (см. <a HREF="sttimser.html#census"><i>Сезонная
декомпозиция (метод Census I)</i></a>). Метод Census II (2)
является развитием и уточнением обычного метода
корректировки. На протяжении многих лет
различные варианты метода Census II развивались в
Бюро Переписи США (US Census Bureau); один из вариантов
этого метода, получивший широкую известность и
наиболее часто применяемый в государственных
органах и сфере бизнеса, называется &quot;вариант <i>X-11</i>
метода Census II&quot; (см. Shiskin, Young, and Musgrave, 1967).
Впоследствии этот усовершенствованный вариант
метода Census II стал называться просто <i>X-11</i>.
Помимо документации, которую можно получить из
Census Bureau, подробное описание метода дано в работах
Makridakis, Wheelwright and McGee (1983), Makridakis and Wheelwright (1989).</p>

<p>За дополнительной информацией обратитесь к
следующим разделам: 

<ul>
  <li><a HREF="sttimser.html#aseasonal">Сезонная корректировка:
    основные идеи и термины</a> </li>
  <li><a HREF="sttimser.html#workit">Метод Census II</a> </li>
  <li><a HREF="sttimser.html#result">Таблицы результатов
    корректировки <i>X-11</i></a> </li>
  <li><a HREF="sttimser.html#specific">Подробное описание всех
    таблиц результатов, вычисляемых в методе <i>X-11</i></a>
  </li>
</ul>

<p>За дальнейшей информацией обратитесь к <a HREF="sttimser.html#index">Анализу временных рядов</a> и
следующим разделам: 

<ul>
  <li><a HREF="sttimser.html#identifying">Идентификация модели
    временных рядов</a> </li>
  <li><a HREF="sttimser.html#arima">АРПСС (Бокс и Дженкинс) и
    автокорреляции</a> </li>
  <li><a HREF="sttimser.html#interrupted">Прерванные временные ряды</a>
  </li>
  <li><a HREF="sttimser.html#exponential">Экспоненциальное
    сглаживание</a> </li>
  <li><a HREF="sttimser.html#census">Сезонная декомпозиция (метод
    Census I)</a> </li>
  <li><a HREF="sttimser.html#lags">Анализ распределенных лагов</a> </li>
  <li><a HREF="sttimser.html#single">Одномерный анализ Фурье</a> </li>
  <li><a HREF="sttimser.html#cross">Кросс-спектральный анализ</a> </li>
  <li><a HREF="sttimser.html#spectrum">Основные понятия и принципы</a>
  </li>
  <li><a HREF="sttimser.html#fast">Быстрое преобразование Фурье</a> </li>
</ul>

<p>&nbsp;<a NAME="aseasonal"></a></p>
<font SIZE="4" COLOR="navy">

<p>Сезонная корректировка: основные идеи и
термины </font></p>

<p>Предположим, что у вас имеются ежемесячные
данные о пассажиропотоке на международных
авиалиниях за 12 лет (см. Бокс и Дженкинс, 1976). Если
изобразить эти данные на графике, то будет хорошо
видно, что (1) объем пассажиропотока имеет во
времени возрастающий линейный тренд, и что (2) в
ряде имеется ежегодно повторяющаяся
закономерность - <i>сезонность </i>(большинство
перевозок приходится на летние месяцы, кроме
того, имеется пик меньшей высоты в районе
декабрьских каникул). Цель сезонной декомпозиции
и корректировки как раз и состоит в том, чтобы
отделить эти компоненты, то есть разложить ряд на
составляющую тренда, сезонную компоненту и
оставшуюся нерегулярную составляющую.
&quot;Классический&quot; прием, позволяющий выполнить
такую декомпозицию, известен как метод <i>Census I</i>
(см. раздел <a HREF="sttimser.html#census">Census I</a>). Этот метод
описывается и обсуждается в работах Makridakis,
Wheelwright, and McGee (1983) и Makridakis and Wheelwright (1989). </p>

<p><strong>Общая модель.</strong> Основная идея сезонной
декомпозиции проста. В общем случае временной
ряд типа того, который описан выше, можно
представить себе состоящим из четырех различных
компонент: (1) сезонной компоненты (обозначается <i>S<sub>t</sub></i>,
где <i>t </i>обозначает момент времени), (2) тренда (<i>T<sub>t</sub></i>),
(3) циклической компоненты (<i>C<sub>t</sub></i>) и (4)
случайной, нерегулярной компоненты или
флуктуации (<i>I<sub>t</sub></i>). Разница между
циклической и сезонной компонентой состоит в
том, что последняя имеет регулярную (сезонную)
периодичность, тогда как циклические факторы
обычно имеют более длительный эффект, который к
тому же меняется от цикла к циклу. В методе Census I
тренд и циклическую компоненту обычно
объединяют в одну <i>тренд-циклическую компоненту
</i>(<i>TC<sub>t</sub></i>). Конкретные функциональные
взаимосвязи между этими компонентами могут
иметь самый разный вид. Однако, можно выделить
два основных способа, с помощью которых они могут
взаимодействовать: <i>аддитивно </i>и <i>мультипликативно</i>:<i></p>
</i>

<p>Аддитивная модель: </p>

<p><font color="blue">X<sub>t</sub> = TC<sub>t</sub> + S<sub>t</sub> + I<sub>t</sub> </font></p>

<p>Мультипликативная модель:</p>

<p><font color="blue">X<sub>t</sub> = T<sub>t</sub>*C<sub>t</sub>*S<sub>t</sub>*I<sub>t</sub>
</font></p>

<p>Здесь <font color="blue"><i>X<sub>t</sub></i></font> обозначает
значение временного ряда в момент времени <i><font color="blue">t</font>. </i></p>

<p>Если имеются какие-то <i>априорные</i> сведения о
циклических факторах, влияющих на ряд (например,
циклы деловой конъюнктуры), то можно
использовать оценки для различных компонент для
составления прогноза будущих значений ряда.
(Однако для прогнозирования предпочтительнее <a HREF="sttimser.html#exponential"><i>экспоненциальное
сглаживание</i></a>, позволяющее учитывать сезонную
составляющую и тренд.)</p>

<p><strong>Аддитивная и мультипликативная
сезонность. </strong>Рассмотрим на примере различие
между аддитивной и мультипликативной сезонными
компонентами. График объема продаж детских
игрушек, вероятно, будет иметь ежегодный пик в
ноябре-декабре, и другой - существенно меньший по
высоте - в летние месяцы, приходящийся на
каникулы. Такая сезонная закономерность будет
повторяться каждый год. По своей природе
сезонная компонента может быть аддитивной или
мультипликативной. Так, например, каждый год
объем продаж некоторой конкретной игрушки может
увеличиваться в декабре на 3 миллиона долларов.
Поэтому вы можете учесть эти сезонные изменения, <i>прибавляя
</i>к своему прогнозу на декабрь 3 миллиона. Здесь
мы имеем <i>аддитивную </i>сезонность<i>.</i> Может
получиться иначе. В декабре объем продаж
некоторой игрушки может увеличиваться на 40%, то
есть умножаться на <i>множитель </i>1.4. Это значит,
например, что если средний объем продаж этой
игрушки невелик, то абсолютное (в денежном
выражении) увеличение этого объема в декабре
также будет относительно небольшим (но в
процентном исчислении оно будет постоянным);
если же игрушка продается хорошо, то и абсолютный
(в долларах) рост объема продаж будет
значительным. Здесь опять, объем продаж
возрастает в число раз, равное определенному <i>множителю</i>,
а сезонная компонента, по своей природе,<i>
мультипликативная </i>компонента (в данном случае
равная 1.4). Если перейти к графикам временных
рядов, то различие между этими двумя видами
сезонности будет проявляться так: в аддитивном
случае ряд будет иметь постоянные сезонные
колебания, величина которых не зависит от общего
уровня значений ряда; в мультипликативном случае
величина сезонных колебаний будет меняться в
зависимости от общего уровня значений ряда. </p>

<p><strong>Аддитивный и мультипликативный тренд-цикл.</strong>
Рассмотренный пример можно расширить, чтобы
проиллюстрировать понятия аддитивной и
мультипликативной тренд-циклических компонент.
В случае с игрушками, <i>тренд </i>&quot;моды&quot; может
привести к устойчивому росту продаж (например,
это может быть общий тренд в сторону игрушек
образовательной направленности). Как и сезонная
компонента, этот тренд может быть по своей
природе аддитивным (продажи ежегодно
увеличиваются на 3 миллиона долларов) или
мультипликативным (продажи ежегодно
увеличиваются на 30%, или возрастают в 1.3 раза).
Кроме того, объем продаж может содержать
циклические компоненты. Повторим еще раз, что
циклическая компонента отличается от сезонной
тем, что она обычно имеет большую временную
протяженность и проявляется через неравные
промежутки времени. Так, например, некоторая
игрушка может быть особенно &quot;горячей&quot; в
течение летнего сезона (например, кукла,
изображающая персонаж популярного мультфильма,
которая к тому же агрессивно рекламируется). Как
и в предыдущих случаях, такая циклическая
компонента может изменять объем продаж
аддитивно, либо мультипликативно. </p>

<p>&nbsp;<a NAME="workit"></a> </p>

<p><font SIZE="4" COLOR="navy">Метод Census II </font></p>

<p>Основной метод сезонной декомпозиции и
корректировки, рассмотренный в разделе <a href="sttimser.html#aseasonal">Сезонная корректировка:
основные идеи и термины</a>, может быть
усовершенствован различными способами. На самом
деле, в отличие от многих методов моделирования
временных рядов (в частности, <a HREF="sttimser.html#arima">АРПСС</a>),
которые основаны на определенной теоретической
модели, вариант <i>X-11</i> метода Census II представляет
собой просто результат многочисленных <i>специально
разработанных </i>приемов и усовершенствований,
которые доказали свою работоспособность в
многолетней практике решения реальных задач (см.
Burman, 1979, Kendall and Ord, 1990, Makridakis and Wheelwright, 1989; Wallis, 1974).
Некоторые из наиболее важных усовершенствований
перечислены ниже.</p>

<p><strong>Поправка на число рабочих дней.</strong> В
месяцах разное число дней и разное число рабочих
дней. Если мы анализируем, например, цифры
ежемесячной выручки парка аттракционов, то
разница в числе суббот и воскресений (пиковые
дни) в разных месяцах существенным образом
скажется на различиях в ежемесячных показателях
дохода. Вариант <i>X-11</i> метода Census II дает
пользователю возможность проверить,
присутствует ли во временном ряду этот эффект
числа рабочих дней, и если да, то внести
соответствующие поправки.</p>

<p><strong>Выбросы. </strong>Большинство реальных
временных рядов содержит выбросы, то есть резко
выделяющиеся наблюдения, вызванные какими-то
исключительными событиями. Например, забастовка
персонала может сильно повлиять на месячные или
годовые показатели выпуска продукции фирмы.
Такие выбросы могут исказить оценки сезонной
компоненты и тренда. В процедуре <i>X-11</i>
предусмотрены корректировки на случай появления
выбросов, основанные на использовании
&quot;принципов статистического контроля&quot;:
значения, выходящие за определенный диапазон
(который определяется в терминах, кратных <i>сигма</i>,
т.е. стандартных отклонений), могут быть
преобразованы или вовсе пропущены, и только
после этого будут вычисляться окончательные
оценки параметров сезонности. </p>

<p><strong>Последовательные уточнения.</strong>
Корректировки, связанные с наличием выбросов и
различным числом рабочих дней можно производить
многократно, чтобы последовательно получать для
компонент оценки все лучшего качества. В методе <i>X-11</i>
делается несколько последовательных уточнений
оценок для получения окончательных компонент
тренд-цикличности и сезонности, нерегулярной
составляющей, и самого временного ряда с
сезонными поправками.</p>

<p><strong>Критерии и итоговые статистики. </strong>Помимо
оценки основных компонент ряда, можно вычислить
различные сводные статистики. Например, можно
сформировать таблицы дисперсионного анализа для
проверки значимости фактора сезонной
изменчивости и ряда и фактора рабочих дней (см.
выше), процедура метода <i>X-11</i> вычисляет также
ежемесячные относительные изменения в случайной
и тренд-циклической компонентах. С увеличением
продолжительности временного промежутка,
измеряемого в месяцах или, в случае квартального
варианта метода <i>X-11</i> - в кварталах года,
изменения в тренд-циклической компоненте, вообще
говоря, будут нарастать, в то время как изменения
случайной составляющей должны оставаться
примерно на одном уровне. Средняя длина
временного интервала, на котором изменения
тренд-циклической компоненты становятся
примерно равными изменениям случайной
компоненты, называется <i>месяцем (кварталом)
циклического доминирования</i>, или сокращенно
МЦД (соответственно КЦД). Например, если МЦД равно
двум, то на сроках более двух месяцев
тренд-циклическая компонента станет
доминировать над флуктуациями нерегулярной
(случайной) компоненты. Эти и другие результаты
более подробно будут обсуждаться далее. </p>

<p>&nbsp;<a name="result"></a> </p>

<p><font SIZE="4" COLOR="navy">Таблицы результатов
корректировки <i>X-11</i> </font></p>

<p>Вычисления, которые производятся в процедуре
&nbsp; <i>X-11</i>, лучше всего обсуждать в контексте
таблиц результатов, которые при этом выдаются.
Процедура корректировки разбивается на семь
этапов, которые обычно обозначаются буквами <i>A</i>
- <i>G</i>. 

<ol TYPE="A">
  <li><b>Априорная корректировка (помесячная сезонная
    корректировка). </b>Перед тем, как к временному
    ряду, содержащему ежемесячные значения, будет
    применяться какая-либо сезонная корректировка,
    могут быть произведены различные корректировки,
    заданные пользователем. Можно ввести еще один
    временной ряд, содержащий априорные
    корректирующие факторы; значения этого ряда
    будут вычитаться из исходного ряда (аддитивная
    модель), или же значения исходного ряда будут
    поделены на значения корректирующего ряда
    (мультипликативная модель). В случае
    мультипликативной модели пользователь может
    также определить свои собственные поправочные
    коэффициенты (веса) на число рабочих дней. Эти
    веса будут использоваться для корректировки
    ежемесячных наблюдений, так чтобы учитывалось
    число рабочих дней в этом месяце. </li>
  <li><b>Предварительное оценивание вариации числа
    рабочих дней (месячный вариант <i>X-11</i>) и весов. </b>На
    следующем шаге вычисляются предварительные
    поправочные коэффициенты на число рабочих дней
    (только в месячном варианте <i>X-11</i>) и веса,
    позволяющие уменьшить эффект выбросов. </li>
  <li><b>Окончательное оценивание вариации числа
    рабочих дней и нерегулярных весов (месячный
    вариант <i>X-11</i>). </b>Поправки и веса, вычисленные в
    пункте <i>B, </i>используются для построения
    улучшенных оценок тренд-циклической и сезонной
    компонент. Эти улучшенные оценки используются
    для окончательного вычисления факторов числа
    рабочих дней (в месячном варианте <i>X-11</i>) и весов. </li>
  <li><b>Окончательное оценивание сезонных факторов,
    тренд-циклической, нерегулярной и сезонно
    скорректированной компонент ряда. </b>Окончательные
    значения факторов рабочих дней и весов,
    вычисленные в пункте <i>C, </i>используются для
    вычисления окончательных оценок для компонент
    ряда. </li>
  <li><b>Модифицированные ряды: исходный, сезонно
    скорректированный и нерегулярный. </b>Исходный и
    окончательный сезонно скорректированный ряды, а
    также нерегулярная компонента модифицируются
    путем сглаживания выбросов. Полученные в
    результате этого, модифицированные ряды
    позволяют пользователю проверить устойчивость
    сезонной корректировки. </li>
  <li><b>Месяц (квартал) циклического доминирования
    (МЦД, КЦД), скользящее среднее и сводные
    показатели. </b>IНа этом этапе вычислений
    рассчитываются различные сводные
    характеристики (см. далее), позволяющие
    пользователю исследовать относительную
    важность разных компонент, среднюю флуктуацию от
    месяца к месяцу (от квартала к кварталу), среднее
    число идущих подряд изменений в одну сторону и
    др. </li>
  <li><b>Графики. </b>Наконец, вы можете построить
    различные графики итоговых результатов.
    Например, можно построить окончательно
    скорректированный ряд в хронологическом порядке
    или по месяцам (см. ниже). </li>
</ol>

<p>&nbsp;<a NAME="specific"></a></p>

<p><font SIZE="4" COLOR="navy">Подробное описание всех таблиц
результатов, вычисляемых в методе <i>X-11</i> </font></p>

<p>На каждом из этапов <i>A</i> - <i>G</i> (см. раздел <a HREF="sttimser.html#result">Таблицы результатов
корректировки <i>X-11</i></a>) вычислялись различные
таблицы результатов. Обычно все они нумеруются, а
также им приписывается буква, соответствующая
этапу анализа. Например, таблица <i>B 11</i> содержит
предварительно сезонно скорректированный ряд; <i>C
11 </i>- это более точно сезонно скорректированный
ряд, а <i>D 11</i> - окончательный сезонно
скорректированный ряд. Далее приводится
перечень всех таблиц. Таблицы, помеченные
звездочкой (*), недоступны (или неприменимы) при
анализе квартальных показателей. Кроме того, в
случае квартальной корректировки некоторые из
описанных ниже вычислений несколько
видоизменяются. Так, например, для вычисления
сезонных факторов вместо 12-периодного (т.е.
12-месячного) скользящего среднего используется
4-периодное (4-квартальное) скользящее среднее;
предварительная тренд-циклическая компонента
вычисляется по центрированному 4-периодному
скользящему среднему, а окончательная оценка
тренд-циклической компоненты вычисляется по
5-точечному среднему Хендерсона.</p>

<p>В соответствии со стандартом метода <i>X-11</i>,
принятым Бюро переписи США, предусмотрены три
степени подробности вывода: <i>Стандартный </i>(17 - 27
таблиц), <i>Длинный </i>(27 - 39 таблиц) и <i>Полный </i>(44 -
59 таблиц). Имеется также возможность выводить
только таблицы результатов, выбранные
пользователем. В следующих далее описаниях
таблиц, буквы <i>С</i>, <i>Д </i>и <i>П </i>рядом с
названием таблицы указывают, какие таблицы
выводятся и/или распечатываются в
соответствующем варианте вывода. (Для графиков
предусмотрены два уровня подробности вывода: <i>Стандартный
</i>и <i>Все</i>.) </p>

<p align="center">Щелкните на имени таблицы для
получения информации о ней. </p>
<div align="center"><center>

<table WIDTH="90%">
  <tr>
    <td><a HREF="../glossary/gloss_k.html#X11 output: A 1.  Original Series">* A 1.
    Исходный ряд <i>(С)</i></a><br>
    </td>
  </tr>
  <tr>
    <td><a HREF="../glossary/gloss_k.html#X11 output: A 2.  Prior Monthly Adjustment Factors">*
    A 2. Априорные месячные поправки <i>(С)</i></a><br>
    </td>
  </tr>
  <tr>
    <td><a HREF="../glossary/gloss_k.html#X11 output: A 3.  Original Series Adjusted by Prior Monthly Adjustment Factors">*
    A 3. Исходный ряд, скорректированный с помощью
    априорных месячных поправок <i>(С)</i></a><br>
    </td>
  </tr>
  <tr>
    <td><a HREF="../glossary/gloss_k.html#X11 output: A 4.  Prior Trading Day Adjustment Factors">* A
    4. Априорные поправки на рабочие дни <i>(С)</i></a><br>
    </td>
  </tr>
  <tr>
    <td><a HREF="../glossary/gloss_k.html#X11 output: B 1.  Prior Adjusted Series or Original Series">B
    1. Ряд после априорной корректировки либо
    исходный ряд <i>(С)</i></a><br>
    </td>
  </tr>
  <tr>
    <td><a HREF="../glossary/gloss_k.html#X11 output: B 2.  Trend-cycle">B 2.
    Тренд-цикл <i>(Д)</i></a><br>
    </td>
  </tr>
  <tr>
    <td><a HREF="../glossary/gloss_k.html#X11 output: B 3.  Unmodified S-I Differences or Ratios">B
    3. Немодифицированные S-I разности или отношения <i>(П)</i></a><br>
    </td>
  </tr>
  <tr>
    <td><a HREF="../glossary/gloss_k.html#X11 output: B 4.  Replacement Values for Extreme S-I Differences (Ratios)">B
    4. Значения для замены выбросов S-I разностей
    (отношений) <i>(П)</i></a><br>
    </td>
  </tr>
  <tr>
    <td><a HREF="../glossary/gloss_k.html#X11 output: B 5.  Seasonal Factors">B 5.
    Сезонная составляющая <i>(П)</i></a><br>
    </td>
  </tr>
  <tr>
    <td><a HREF="../glossary/gloss_k.html#X11 output: B 6.  Seasonally Adjusted Series">B 6.
    Сезонная корректировка ряда <i>(П)</i></a><br>
    </td>
  </tr>
  <tr>
    <td><a HREF="../glossary/gloss_k.html#X11 output: B 7.  Trend-cycle">B 7.
    Тренд-цикл <i>(Д)</i></a><br>
    </td>
  </tr>
  <tr>
    <td><a HREF="../glossary/gloss_k.html#X11 output: B 8.  Unmodified S-I Differences (Ratios)">B 8.
    Немодифицированные S-I разности (отношения) <i>(П)</i></a><br>
    </td>
  </tr>
  <tr>
    <td><a HREF="../glossary/gloss_k.html#X11 output: B 9.  Replacement Values for Extreme S-I Differences (Ratios)">B
    9. Значения для замены выбросов S-I разностей
    (отношений) <i>(П)</i></a><br>
    </td>
  </tr>
  <tr>
    <td><a HREF="../glossary/gloss_k.html#X11 output: B 10.  Seasonal Factors">B 10.
    Сезонная составляющая <i>(Д)</i></a><br>
    </td>
  </tr>
  <tr>
    <td><a HREF="../glossary/gloss_k.html#X11 output: B 11.  Seasonally Adjusted Series">B 11.
    Сезонная корректировка ряда <i>(П)</i></a><br>
    </td>
  </tr>
  <tr>
    <td>B 12. (не используется) </td>
  </tr>
  <tr>
    <td><a HREF="../glossary/gloss_k.html#X11 output: B 13.  Irregular Series">B 13.
    Нерегулярная составляющая ряда <i>(Д)</i></a><br>
    </td>
  </tr>
  <tr>
    <td><b>Таблицы B 14 - B 16, B 18 и B 19: Поправка на число
    рабочих дней. </b>Эти таблицы доступны только при
    анализе ежемесячных данных. Число разных дней
    недели (понедельников, вторников и т.д.)
    колеблется от месяца к месяцу. Бывают ряды, в
    которых различия в числе рабочих дней в месяце
    могут давать заметный разброс ежемесячных
    показателей (например, месячный доход парка
    аттракционов сильно зависит от того, сколько в
    этом месяце было выходных дней). Пользователь
    имеет возможность определить начальные веса для
    каждого дня недели (см. <a HREF="../glossary/gloss_k.html#X11 output: A 4.  Prior Trading Day Adjustment Factors"><i>A
    4</i></a>), и/или эти веса могут быть оценены по данным
    (пользователь также может сделать использование
    этих весов условным, т.е. только в тех случаях,
    когда они объясняют значительную часть
    дисперсии).</td>
  </tr>
  <tr>
    <td><a HREF="../glossary/gloss_k.html#X11 output: B 14.  Extreme Irregular Values Excluded from Trading-day Regression">*
    B 14. Выбросы нерегулярной составляющей,
    исключенные из регрессии рабочих дней <i>(Д)</i></a><br>
    </td>
  </tr>
  <tr>
    <td><a HREF="../glossary/gloss_k.html#X11 output: B 15.  Preliminary Trading-day Regression">* B
    15. Предварительная регрессия рабочих дней <i>(Д)</i></a><br>
    </td>
  </tr>
  <tr>
    <td><a HREF="../glossary/gloss_k.html#X11 output: B 16.  Trading-day Adjustment Factors Derived from Regression Coefficients">*
    B 16. Поправки на число рабочих дней, полученные из
    коэффициентов регрессии <i>(П)</i></a><br>
    </td>
  </tr>
  <tr>
    <td><a HREF="../glossary/gloss_k.html#X11 output: B 17.  Preliminary Weights for Irregular Component">B
    17. Предварительные веса нерегулярной компоненты <i>(Д)</i></a><br>
    </td>
  </tr>
  <tr>
    <td><a HREF="../glossary/gloss_k.html#X11 output: B 18.  Trading-day Factors Derived from Combined Daily Weights">*
    B 18. Поправки на число рабочих дней, полученные из
    комбинированных весов дней недели <i>(П)</i></a><br>
    </td>
  </tr>
  <tr>
    <td><a HREF="../glossary/gloss_k.html#X11 output: B 19.  Original Series Adjusted for Trading-day and Prior Variation">*
    B 19. Исходный ряд с поправками на рабочие дни и
    априорную вариацию <i>(П)</i></a><br>
    </td>
  </tr>
  <tr>
    <td><a HREF="../glossary/gloss_k.html#X11 output: C 1.  Original Series Modified by Preliminary Weights and Adjusted for Trading-day and Prior Variation">C
    1. Исходный ряд, модифицированный с помощью
    предварительных весов, с поправкой на рабочие
    дни и априорную вариацию <i>(Д)</i></a><br>
    </td>
  </tr>
  <tr>
    <td><a HREF="../glossary/gloss_k.html#X11 output: C 2.  Trend-cycle">C 2.
    Тренд-цикл <i>(П)</i></a><br>
    </td>
  </tr>
  <tr>
    <td>C 3. (не используется) </td>
  </tr>
  <tr>
    <td><a HREF="../glossary/gloss_k.html#X11 output: C 4.  Modified S-I Differences (Ratios)">C
    4. Модифицированные S-I разности (отношения) <i>(П)</i></a><br>
    </td>
  </tr>
  <tr>
    <td><a HREF="../glossary/gloss_k.html#X11 output: C 5.  Seasonal Factors">C 5.
    Сезонная составляющая <i>(П)</i></a><br>
    </td>
  </tr>
  <tr>
    <td><a HREF="../glossary/gloss_k.html#X11 output: C 6.  Seasonally Adjusted Series">C 6.
    Сезонная корректировка ряда <i>(П)</i></a><br>
    </td>
  </tr>
  <tr>
    <td><a HREF="../glossary/gloss_k.html#X11 output: C 7.  Trend-cycle">C 7.
    Тренд-цикл <i>(Д)</i></a><br>
    </td>
  </tr>
  <tr>
    <td>C 8. (не используется) </td>
  </tr>
  <tr>
    <td><a HREF="../glossary/gloss_k.html#X11 output: C 9.  Modified S-I Differences (Ratios)">C
    9. Модифицированные S-I разности (отношения) <i>(П)</i></a><br>
    </td>
  </tr>
  <tr>
    <td><a HREF="../glossary/gloss_k.html#X11 output: C 10.  Seasonal Factors">C 10.
    Сезонная составляющая <i>(Д)</i></a><br>
    </td>
  </tr>
  <tr>
    <td><a HREF="../glossary/gloss_k.html#X11 output: C 11.  Seasonally Adjusted Series">C 11.
    Сезонная корректировка ряда <i>(П)</i> </a><br>
    </td>
  </tr>
  <tr>
    <td>C 12. (не используется) </td>
  </tr>
  <tr>
    <td><a HREF="../glossary/gloss_k.html#X11 output: C 13.  Irregular Series">C 13.
    Нерегулярная составляющая <i>(С)</i></a><br>
    </td>
  </tr>
  <tr>
    <td><b>Таблицы C 14 - C 16, C 18 и C 19: Поправка на число
    рабочих дней. </b>Эти таблицы доступны только при
    анализе ежемесячных данных и если при этом
    требуется поправка на различное число рабочих
    дней. В этом случае поправки на число рабочих
    дней вычисляются по уточненным значениям
    сезонно скорректированных рядов аналогично
    тому, как это делалось в пункте <i>B</i> (<i>B 14 </i>- <i>B 16</i>,
    <i>B 18</i>, <i>B 19</i>). </td>
  </tr>
  <tr>
    <td><a HREF="../glossary/gloss_k.html#X11 output: C 14.  Extreme Irregular Values Excluded from Trading-day Regression">*
    C 14. Выбросы нерегулярной составляющей,
    исключенные из регрессии рабочих дней <i>(С)</i></a><br>
    </td>
  </tr>
  <tr>
    <td><a HREF="../glossary/gloss_k.html#X11 output: C 15.  Final Trading-day Regression">* C
    15. Регрессия рабочих дней - окончательный вариант
    <i>(С)</i></a><br>
    </td>
  </tr>
  <tr>
    <td><a HREF="../glossary/gloss_k.html#X11 output: C 16.  Final Trading-day Adjustment Factors Derived from Regression X11 output: Coefficients">*
    C 16. Поправки на число рабочих дней, полученные из
    коэффициентов регрессии, - окончательный вариант
    <i>(С)</i></a><br>
    </td>
  </tr>
  <tr>
    <td><a HREF="../glossary/gloss_k.html#X11 output: C 17.  Final Weights for Irregular Component">C
    17. Окончательные веса нерегулярной компоненты <i>(С)</i></a><br>
    </td>
  </tr>
  <tr>
    <td><a HREF="../glossary/gloss_k.html#X11 output: C 18.  Final Trading-day Factors Derived From Combined Daily Weights">*
    C 18. Поправки на число рабочих дней, полученные из
    комбинированных весов дней недели -
    окончательный вариант <i>(С)</i></a><br>
    </td>
  </tr>
  <tr>
    <td><a HREF="../glossary/gloss_k.html#X11 output: C 19.  Original Series Adjusted for Trading-day and Prior Variation">*
    C 19. Исходный ряд с поправками на рабочие дни и
    априорную вариацию <i>(С)</i></a><br>
    </td>
  </tr>
  <tr>
    <td><a HREF="../glossary/gloss_k.html#X11 output: D 1.  Original Series Modified by Final Weights and Adjusted for Trading-day and Prior Variation">D
    1. Исходный ряд, модифицированный с помощью
    окончательных весов, с поправкой на рабочие дни и
    априорную вариацию <i>(Д)</i></a><br>
    </td>
  </tr>
  <tr>
    <td><a HREF="../glossary/gloss_k.html#X11 output: D 2.  Trend-cycle">D 2.
    Тренд-цикл <em>(П)</em></a><br>
    </td>
  </tr>
  <tr>
    <td>D 3. (не используется) </td>
  </tr>
  <tr>
    <td><a HREF="../glossary/gloss_k.html#X11 output: D 4.  Modified S-I Differences (Ratios)">D
    4. Модифицированные S-I разности (отношения) <i>(П)</i></a><br>
    </td>
  </tr>
  <tr>
    <td><a HREF="../glossary/gloss_k.html#X11 output: D 5.  Seasonal Factors">D 5.
    Сезонная составляющая <i>(П)</i></a><br>
    </td>
  </tr>
  <tr>
    <td><a HREF="../glossary/gloss_k.html#X11 output: D 6.  Seasonally Adjusted Series">D 6.
    Сезонная корректировка ряда <i>(П)</i></a><br>
    </td>
  </tr>
  <tr>
    <td><a HREF="../glossary/gloss_k.html#X11 output: D 7.  Trend-cycle">D 7.
    Тренд-цикл <i>(Д)</i></a><br>
    </td>
  </tr>
  <tr>
    <td><a HREF="../glossary/gloss_k.html#X11 output: D 8.  Final Unmodified S-I Differences (Ratios)">D
    8. Немодифицированные S-I разности (отношения) -
    окончательный вариант <i>(С)</i></a><br>
    </td>
  </tr>
  <tr>
    <td><a HREF="../glossary/gloss_k.html#X11 output: D 9.  Final Replacement Values for Extreme S-I Differences (Ratios)">D
    9. Окончательные значения для замены выбросов S-I
    разностей (отношений) <i>(С)</i></a><br>
    </td>
  </tr>
  <tr>
    <td><a HREF="../glossary/gloss_k.html#X11 output: D 10.  Final Seasonal Factors">D 10.
    Сезонная составляющая - окончательный вариант <i>(С)</i></a><br>
    </td>
  </tr>
  <tr>
    <td><a HREF="../glossary/gloss_k.html#X11 output: D 11.  Final Seasonally Adjusted Series">D
    11. Сезонная корректировка ряда - окончательный
    вариант <i>(С)</i></a><br>
    </td>
  </tr>
  <tr>
    <td><a HREF="../glossary/gloss_k.html#X11 output: D 12.  Final Trend-cycle">D 12.
    Тренд-циклическая компонента - окончательный
    вариант <i>(С)</i></a><br>
    </td>
  </tr>
  <tr>
    <td><a HREF="../glossary/gloss_k.html#X11 output: D 13.  Final Irregular">D 13.
    Нерегулярная составляющая - окончательный
    вариант <i>(С)</i></a><br>
    </td>
  </tr>
  <tr>
    <td><a HREF="../glossary/gloss_k.html#X11 output: E 1.  Modified Original Series">E 1.
    Модифицированный исходный ряд <i>(С)</i></a><br>
    </td>
  </tr>
  <tr>
    <td><a HREF="../glossary/gloss_k.html#X11 output: E 2.  Modified Seasonally Adjusted Series">E 2.
    Модифицированный ряд с сезонной поправкой <i>(С)</i></a><br>
    </td>
  </tr>
  <tr>
    <td><a HREF="../glossary/gloss_k.html#X11 output: E 3.  Modified Irregular Series">E 3.
    Модифицированная нерегулярная составляющая <i>(С)</i></a><br>
    </td>
  </tr>
  <tr>
    <td><a HREF="../glossary/gloss_k.html#X11 output: E 4.  Differences (Ratios) of Annual Totals">E
    4. Разности (отношения) годовых сумм <i>(С)</i></a><br>
    </td>
  </tr>
  <tr>
    <td><a HREF="../glossary/gloss_k.html#X11 output: E 5.  Differences (Percent Changes) in Original Series">E
    5. Разности (относительные изменения) исходного
    ряда <i>(С)</i></a><br>
    </td>
  </tr>
  <tr>
    <td><a HREF="../glossary/gloss_k.html#X11 output: E 6.  Differences (Percent Changes) in Final Seasonally Adjusted Series">E
    6. Разности (относительные изменения)
    окончательного варианта ряда с сезонной
    поправкой <i>(С)</i></a><br>
    </td>
  </tr>
  <tr>
    <td><a HREF="../glossary/gloss_k.html#X11 output: F 1.  MCD (QCD) Moving Average">F 1.
    МЦД (КЦД) скользящее среднее <i>(С)</i></a><br>
    </td>
  </tr>
  <tr>
    <td><a HREF="../glossary/gloss_k.html#X11 output: F 2.  Summary Measures">F 2.
    Сводные показатели <i>(С)</i></a><br>
    </td>
  </tr>
  <tr>
    <td><a HREF="../glossary/gloss_k.html#X11 output: G 1.  Chart">G 1. График <i>(С)</i></a><br>
    </td>
  </tr>
  <tr>
    <td><a HREF="../glossary/gloss_k.html#X11 output: G 2.  Chart">G 2. График <i>(С)</i></a><br>
    </td>
  </tr>
  <tr>
    <td><a HREF="../glossary/gloss_k.html#X11 output: G 3.  Chart">G 3. График <i>(В)</i></a><br>
    </td>
  </tr>
  <tr>
    <td><a HREF="../glossary/gloss_k.html#X11 output: G 4.  Chart">G 4. График <i>(В)</i></a><br>
    </td>
  </tr>
</table>
</center></div>

<table ALIGN="RIGHT">
  <tr>
    <td><font SIZE="1"><a HREF="sttimser.html#index">В начало</a></font> </td>
  </tr>
</table>

<p><br CLEAR="RIGHT">
</p>

<hr SIZE="1">

<p>&nbsp;<a NAME="lags"></a> </p>
<font SIZE="5" COLOR="navy">

<p>Анализ распределенных лагов </font>

<ul>
  <li><a HREF="sttimser.html#dgeneral">Общая цель</a> </li>
  <li><a HREF="sttimser.html#model">Общая модель</a> </li>
  <li><a HREF="sttimser.html#almon">Распределенный лаг Алмона</a> </li>
</ul>

<p>За дальнейшей информацией обратитесь к <a HREF="sttimser.html#index">Анализу временных рядов</a> и
следующим разделам: 

<ul>
  <li><a HREF="sttimser.html#identifying">Идентификация модели
    временных рядов</a> </li>
  <li><a HREF="sttimser.html#arima">АРПСС (Бокс и Дженкинс) и
    автокорреляции Вводный обзор АРПСС</a> </li>
  <li><a HREF="sttimser.html#interrupted">Прерванные временные ряды</a>
  </li>
  <li><a HREF="sttimser.html#exponential">Экспоненциальное
    сглаживание</a> </li>
  <li><a HREF="sttimser.html#census">Сезонная декомпозиция (метод
    Census I)</a> </li>
  <li><a HREF="sttimser.html#x">Сезонная корректировка <i>X-11</i>
    (метод Census II)</a> </li>
  <li><a HREF="sttimser.html#result">Таблицы результатов
    корректировки <i>X-11</i></a> </li>
  <li><a HREF="sttimser.html#single">Одномерный анализ Фурье</a> </li>
  <li><a HREF="sttimser.html#cross">Кросс-спектральный анализ</a> </li>
  <li><a HREF="sttimser.html#spectrum">Основные понятия и принципы</a>
  </li>
  <li><a HREF="sttimser.html#fast">Быстрое преобразование Фурье</a> </li>
</ul>

<p>&nbsp;<a NAME="dgeneral"></a></p>
<font SIZE="4" COLOR="navy">

<p>Общая цель </font></p>

<p>Анализ распределенных лагов - это специальный
метод оценки запаздывающей зависимости между
рядами. Например, предположим, вы производите
компьютерные программы и хотите установить
зависимость между числом запросов, поступивших
от покупателей, и числом реальных заказов. Вы
могли бы записывать эти данные ежемесячно в
течение года и затем рассмотреть зависимость
между двумя переменными: число запросов и число
заказов зависит от запросов, но зависит с
запаздыванием. Однако очевидно, что запросы
предшествуют заказам, поэтому можно ожидать, что
число заказов. Иными словами, в зависимости между
числом запросов и числом продаж имеется
временной сдвиг (лаг) (см. также автокорреляции и
кросскорреляции).</p>

<p>Такого рода зависимости с запаздыванием
особенно часто возникают в эконометрике.
Например, доход от инвестиций в новое
оборудование отчетливо проявится не сразу, а
только через определенное время. Более высокий
доход изменяет выбор жилья людьми; однако эта
зависимость, очевидно, тоже проявляется с
запаздыванием. [Подобные задачи возникают в
страховании, где временной ряд клиентов и ряд
денежных поступлений сдвинуты друг относительно
друга]. </p>

<p>Во всех этих случаях, имеется независимая или <i>объясняющая
</i>переменная, которая воздействует на <i>зависимые
</i>переменные с некоторым запаздыванием (лагом).
Метод распределенных лагов позволяет
исследовать такого рода зависимость. </p>

<p>Подробные обсуждения зависимостей с
распределенными лагами имеются в
эконометрических учебниках, например, в Judge, Griffith,
Hill, Luetkepohl, and Lee (1985), Maddala (1977), and Fomby, Hill, and Johnson (1984).
Ниже дается краткое описание этих методов.
Предполагается, что вы знакомы с понятием
корреляции (см. <a HREF="stbasic.html"><i>Основные
статистики и таблицы</i></a>), кросскорреляции и
основными идеями множественной регрессии (см. <a HREF="stmulreg.html"><i>Множественная регрессия</i></a>). </p>

<p>&nbsp;<a NAME="model"></a></p>

<p><font SIZE="4" COLOR="navy">Общая модель </font></p>

<p>Пусть <i>y</i> - зависимая переменная, a независимая
или объясняющая <i>x.</i> Эти переменные измеряются
несколько раз в течение определенного отрезка
времени. В некоторых учебниках по эконометрике
зависимая переменная называется также <i>эндогенной
</i>переменной, a зависимая или объясняемая
переменная <i>экзогенной</i> переменной.
Простейший способ описать зависимость между
этими двумя переменными дает следующее линейное
уравнение: </p>

<p><font color="blue">Y<sub>t</sub> = <img src="../graphics/sigmablu.gif" align="absmiddle" WIDTH="12" HEIGHT="19"> <img src="../graphics/betablue.gif" align="absmiddle" WIDTH="12" HEIGHT="17"><sub>i</sub>*x<sub>t-i</sub>
</font></p>

<p>В этом уравнении значение зависимой переменной
в момент времени&nbsp; <font color="blue"><i>t</i></font> является
линейной функцией переменной <font color="blue"><i>x</i></font>,
измеренной в моменты <i><font color="blue">t</font>, <font color="blue">t-1</font>,
<font color="blue">t-2</font></i> и т.д. Таким образом, зависимая
переменная представляет собой линейные функции <font color="blue"><i>x</i></font> и <i><font color="blue">x</font></i>, <i>сдвинутых </i>на
<i>1</i>, <i>2</i>, и т.д. временные периоды. <i>Бета </i>коэффициенты
(<img SRC="../graphics/betablue.gif" ALIGN="ABSMIDDLE" WIDTH="12" HEIGHT="17">i) могут
рассматриваться как параметры наклона в этом
уравнении. Будем рассматривать это уравнение как
специальный случай уравнения линейной регрессии
(см. раздел <a HREF="stmulreg.html"><i>Множественная
регрессия</i></a>). Если коэффициент переменной с
определенным запаздыванием (лагом) значим, то
можно заключить, что переменная <i>y</i>
предсказывается (или объясняется) с
запаздыванием. </p>

<p>&nbsp;<a NAME="almon"></a></p>

<p><font SIZE="4" COLOR="navy">Распределенный лаг Алмона </font></p>

<p>Обычная проблема, возникающая в множественной
регрессии, состоит в том, что соседние значения <i>x</i>
сильно коррелируют. В самом крайнем случае, это
приводит к тому, что корреляционная матрица не
будет обратимой и коэффициенты <i>бета </i>не могут
быть вычислены. В менее экстремальных ситуациях
вычисления этих коэффициентов и их стандартные
ошибки становятся ненадежными из-за
вычислительных ошибок (ошибок округления). В
контексте множественной регрессии эта проблема
хорошо известна как проблема <i>мультиколлинеарности
</i>(см. раздел <a HREF="stmulreg.html"><i>Множественная
регрессия</i></a>). </p>

<p>Алмон (1965) предложил специальную процедуру,
которая в данном случае уменьшает
мультиколлинеарность. Именно, пусть каждый
неизвестный коэффициент записан в виде: </p>

<p><font color="blue"><img src="../graphics/betablue.gif" align="absmiddle" WIDTH="12" HEIGHT="17"><sub>i</sub> =
<img src="../graphics/alphablu.gif" align="absmiddle" WIDTH="16" HEIGHT="9"><sub>0</sub> + <img src="../graphics/alphablu.gif" align="absmiddle" WIDTH="16" HEIGHT="9"><sub>1</sub>*i + ... + <img src="../graphics/alphablu.gif" align="absmiddle" WIDTH="16" HEIGHT="9"><sub>q</sub>*i<sup>q</sup> </font></p>

<p>Алмон показал, что во многих случаях (в
частности, чтобы избежать мультиколлинеарности)
легче оценить коэффициенты <i>альфа</i>, чем
непосредственно коэффициенты <i>бета</i>. Такой
метод оценивания коэффициентов <i>бета</i>
называется <i>полиномиальной аппроксимацией</i>. </p>

<p><strong>Неправильная спецификация.</strong> Общая
проблема полиномиальной аппроксимации, состоит
в том, что длина лага и степень полинома
неизвестны <i>заранее</i>. Последствия
неправильного определения (спецификации) этих
параметров потенциально серьезны (в силу
смещения, возникающего в оценках при
неправильном задании параметров). Этот вопрос
подробно обсуждается в книгах Frost (1975), Schmidt and Waud
(1973), Schmidt and Sickles (1975) и Trivedi and Pagan (1979). </p>

<hr SIZE="1">

<p>&nbsp;<a NAME="single"></a></p>
<font SIZE="5" COLOR="navy">

<p>Одномерный анализ Фурье</font></p>

<p>В спектральном анализе исследуются
периодические модели данных. Цель анализа -
разложить комплексные временные ряды с
циклическими компонентами на несколько основных
синусоидальных функций с определенной длиной
волн. Термин &quot;спектральный&quot; - своеобразная
метафора для описания природы этого анализа.
Предположим, вы изучаете луч белого солнечного
света, который, на первый взгляд, кажется
хаотически составленным из света с различными
длинами волн. Однако, пропуская его через призму,
вы можете отделить волны разной длины или
периодов, которые составляют белый свет.
Фактически, применяя этот метод, вы можете теперь
распознавать и различать разные источники света.
Таким образом, распознавая существенные
основные периодические компоненты, вы узнали
что-то об интересующем вас явлении. В сущности,
применение спектрального анализа к временным
рядам подобно пропусканию света через призму. В
результате успешного анализа можно обнаружить
всего несколько повторяющихся циклов различной
длины в интересующих вас временных рядах,
которые, на первый взгляд, выглядят как случайный
шум.</p>

<p>Наиболее известный пример применения
спектрального анализа - циклическая природа
солнечных пятен (например, см. Блумфилд, 1976 или
Шамвэй, 1988). Оказывается, что активность
солнечных пятен имеет 11-ти летний цикл. Другие
примеры небесных явлений, изменения погоды,
колебания в товарных ценах, экономическая
активность и т.д. также часто используются в
литературе для демонстрации этого метода. В
отличие от АРПСС или метода экспоненциального
сглаживания (см. разделы <a HREF="sttimser.html#arima">АРПСС</a>
и <a HREF="sttimser.html#exponential">Экспоненциальное
сглаживание</a>), цель спектрального анализа -
распознать сезонные колебания различной длины, в
то время как в предшествующих типах анализа,
длина сезонных компонент обычно известна (или
предполагается) <i>заранее</i> и затем включается в
некоторые теоретические модели скользящего
среднего или автокорреляции. </p>

<p>Классический текст по спектральному анализу -
Bloomfield (1976); однако другие подробные обсуждения
могут быть найдены в Jenkins and Watts (1968), Brillinger (1975), Brigham
(1974), Elliott and Rao (1982), Priestley (1981), Shumway (1988) или Wei (1989). </p>

<p>За дальнейшей информацией обратитесь к <a HREF="sttimser.html#index">Анализу временных рядов</a> и
следующим разделам: 

<ul>
  <li><a HREF="sttimser.html#spectrum">Основные понятия и принципы</a>
  </li>
  <li><a HREF="sttimser.html#fast">Быстрое преобразование Фурье</a> </li>
  <li><a HREF="sttimser.html#identifying">Идентификация модели
    временных рядов</a> </li>
  <li><a HREF="sttimser.html#arima">АРПСС (Бокс и Дженкинс) и
    автокорреляции Вводный обзор АРПСС</a> </li>
  <li><a HREF="sttimser.html#interrupted">Прерванные временные ряды</a>
  </li>
  <li><a HREF="sttimser.html#lags">Анализ распределенных лагов</a> </li>
  <li><a HREF="sttimser.html#census">Сезонная декомпозиция (метод
    Census I)</a> </li>
  <li><a HREF="sttimser.html#exponential">Экспоненциальное
    сглаживание</a> </li>
  <li><a HREF="sttimser.html#cross">Кросс-спектральный анализ</a> </li>
</ul>

<hr SIZE="1">

<p>&nbsp;<a NAME="cross"></a></p>
<font SIZE="5" COLOR="navy">

<p>Кросс-спектральный анализ</font> 

<ul>
  <li><a HREF="sttimser.html#sgeneral">Общее введение</a> </li>
  <li><a HREF="sttimser.html#notation">Основные понятия и принципы</a>
  </li>
  <li><a HREF="sttimser.html#results">Результаты для каждой
    переменной</a> </li>
  <li><a HREF="sttimser.html#periodogram">Кросс-периодограмма,
    кросс-плотность, квадратурная плотность и
    кросс-амплитуда</a> </li>
  <li><a HREF="sttimser.html#squared">Квадрат когерентности,
    усиление и фазовый сдвиг</a> </li>
  <li><a HREF="sttimser.html#hows">Как создавались данные для
    примера</a> </li>
</ul>

<p>За дальнейшей информацией обратитесь к <a HREF="sttimser.html#index">Анализу временных рядов</a> и
следующим разделам: 

<ul>
  <li><a HREF="sttimser.html#identifying">Идентификация модели
    временных рядов</a> </li>
  <li><a HREF="sttimser.html#arima">АРПСС (Бокс и Дженкинс) и
    автокорреляции Вводный обзор АРПСС</a> </li>
  <li><a HREF="sttimser.html#interrupted">Прерванные временные ряды</a>
  </li>
  <li><a HREF="sttimser.html#exponential">Экспоненциальное
    сглаживание</a> </li>
  <li><a HREF="sttimser.html#census">Сезонная декомпозиция (метод
    Census I)</a> </li>
  <li><a HREF="sttimser.html#x">Сезонная корректировка <i>X-11</i>
    (метод Census II)</a> </li>
  <li><a HREF="sttimser.html#result">Таблицы результатов
    корректировки <i>X-11</i></a> </li>
  <li><a HREF="sttimser.html#lags">Анализ распределенных лагов</a> </li>
  <li><a HREF="sttimser.html#single">Одномерный анализ Фурье</a> </li>
  <li><a HREF="sttimser.html#spectrum">Основные понятия и принципы</a>
  </li>
  <li><a HREF="sttimser.html#fast">Быстрое преобразование Фурье</a> </li>
</ul>

<p>&nbsp;<a NAME="sgeneral"></a></p>
<font SIZE="4" COLOR="navy">

<p>Общее введение </font></p>

<p>Кросс-спектральный анализ развивает <a HREF="sttimser.html#single"><i>Одномерный анализ Фурье</i></a> и
позволяет анализировать одновременно два ряда.
Мы предполагаем, что вы уже прочитали введение к
разделу одномерного спектрального анализа.
Подробное обсуждение кросс-спектрального
анализа можно найти в книгах Bloomfield (1976), Jenkins and Watts
(1968), Brillinger (1975), Brigham (1974), Elliott and Rao (1982), Priestley (1981),
Shumway (1988), or Wei (1989).</p>

<p><strong>Периодичность ряда на определенных
частотах. </strong>Наиболее известный пример
применения спектрального анализа - циклическая
природа солнечных пятен (например, см. Блумфилд,
1976 или Шамвэй, 1988). Оказывается, что активность
солнечных пятен имеет 11-ти летний цикл. Другие
примеры небесных явлений, изменения погоды,
колебания в товарных ценах, экономическая
активность и т.д. также часто используются в
литературе для демонстрации этого метода. </p>

<p>&nbsp;<a NAME="notation"></a> </p>

<p><font SIZE="4" COLOR="navy">Основные понятия и принципы </font></p>

<p><b>Простой пример.</b> Рассмотрим следующие два
ряда с 16 наблюдениями:</p>

<table border="1">
  <tr>
    <th>&nbsp;</th>
    <th align="right"><font size="2" color="blue">ПЕРЕМ1</font></th>
    <th align="right"><font size="2" color="blue">ПЕРЕМ2</font></th>
  </tr>
  <tr>
    <th align="right"><font size="2" color="blue">1<br>
    2<br>
    3<br>
    4<br>
    5<br>
    6<br>
    7<br>
    8<br>
    9<br>
    10<br>
    11<br>
    12<br>
    13<br>
    14<br>
    15<br>
    16</font></th>
    <td align="right"><font size="2" color="blue">1.000<br>
    1.637<br>
    1.148<br>
    -.058<br>
    -.713<br>
    -.383<br>
    .006<br>
    -.483<br>
    -1.441<br>
    -1.637<br>
    -.707<br>
    .331<br>
    .441<br>
    -.058<br>
    -.006<br>
    .924</font></td>
    <td align="right"><font size="2" color="blue">-.058<br>
    -.713<br>
    -.383<br>
    .006<br>
    -.483<br>
    -1.441<br>
    -1.637<br>
    -.707<br>
    .331<br>
    .441<br>
    -.058<br>
    -.006<br>
    .924<br>
    1.713<br>
    1.365<br>
    .266</font></td>
  </tr>
</table>

<p><br clear="all">
</p>

<p>С первого взгляда нелегко рассмотреть
взаимосвязь между двумя рядами. Тем не менее, как
показано ниже, ряды создавались так, что содержат
две сильно коррелируемые периодичности. Далее
показаны части таблицы результатов из
кросс-спектрального анализа (спектральные
оценки были сглажены окном Парзена ширины 3). </p>

<table border="1">
  <tr>
    <th align="left" colspan="7"><font size="2" color="blue">Незавмсимая (X):
    ПЕРЕМ1<br>
    Зависимая (Y): ПЕРЕМ2</font></th>
  </tr>
  <tr>
    <th align="center"><font size="2" color="blue">&nbsp;<br>
    Частота</font></th>
    <th align="center"><font size="2" color="blue">&nbsp;<br>
    Период</font></th>
    <th align="center"><font size="2" color="blue">X<br>
    плотность</font></th>
    <th align="center"><font size="2" color="blue">Y<br>
    плотность</font></th>
    <th align="center"><font size="2" color="blue">Кросс<br>
    плотность</font></th>
    <th align="center"><font size="2" color="blue">Кросс<br>
    квадр.</font></th>
    <th align="center"><font size="2" color="blue">Кросс<br>
    амплит.</font></th>
  </tr>
  <tr>
    <td align="right"><font size="2" color="blue">0.000000<br>
    .062500<br>
    .125000<br>
    .187500<br>
    .250000<br>
    .312500<br>
    .375000<br>
    .437500<br>
    .500000</font></td>
    <td align="right"><font size="2" color="blue">&nbsp;<br>
    16.00000<br>
    8.00000<br>
    5.33333<br>
    4.00000<br>
    3.20000<br>
    2.66667<br>
    2.28571<br>
    2.00000</font></td>
    <td align="right"><font size="2" color="blue">.000000<br>
    8.094709<br>
    .058771<br>
    3.617294<br>
    .333005<br>
    .091897<br>
    .052575<br>
    .040248<br>
    .037115</font></td>
    <td align="right"><font size="2" color="blue">.024292<br>
    7.798284<br>
    .100936<br>
    3.845154<br>
    .278685<br>
    .067630<br>
    .036056<br>
    .026633<br>
    0.000000</font></td>
    <td align="right"><font size="2" color="blue">-.00000<br>
    2.35583<br>
    -.04755<br>
    -2.92645<br>
    -.26941<br>
    -.07435<br>
    -.04253<br>
    -.03256<br>
    0.00000</font></td>
    <td align="right"><font size="2" color="blue">0.00000<br>
    -7.58781<br>
    .06059<br>
    2.31191<br>
    .14221<br>
    .02622<br>
    .00930<br>
    .00342<br>
    0.00000</font></td>
    <td align="right"><font size="2" color="blue">.000000<br>
    7.945114<br>
    .077020<br>
    3.729484<br>
    .304637<br>
    .078835<br>
    .043539<br>
    .032740<br>
    0.000000</font></td>
  </tr>
</table>

<p><br clear="all">
</p>

<p>&nbsp;<a NAME="results"></a> </p>

<p><font SIZE="4" COLOR="navy">Результаты для каждой
переменной </font></p>

<p>Полная таблица результатов содержит все
спектральные статистики, вычисленные для
каждого ряда, как описано в разделе <a HREF="sttimser.html#single"><i>Одномерный анализ Фурье</i></a>.
Взглянув на приведенные выше результаты,
очевидно, что оба ряда имеют основные
периодичности на частотах .0625 и .1875. </p>

<p>&nbsp;<a NAME="periodogram"></a> </p>

<p><font SIZE="4" COLOR="navy">Кросс-периодограмма,
кросс-плотность, квадратурная плотность и
кросс-амплитуда </font></p>

<p>Аналогично результатам для одной переменной,
полная итоговая таблица результатов также
покажет значения периодограммы для
кросс-периодограммы. Однако кросс-спектр состоит
из <a href="../glossary/gloss_k.html#Complex Numbers">комплексных чисел</a>,
которые могут быть разделены на действительную и
мнимую части. Они могут быть сглажены для
вычисления оценок кросс-плотности и
квадратурной плотности (квадр-плотность для
краткости), соответственно. (Причины сглаживания
и различные функции весов для сглаживания
обсуждаются в разделе <a HREF="sttimser.html#single"><i>Одномерный
анализ Фурье</i></a>.) Квадратный корень из суммы
квадратов значений кросс-плотности и
квадр-плотности называется <i>кросс-амплитудой</i>.
Кросс-амплитуда может интерпретироваться как
мера ковариации между соответствующими
частотными компонентами двух рядов. Таким
образом из результатов, показанных в таблице
результатов выше, можно заключить, что частотные
компоненты .0625 и .1875 двух рядов взаимосвязаны. </p>

<p>&nbsp;<a NAME="squared"></a> </p>

<p><font SIZE="4" COLOR="navy">Квадрат когерентности, усиление
и фазовый сдвиг </font></p>

<p>Существуют дополнительные статистики, которые
будут показаны в полной итоговой таблице
результатов. </p>

<p><strong>Квадрат когерентности. </strong>Можно
нормировать значения кросс-амплитуды, возведя их
в квадрат и разделив на произведение оценок
спектральной плотности каждого ряда. Результат
называется <i>квадратом когерентности</i>, который
может быть проинтерпретирован как квадрат
коэффициента корреляции (см. раздел <a href="stbasic.html%20#Correlations"><i>Корреляции</i></a>); т.е.
значение когерентности - это квадрат корреляции
между циклическими компонентами двух рядов
соответствующей частоты. Однако значения
когерентности не следует объяснять таким
образом; например, когда оценки спектральной
плотности обоих рядов очень малы, могут
получиться большие значения когерентности
(делитель в выражении когерентности может быть
очень маленьким), даже если нет существенных
циклических компонент в каждом ряду
соответствующей частоты.</p>

<p><strong>Усиление. </strong>Значение усиления в анализе
вычисляется делением значения кросс-амплитуды
на оценки спектральной плотности одного или двух
рядов. Следовательно, может быть вычислено два
значения усиления, которые могут
интерпретироваться как стандартные
коэффициенты регрессии, соответствующей
частоты, полученные методом наименьших
квадратов. </p>

<p><strong>Фазовый сдвиг.</strong> В заключение, оценки
фазового сдвига вычисляются как <i>арктангенс </i>(tan**-1)
коэффициента пропорциональности оценки
квадр-плотности и оценки кросс-плотности. Оценки
фазового сдвига (обычно обозначаемые греческой
буквой y) измеряют, насколько каждая частотная
компонента одного ряда опережает частотные
компоненты другого. </p>

<p>&nbsp;<a NAME="hows"></a> </p>

<p><font SIZE="4" COLOR="navy">Как создавались данные для
примера </font></p>

<p>Теперь вернемся к примеру данных, приведенному
выше. Большие оценки спектральной плотности для
обоих рядов и значения кросс-амплитуды для
частот <img SRC="../graphics/nu.gif" ALIGN="ABSMIDDLE" WIDTH="13" HEIGHT="14"> = 0.0625 и <img SRC="../graphics/nu.gif" ALIGN="ABSMIDDLE" WIDTH="13" HEIGHT="14"> = .1875 предполагают две
существенных синхронных периодичности с этими
частотами в обоих рядах. Фактически, два ряда
создавались как: </p>

<p><font color="blue">v1 = cos(2*<img src="../graphics/piblue.gif" align="absmiddle" WIDTH="15" HEIGHT="17">*.0625*(v0-1))
+ .75*sin(2*<img src="../graphics/piblue.gif" align="absmiddle" WIDTH="15" HEIGHT="17">*.2*(v0-1))</p>

<p>v2 = cos(2*<img src="../graphics/piblue.gif" align="absmiddle" WIDTH="15" HEIGHT="17">*.0625*(v0+2)) +
.75*sin(2*<img src="../graphics/piblue.gif" align="absmiddle" WIDTH="15" HEIGHT="17">*.2*(v0+2)) </font></p>

<p>(где <font color="blue"><i>v0</i></font> - номер наблюдения).
Действительно, анализ, представленный в этом
обзоре, очень хорошо воспроизводит
периодичность, заложенную в данные. </p>

<hr SIZE="1">

<p>&nbsp;<a NAME="spectrum"></a></p>
<font SIZE="5" COLOR="navy">

<p>Спектральный анализ - Основные понятия и
принципы</font> 

<ul>
  <li><a HREF="sttimser.html#frequency">Частота и период</a> </li>
  <li><a HREF="sttimser.html#tgeneral">Общая структура модели</a> </li>
  <li><a HREF="sttimser.html#simpleb">Простой пример</a> </li>
  <li><a HREF="sttimser.html#period">Периодограмма</a> </li>
  <li><a HREF="sttimser.html#problem">Проблема рассеяния</a> </li>
  <li><a HREF="sttimser.html#padding">Добавление констант во
    временной ряд (пэддинг)</a> </li>
  <li><a HREF="sttimser.html#tapering">Косинус-сглаживание</a> </li>
  <li><a HREF="sttimser.html#estimates">Окна данных и оценки
    спектральной плотности</a> </li>
  <li><a HREF="sttimser.html#preparing">Подготовка данных к анализу</a>
  </li>
  <li><a HREF="sttimser.html#results2">Результаты для случая, когда в
    ряде отсутствует периодичность</a> </li>
</ul>

<p>За дальнейшей информацией обратитесь к <a HREF="sttimser.html#index">Анализу временных рядов</a> и
следующим разделам: 

<ul>
  <li><a HREF="sttimser.html#identifying">Идентификация модели
    временных рядов</a> </li>
  <li><a HREF="sttimser.html#arima">АРПСС (Бокс и Дженкинс) и
    автокорреляции Вводный обзор АРПСС</a> </li>
  <li><a HREF="sttimser.html#interrupted">Прерванные временные ряды</a>
  </li>
  <li><a HREF="sttimser.html#exponential">Экспоненциальное
    сглаживание</a> </li>
  <li><a HREF="sttimser.html#census">Сезонная декомпозиция (метод
    Census I)</a> </li>
  <li><a HREF="sttimser.html#x">Сезонная корректировка <i>X-11</i>
    (метод Census II)</a> </li>
  <li><a HREF="sttimser.html#results">Таблицы результатов
    корректировки <i>X-11</i></a> </li>
  <li><a HREF="sttimser.html#lags">Анализ распределенных лагов</a> </li>
  <li><a HREF="sttimser.html#single">Одномерный анализ Фурье</a> </li>
  <li><a HREF="sttimser.html#cross">Кросс-спектральный анализ</a> </li>
  <li><a HREF="sttimser.html#fast">Быстрое преобразование Фурье</a> </li>
</ul>

<p>&nbsp;<a NAME="frequency"></a></p>

<p><font SIZE="4" COLOR="navy">Частота и период </font></p>

<p>Длина волны функций синуса или косинуса, как
правило, выражается числом циклов (периодов) в
единицу времени (<i>Частота)</i>, часто обозначается
греческой буквой <i>ню (</i><img SRC="../graphics/nu.gif" ALIGN="ABSMIDDLE" WIDTH="13" HEIGHT="14">; в некоторых учебниках также
используют <i>f</i>). Например, временной ряд,
состоящий из количества писем, обрабатываемых
почтой, может иметь 12 циклов в году. Первого числа
каждого месяца отправляется большое количество
корреспонденции (много счетов приходит именно
первого числа каждого месяца); затем, к середине
месяца, количество корреспонденции уменьшается;
и затем вновь возрастает к концу месяца. Поэтому
каждый месяц колебания в количестве
корреспонденции, обрабатываемой почтовым
отделением, будут проходить полный цикл. Таким
образом, если единица анализа - один год, то <img SRC="../graphics/nu.gif" ALIGN="ABSMIDDLE" WIDTH="13" HEIGHT="14"> будет равно 12 (поскольку
имеется 12 циклов в году). Конечно, могут быть и
другие циклы с различными частотами. Например,
годичные циклы (<img SRC="../graphics/nu.gif" ALIGN="ABSMIDDLE" WIDTH="13" HEIGHT="14">=<i>1</i>)
и, возможно, недельные циклы (<img SRC="../graphics/nu.gif" ALIGN="ABSMIDDLE" WIDTH="13" HEIGHT="14">=<i>52</i> недели в год). </p>
<i>

<p>Период Т</i> функций синуса или косинуса
определяется как продолжительность по времени
полного цикла. Таким образом, это обратная
величина к частоте: <i>T </i>= 1/<img SRC="../graphics/nu.gif" ALIGN="ABSMIDDLE" WIDTH="13" HEIGHT="14">. Возвратимся к примеру с почтой из
предыдущего абзаца, здесь месячный цикл будет
равен 1/12 = 0.0833 года. Другими словами, это период
составляет 0.0833 года. </p>

<p>&nbsp;<a NAME="tgeneral"></a> </p>

<p><font SIZE="4" COLOR="navy">Общая структура модели </font></p>

<p>Как было отмечено ранее, цель спектрального
анализа - разложить ряд на функции синусов и
косинусов различных частот, для определения тех,
появление которых особенно существенно и
значимо. Один из возможных способов сделать это -
решить задачу линейной <i>множественной
регрессии</i> (см. раздел <a HREF="stmulreg.html"><i>Множественная
регрессия</i></a>), где зависимая переменная
-наблюдаемый временной ряд, а независимые
переменные или регрессоры: функции синусов всех
возможных (дискретных) частот. Такая модель
линейной множественной регрессии может быть
записана как:</p>

<p><font color="blue">x<sub>t</sub> = a<sub>0</sub> + <img src="../graphics/sigmablu.gif" align="absmiddle" WIDTH="12" HEIGHT="19"> [a<sub>k</sub>*cos(<img src="../graphics/lambdabl.gif" align="absmiddle" WIDTH="16" HEIGHT="19"><sub>k</sub>*t) + b<sub>k</sub>*sin(<img src="../graphics/lambdabl.gif" align="absmiddle" WIDTH="16" HEIGHT="19"><sub>k</sub>*t)]&nbsp;&nbsp;&nbsp;&nbsp;(для k = 1 до q) </font></p>

<p>Следующее общее понятие классического
гармонического анализа в этом уравнении - <img src="../graphics/lambdabl.gif" align="absmiddle" WIDTH="16" HEIGHT="19"> (<i>лямбда</i>) -это
круговая частота, выраженная в <i>радианах </i>в
единицу времени, т.е. <img src="../graphics/lambdabl.gif" align="absmiddle" WIDTH="16" HEIGHT="19"> = 2*<img src="../graphics/pi.gif" align="absmiddle" WIDTH="15" HEIGHT="17">*<img src="../graphics/nu.gif" align="absmiddle" WIDTH="13" HEIGHT="14"><sub>k</sub>, где <img SRC="../graphics/piblue.gif" ALIGN="ABSMIDDLE" WIDTH="15" HEIGHT="17"> <i>- </i>константа <i>пи</i> =
3.1416 и <img SRC="../graphics/nu.gif" ALIGN="ABSMIDDLE" WIDTH="13" HEIGHT="14"><sub>k</sub> = k/q. Здесь
важно осознать, что вычислительная задача
подгонки функций синусов и косинусов разных длин
к данным может быть решена с помощью
множественной линейной регрессии. Заметим, что
коэффициенты <font color="blue"><i>a<sub>k</sub></i></font> при
косинусах и коэффициенты <font color="blue"><i>b<sub>k</sub></i></font>
при синусах - это коэффициенты регрессии,
показывающие степень, с которой соответствующие
функции коррелируют с данными [заметим, что сами
синусы и косинусы на различных частотах не
коррелированы или, другим языком, ортогональны.
Таким образом, мы имеем дело с частным случаем
разложения по ортогональным полиномам.] Всего
существует <font color="blue"><i>q</i></font> различных синусов
и косинусов (см. также <i>Множественная регрессия</i>);
интуитивно ясно, что число функций синусов и
косинусов не может быть больше числа данных в
ряде. Не вдаваясь в подробности, отметим, если <i>n -
</i>количество данных, то будет <i>n/2+1 </i>функций
косинусов и <i>n/2-1</i> функций синусов. Другими
словами, различных синусоидальных волн будет
столько же, сколько данных, и вы сможете
полностью воспроизвести ряд по основным
функциям. (Заметим, если количество данных в ряде
нечетно, то последнее наблюдение обычно
опускается. Для определения синусоидальной
функции нужно иметь, по крайней мере, две точки:
высокого и низкого пика.) </p>

<p>В итоге, спектральный анализ определяет
корреляцию функций синусов и косинусов
различной частоты с наблюдаемыми данными. Если
найденная корреляция (коэффициент при
определенном синусе или косинусе) велика, то
можно заключить, что существует строгая
периодичность на соответствующей частоте в
данных. </p>

<p><strong>Комплексные числа (действительные и мнимые
числа). </strong>Во многих учебниках по спектральному
анализу структурная модель, показанная выше,
представлена в комплексных числах; т.е. параметры
оцениваемого процесса описаны с помощью
действительной и мнимой части преобразования
Фурье. Комплексное число состоит из
действительного и мнимого числа. Мнимые числа, по
определению, - это числа, умноженные на константу <i>i</i>,
где <i>i</i> определяется как квадратный корень из -1.
Очевидно, корень квадратный из -1 не существует в
обычном сознании (отсюда термин <i>мнимое </i>число);
однако арифметические операции над мнимыми
числами могут производиться естественным
образом [например, (i*2)**2= -4]. Полезно представление
действительных и мнимых чисел, образующих
двумерную координатную плоскость, где
горизонтальная или <i>X</i>-ось представляет все
действительные числа, а вертикальная или <i>Y</i>-ось
представляет все мнимые числа. Комплексные числа
могут быть представлены точками на двумерной
плоскости. Например, комплексное число 3+i*2 может
быть представлено точкой с координатами {3,2} на
этой плоскости. Можно также представить
комплексные числа как углы; например, можно
соединить точку, соответствующую комплексному
числу на плоскости с началом координат
(комплексное число 0+i*0), и измерить угол наклона
этого вектора к горизонтальной оси. Таким
образом интуитивно ясно, каким образом формула
спектрального разложения, показанная выше, может
быть переписана в комплексной области. В таком
виде математические вычисления часто более
изящны и проще в выполнении, поэтому многие
учебники предпочитают представление
спектрального анализа в комплексных числах. </p>

<p>&nbsp;<a NAME="simpleb"></a> </p>

<p><font SIZE="4" COLOR="navy">Простой пример </font></p>

<p>Шамвэй (1988) предлагает следующий простой пример
для объяснения спектрального анализа. Создадим
ряд из 16 наблюдений, полученных из уравнения,
показанного ниже, а затем посмотрим, каким
образом можно извлечь из него информацию.
Сначала создадим переменную и определим ее как: </p>

<p><font color="blue">x = 1*cos(2*<img src="../graphics/piblue.gif" align="absmiddle" WIDTH="15" HEIGHT="17">*.0625*(v0-1))
+ .75*sin(2*<img src="../graphics/piblue.gif" align="absmiddle" WIDTH="15" HEIGHT="17">*.2*(v0-1)) </font></p>

<p>Эта переменная состоит из двух основных
периодичностей - первая с частотой <img SRC="../graphics/nu.gif" ALIGN="ABSMIDDLE" WIDTH="13" HEIGHT="14">=.0625 (или периодом 1/<img SRC="../graphics/nu.gif" ALIGN="ABSMIDDLE" WIDTH="13" HEIGHT="14">=16; одно наблюдение
составляет 1/16-ю длины полного цикла, или весь
цикл содержит каждые 16 наблюдений) и вторая с
частотой <img SRC="../graphics/nu.gif" ALIGN="ABSMIDDLE" WIDTH="13" HEIGHT="14">=.2 (или
периодом 5). Коэффициент при косинусе (1.0) больше
чем коэффициент при синусе (.75). Итоговая таблица
результатов спектрального анализа показана
ниже. </p>

<table border="1">
  <tr>
    <th width="20">&nbsp;</th>
    <th align="left" colspan="5"><font size="2" color="blue">Спектральный
    анализ: ПЕРЕМ1 (shumex.sta)<br>
    Число наблюдений: 16</font></th>
  </tr>
  <tr>
    <th align="center"><font size="2" color="blue">&nbsp;<br>
    t</font></th>
    <th align="center"><font size="2" color="blue">Час-<br>
    тота</font></th>
    <th align="center"><font size="2" color="blue">&nbsp;<br>
    Период</font></th>
    <th align="center"><font size="2" color="blue">Косинус<br>
    корэфф.</font></th>
    <th align="center"><font size="2" color="blue">Синус<br>
    корэфф.</font></th>
    <th align="center"><font size="2" color="blue">Периодо-<br>
    грамма</font></th>
  </tr>
  <tr>
    <td align="right"><font size="2" color="blue">0<br>
    1<br>
    2<br>
    3<br>
    4<br>
    5<br>
    6<br>
    7<br>
    8</font></td>
    <td align="right"><font size="2" color="blue">.0000<br>
    .0625<br>
    .1250<br>
    .1875<br>
    .2500<br>
    .3125<br>
    .3750<br>
    .4375<br>
    .5000</font></td>
    <td align="right"><font size="2" color="blue">&nbsp;<br>
    16.00<br>
    8.00<br>
    5.33<br>
    4.00<br>
    3.20<br>
    2.67<br>
    2.29<br>
    2.00</font></td>
    <td align="right"><font size="2" color="blue">.000<br>
    1.006<br>
    .033<br>
    .374<br>
    -.144<br>
    -.089<br>
    -.075<br>
    -.070<br>
    -.068</font></td>
    <td align="right"><font size="2" color="blue">0.000<br>
    .028<br>
    .079<br>
    .559<br>
    -.144<br>
    -.060<br>
    -.031<br>
    -.014<br>
    0.000</font></td>
    <td align="right"><font size="2" color="blue">.000<br>
    8.095 <br>
    .059 <br>
    3.617 <br>
    .333 <br>
    .092 <br>
    .053 <br>
    .040 <br>
    .037</font></td>
  </tr>
</table>

<p><br clear="all">
Теперь рассмотрим столбцы таблицы результатов.
Ясно, что наибольший коэффициент при косинусах
расположен напротив частоты .0625. Наибольший
коэффициент при синусах соответствует частоте
.1875. Таким образом, эти две частоты, которые были
&quot;внесены&quot; в данные, отчетливо проявились. </p>

<p>&nbsp;<a NAME="period"></a> </p>

<p><font SIZE="4" COLOR="navy">Периодограмма </font></p>

<p>Функции синусов и косинусов независимы (или
ортогональны); поэтому можно просуммировать
квадраты коэффициентов для каждой частоты, чтобы
вычислить <i>периодограмму</i>. Более часто,
значения периодограммы вычисляются как: </p>

<p><font color="blue">P<sub>k</sub> = синус-коэффициент<sub>k</sub><sup>2</sup>
+ косинус-коэффициент<sub>k</sub><sup>2</sup> * N/2 </font></p>

<p>где <font color="blue"><i>P<sub>k</sub></i></font> - значения
периодограммы на частоте&nbsp; <img SRC="../graphics/nu.gif" ALIGN="ABSMIDDLE" WIDTH="13" HEIGHT="14"><sub>k</sub> , и <font color="blue"><i>N</i></font> - общая
длина ряда. Значения периодограммы можно
интерпретировать как дисперсию (вариацию) данных
на соответствующей частоте. Обычно значения
периодограммы изображаются в зависимости от
частот или периодов. </p>

<p><img BORDER="0" SRC="../popups/popup25.gif" alt="График периодограммы" WIDTH="306" HEIGHT="218"></p>

<p>&nbsp;<a NAME="problem"></a> </p>

<p><font SIZE="4" COLOR="navy">Проблема рассеяния </font></p>

<p>В примере, приведенном выше, функция синуса с
частотой 0.2 была &quot;вставлена&quot; в ряд. Однако
из-за того, что длина ряда равна 16, ни одна из
частот, полученных в таблице результатов, не
совпадает в точности с этой частотой. На практике
в этих случаях часто оказывается, что
соответствующая частота &quot;рассеивается&quot; на
близкие частоты. Например, могут быть найдены
большие значения периодограммы для двух близких
частот, когда в действительности существует
только одна основная функция синуса или косинуса
с частотой, которая попадает на одну из этих
частот или лежит между найденными частотами.
Существует три подхода к решению проблемы
рассеяния: 

<ul>
  <li>При помощи добавление констант во временной
    ряда ряда можно увеличить частоты, </li>
  <li>Применяя <i>сглаживание </i>ряда перед анализом,
    можно уменьшить рассеяние или</li>
  <li>Применяя сглаживание периодограммы, можно
    идентифицировать основные частотные области или
    (<i>спектральные плотности</i>), которые
    существенно влияют на циклическое поведение
    ряда. </li>
</ul>

<p>Ниже смотрите описание каждого из этих
подходов. </p>

<p>&nbsp;<a NAME="padding"></a> </p>

<p><font SIZE="4" COLOR="navy">Добавление констант во
временной ряд (пэддинг) </font></p>

<p>Так как частотные величины вычисляются как <i>N</i>/<i>t</i>,
можно просто <i>добавить в ряд константы </i>(например,
нули), и таким образом получить увеличение
частот. Фактически, если вы добавите в файл
данных, описанный в примере выше, десять нулей,
результаты не изменятся; т.е. наибольшие пики
периодограммы будут находиться по-прежнему на
частотах близких к .0625 и .2. (Добавление констант
во временной ряд также часто желательно для
увеличения вычислительной эффективности; см.
ниже.) </p>

<p>&nbsp;<a NAME="tapering"></a> </p>

<p><font SIZE="4" COLOR="navy">Косинус-сглаживание </font></p>

<p>Так называемый процесс <i>косинус-сглаживания </i>-
рекомендуемое преобразование ряда,
предшествующее спектральному анализу. Оно
обычно приводит к уменьшению рассеяния в
периодограмме. Логическое обоснование этого
преобразования подробно объясняется в книге
Bloomfield (1976, стр. 80-94). По существу, количественное
отношение (<i>p</i>) данных в начале и в конце ряда
преобразуется при помощи умножения на веса: </p>

<p><font color="blue">w<sub>t</sub> = 0.5*{1-cos[<img src="../graphics/piblue.gif" align="absmiddle" WIDTH="15" HEIGHT="17">*(t - 0.5)/m]}&nbsp;&nbsp;&nbsp;&nbsp; (для t=0 до m-1)<br>
w<sub>t</sub> = 0.5*{1-cos[<img src="../graphics/piblue.gif" align="absmiddle" WIDTH="15" HEIGHT="17">*(N - t +
0.5)/m]}&nbsp;&nbsp;&nbsp;&nbsp; (для t=N-m до N-1) </font></p>

<p>где <i><font color="blue">m</font> </i>выбирается так, чтобы <font color="blue">2*<i>m/N</i></font> было равно коэффициенту
пропорциональности сглаживаемых данных (<i>p</i>). </p>

<p>&nbsp;<a NAME="estimates"></a> </p>

<p><font SIZE="4" COLOR="navy">Окна данных и оценки
спектральной плотности </font></p>

<p>На практике, при анализе данных обычно не очень
важно точно определить частоты основных функций
синусов или косинусов. Скорее, т.к. значения
периодограммы - объект существенного случайного
колебания, можно столкнуться с проблемой многих
хаотических пиков периодограммы. В этом случае
хотелось бы найти частоты с большими <i>спектральными
плотностями</i>, т.е. частотные области, состоящие
из многих близких частот, которые вносят
наибольший вклад в периодическое поведение
всего ряда. Это может быть достигнуто путем
сглаживания значений периодограммы с помощью
преобразования взвешенного скользящего
среднего. Предположим, ширина окна скользящего
среднего равна <i>m </i>(должно быть нечетным
числом); следующие наиболее часто используемые
преобразования (заметим: <i>p = (m-1)/2</i>).</p>

<p><strong>Окно Даниэля (равные веса). </strong>Окно
Даниэля (Daniell, 1946) означает простое (с равными
весами) сглаживание скользящим средним значений
периодограммы; т.е. каждая оценка спектральной
плотности вычисляется как среднее <i>m</i>/2
предыдущих и последующих значений
периодограммы.</p>

<p><strong>Окно Тьюки. </strong>В окне Тьюки (Blackman and Tukey, 1958)
или Тьюки-Ханна (Hanning) (названное в честь Julius Von Hann),
для каждой частоты веса для взвешенного
скользящего среднего значений периодограммы
вычисляются как: </p>

<p><font color="blue">w<sub>j</sub> = 0.5 + 0.5*cos(<img src="../graphics/piblue.gif" align="absmiddle" WIDTH="15" HEIGHT="17">*j/p)&nbsp;&nbsp;&nbsp;&nbsp;(для j=0 до p)<br>
w<sub>-j</sub> = w<sub>j</sub>&nbsp;&nbsp;&nbsp;&nbsp;(для j <img src="../graphics/netblue.gif" align="absmiddle" WIDTH="11" HEIGHT="12"> 0) </font></p>

<p><strong>Окно Хемминга. </strong>В окне Хемминга
(названного в честь R. W. Hamming) или Тьюки-Хемминга
(Blackman and Tukey, 1958), для каждой частоты, веса для
взвешенного скользящего среднего значений
периодограммы вычисляются как: </p>

<p><font color="blue">w<sub>j</sub> = 0.54 + 0.46*cos(<img src="../graphics/piblue.gif" align="absmiddle" WIDTH="15" HEIGHT="17">*j/p)&nbsp;&nbsp;&nbsp;&nbsp;(для j=0 до p)<br>
w<sub>-j</sub> = w<sub>j</sub>&nbsp;&nbsp;&nbsp;&nbsp;(для j <img src="../graphics/netblue.gif" align="absmiddle" WIDTH="11" HEIGHT="12"> 0) </font></p>

<p><strong>Окно Парзена.</strong> В окне Парзена (Parzen, 1961),
для каждой частоты, веса для взвешенного
скользящего среднего значений периодограммы
вычисляются как: </p>

<p><font color="blue">w<sub>j</sub> = 1-6*(j/p)<sup>2</sup> + 6*(j/p)<sup>3</sup>&nbsp;&nbsp;&nbsp;&nbsp;(для
j = 0 до p/2)<br>
w<sub>j</sub> = 2*(1-j/p)<sup>3</sup>&nbsp;&nbsp;&nbsp;&nbsp;(для j = p/2 + 1 до p)<br>
w<sub>-j</sub> = w<sub>j</sub>&nbsp;&nbsp;&nbsp;&nbsp;(для j <img src="../graphics/netblue.gif" align="absmiddle" WIDTH="11" HEIGHT="12"> 0) </font></p>

<p><strong>Окно Бартлетта. </strong>В окне Бартлетта (Bartlett,
1950) веса вычисляются как: </p>

<p><font color="blue">w<sub>j</sub> = 1-(j/p)&nbsp;&nbsp;&nbsp;&nbsp;(для j = 0 до p)<br>
w<sub>-j</sub> = w<sub>j</sub>&nbsp;&nbsp;&nbsp;&nbsp;(для j <img src="../graphics/netblue.gif" align="absmiddle" WIDTH="11" HEIGHT="12"> 0) </font></p>

<p>За исключением окна Даниэля, все весовые
функции приписывают больший вес сглаживаемому
наблюдению, находящемуся в центре окна и меньшие
веса значениям по мере удаления от центра. Во
многих случаях, все эти окна данных получают
очень похожие результаты. </p>

<p>&nbsp;<a NAME="preparing"></a> </p>

<p><font SIZE="4" COLOR="navy">Подготовка данных к анализу </font></p>

<p>Теперь рассмотрим несколько других
практических моментов спектрального анализа.
Обычно, полезно вычесть среднее из значений ряда
и удалить тренд (чтобы добиться <a HREF="../glossary/gloss_s.html#Stationary Series (in Time Series)">стационарности</a>)
перед анализом. Иначе периодограмма и
спектральная плотность &quot;забьются&quot; очень
большим значением первого коэффициента при
косинусе (с частотой 0.0). По существу, среднее - это
цикл частоты 0 (нуль) в единицу времени; т.е.
константа. Аналогично, тренд также не
представляет интереса, когда нужно выделить
периодичность в ряде. Фактически оба этих
эффекта могут заслонить более интересные
периодичности в данных, поэтому и среднее, и
(линейный) тренд следует удалить из ряда перед
анализом. Иногда также полезно сгладить данные
перед анализом, чтобы убрать случайный шум,
который может засорять существенные
периодические циклы в периодограмме. </p>

<p>&nbsp;<a NAME="results2"></a> </p>

<p><font SIZE="4" COLOR="navy">Результаты для случая, когда в
ряде отсутствует периодичность </font></p>

<p>В заключение, зададим вопрос: что, если
повторяющихся циклов в данных нет, т.е. если
каждое наблюдение совершенно независимо от всех
других наблюдений? Если распределение
наблюдений соответствует нормальному, такой
временной ряд может быть <i>белым шумом </i>(подобный
белый шум можно услышать, настраивая радио). Если
исходный ряд - белый шум, то значения
периодограммы будут иметь <a HREF="../glossary/gloss_ae.html#Exponential Distribution">экспоненциальное
распределение</a>. Таким образом, проверкой на
экспоненциальность значений периодограммы
можно узнать, отличается ли исходный ряд от
белого шума. Пользователь может также построить
одновыборочную статистику <i>d</i> статистику
Колмогорова-Смирнова (cм. также раздел <a href="stnonpar.html"><i>Непараметрическая статистика и
распределения</i></a>). </p>

<p><strong>Проверка, что шум - белый в ограниченной
полосе частот.</strong> Заметим, что также можно
получить значения периодограммы для
ограниченной частотной области. Снова, если
введенный ряд - белый шум с соответствующими
частотами (т.е. если нет существенных
периодических циклов этих частот), то
распределение значений периодограммы должно
быть снова экспоненциальным. </p>

<table ALIGN="RIGHT">
  <tr>
    <td><font SIZE="1"><a HREF="sttimser.html#index">В начало</a></font> </td>
  </tr>
</table>

<p><br CLEAR="RIGHT">
</p>

<hr SIZE="1">

<p>&nbsp;<a NAME="fast"></a></p>
<font SIZE="5" COLOR="navy">

<p>Быстрое преобразование Фурье (БПФ)</font> 

<ul>
  <li><a HREF="sttimser.html#ugeneral">Общее введение</a> </li>
  <li><a HREF="sttimser.html#computation2">Вычисление БПФ во временных
    рядах</a> </li>
</ul>

<p>За дальнейшей информацией обратитесь к <a HREF="sttimser.html#index">Анализу временных рядов</a> и
следующим разделам: 

<ul>
  <li><a HREF="sttimser.html#identifying">Идентификация модели
    временных рядов</a> </li>
  <li><a HREF="sttimser.html#arima">АРПСС (Бокс и Дженкинс) и
    автокорреляции Вводный обзор АРПСС</a> </li>
  <li><a HREF="sttimser.html#interrupted">Прерванные временные ряды</a>
  </li>
  <li><a HREF="sttimser.html#exponential">Экспоненциальное
    сглаживание</a> </li>
  <li><a HREF="sttimser.html#census">Сезонная декомпозиция (метод
    Census I)</a> </li>
  <li><a HREF="sttimser.html#x">Сезонная корректировка <i>X-11</i>
    (метод Census II)</a> </li>
  <li><a HREF="sttimser.html#result">Таблицы результатов
    корректировки <i>X-11</i></a> </li>
  <li><a HREF="sttimser.html#lags">Анализ распределенных лагов</a> </li>
  <li><a HREF="sttimser.html#single">Одномерный анализ Фурье</a> </li>
  <li><a HREF="sttimser.html#cross">Кросс-спектральный анализ</a> </li>
  <li><a HREF="sttimser.html#spectrum">Основные понятия и принципы</a>
  </li>
</ul>

<p>&nbsp;<a NAME="ugeneral"></a></p>

<p><font SIZE="4" COLOR="navy">Общее введение </font></p>

<p>Интерпретация результатов спектрального
анализа обсуждается в разделе <a HREF="sttimser.html#spectrum"><i>Основные
понятия и принципы</i></a>, однако там мы не
обсуждали вычислительные проблемы, которые в
действительности очень важны. До середины 1960-х
для представления спектрального разложения
использовались точные формулы для нахождения
параметров синусов и косинусов. Соответствующие
вычисления требовали как минимум <i>N**2 </i>(комплексных)
умножений. Таким образом, даже сегодня
высокоскоростному компьютеру потребовалось бы
очень много времени для анализа даже небольшого
временного ряда (для 8,000 наблюдений
потребовалось бы по меньшей мере 64 миллиона
умножений). </p>

<p>Ситуация кардинально изменилась с открытием
так называемого <a href="../glossary/gloss_a.html#Algorithm">алгоритма</a>
<i>быстрого преобразования Фурье</i>, или <i>БПФ </i>для
краткости. Достаточно сказать, что при
применении алгоритма БПФ время выполнения
спектрального анализа ряда длины <i>N</i> стало
пропорционально <i>N*</i>log2(<i>N</i>) что конечно
является огромным прогрессом. </p>

<p>Однако недостаток стандартного алгоритма БПФ
состоит в том, что число данных ряда должно быть
равным степени 2 (т.е. 16, 64, 128, 256, ...). Обычно это
приводит к необходимости добавлять нули во
временной ряд, который, как описано выше, в
большинстве случаев не меняет характерные пики
периодограммы или оценки спектральной
плотности. Тем не менее, в некоторых случаях,
когда единица времени значительна, добавление
констант во временной ряд может сделать
результаты более громоздкими. </p>

<p>&nbsp;<a NAME="computation2"></a> </p>

<p><font SIZE="4" COLOR="navy">Вычисление БПФ во временных
рядах </font></p>

<p>Выполнение быстрого преобразования Фурье
чрезвычайно эффективно. На большинстве
стандартных компьютеров, ряд с более чем 100,000
наблюдений легко анализируется. Однако
существует несколько моментов, которые надо
помнить при анализе рядов большого размера. </p>

<p>Как упоминалось ранее, для применения
стандартного (и наиболее эффективного) алгоритма
БПФ требуется, чтобы длина исходного ряда была
равна степени 2. Если это не так, должны быть
проведены дополнительные вычисления. Будут
использоваться простые точные вычислительные
формулы, пока исходный ряд относительно мал, и
вычисления можно выполнить за относительно
короткое время. Для длинных временных рядов,
чтобы применить алгоритм БПФ, используется
основной подход, описанный Monro и Branch (1976). Этот
метод требует значительно больше памяти; однако
ряд рассматриваемой длины может анализироваться
все еще очень быстро, даже если число наблюдений
не является степенью 2. </p>

<p>Для временных рядов, длина которых не равна
степени 2, мы можем дать следующие рекомендации:
если размер исходного ряда не превосходит
средний размер (т.е. имеется только несколько
тысяч наблюдений), не стоит беспокоиться. Анализ
займет несколько секунд. Для анализа средних и
больших рядов (например, содержащих свыше 100,000
наблюдений), добавьте в ряд константы (например
нули) до тех пор, пока длина ряда не станет
степенью 2 и затем примените косинус-сглаживание
ряда в разведочной части анализа ваших данных. <br>
<br>
</p>

<p>Дополнительная информация по методам анализа данных, добычи данных, 
визуализации и прогнозированию содержится на 
<a href="http://www.statsoft.ru/home/portal/default.asp" target="_blank">Портале StatSoft</a> (http://www.statsoft.ru/home/portal/default.asp) 
и в <a href="http://www.statsoft.ru/home/portal/textbook2/default.htm" target="_blank">Углубленном Учебнике StatSoft (Учебник с формулами)</a>.</p>

<hr SIZE="1">

<p align="center"><br>
<img SRC="../stathoms.jpg" ALIGN="LEFT" WIDTH="151" HEIGHT="47"> <br CLEAR="ALL">
<font SIZE="1">(c) Copyright StatSoft, Inc., 1984-2001<br>
STATISTICA является торговой маркой StatSoft, Inc. </font></p>

<hr SIZE="1">
</body>
</html>
