<html>

<head>
<title>Анализ выживаемости</title>
</head>

<body BACKGROUND="../tile1.gif">
<font SIZE="5" COLOR="AA0000"><b>

<p align="center">Анализ выживаемости</b></font> </p>

<hr SIZE="1">

<p>&nbsp;<a NAME="index"></a> 

<ul>
  <li><a HREF="stsurvan.html#general">Общие цели</a> </li>
  <li><a HREF="stsurvan.html#censored">Цензурированные наблюдения</a>
  </li>
  <li><a HREF="stsurvan.html#analytic">Аналитические методы</a> </li>
  <li><a HREF="stsurvan.html#life">Анализ таблиц времен жизни</a> <ul>
      <li><a HREF="stsurvan.html#lnumber">Число изучаемых объектов</a> </li>
      <li><a HREF="stsurvan.html#lproportion">Доля умерших</a> </li>
      <li><a HREF="stsurvan.html#lsurviving">Доля выживших</a> </li>
      <li><a HREF="stsurvan.html#lcumulative">Кумулятивная доля выживших
        (функция выживания)</a> </li>
      <li><a HREF="stsurvan.html#lprobability">Плотность вероятности</a> </li>
      <li><a HREF="stsurvan.html#lhazard">Функция интенсивности</a> </li>
      <li><a HREF="stsurvan.html#lmedian">Медиана ожидаемого времени
        жизни</a> </li>
      <li><a HREF="stsurvan.html#lrequired">Объем выборки</a> </li>
    </ul>
  </li>
  <li><a HREF="stsurvan.html#distribution">Подгонка распределения</a> <ul>
      <li><a HREF="stsurvan.html#dgeneral">Общее знакомство</a> </li>
      <li><a HREF="stsurvan.html#destimation">Оценивание</a> </li>
      <li><a HREF="stsurvan.html#dgoodness">Согласие</a> </li>
      <li><a HREF="stsurvan.html#dplots">Графики</a> </li>
    </ul>
  </li>
  <li><a HREF="stsurvan.html#kaplan">Множительные оценки
    Каплана-Мейера</a> </li>
  <li><a HREF="stsurvan.html#comparing">Сравнение выборок</a> <ul>
      <li><a HREF="stsurvan.html#cgeneral">Общее знакомство</a> </li>
      <li><a HREF="stsurvan.html#cavailable">Доступные критерии</a> </li>
      <li><a HREF="stsurvan.html#cchoosing">Выбор двухвыборочного
        критерия</a> </li>
      <li><a HREF="stsurvan.html#cmultiple">Критерий для нескольких
        выборок</a> </li>
      <li><a HREF="stsurvan.html#cunequal">Неравные доли
        цензурированных наблюдений</a> </li>
    </ul>
  </li>
  <li><a HREF="stsurvan.html#regression">Регрессионные модели</a> <ul>
      <li><a HREF="stsurvan.html#rgeneral">Общее знакомство</a> </li>
      <li><a HREF="stsurvan.html#rcox">Модель пропорциональных
        интенсивностей Кокса</a> </li>
      <li><a HREF="stsurvan.html#rcoxwith">Модель пропорциональных
        интенсивностей Кокса с зависящими от времени
        ковариатами</a> </li>
      <li><a HREF="stsurvan.html#rexp">Экспоненциальная регрессия</a> </li>
      <li><a HREF="stsurvan.html#rnormal">Нормальная и логнормальная
        регрессия</a> </li>
      <li><a HREF="stsurvan.html#rstrat">Стратифицированный анализ</a> </li>
    </ul>
  </li>
</ul>

<hr SIZE="1">

<p>&nbsp;<a NAME="general"></a></p>

<p><font SIZE="4" COLOR="navy">Общие цели </font></p>

<p>Статистические методы, представленные в этом
модуле, первоначально были развиты в
медицинских, биологических исследованиях и
страховании, но затем стали широко применяться в
социальных и экономических науках, а также в
инженерных задачах (анализ надежности и времен
отказов).</p>

<p>Представьте, что вы изучаете эффективность
нового метода лечения, применяемого в
критической (терминальной) стадии заболевания
(например, лечение новым методом практически
неизлечимых больных). Наиболее важной, очевидно,
переменной является продолжительность жизни
пациентов с момента поступления в клинику. В
принципе, для описания средних времен жизни и
сравнения нового метода лечения со старыми,
можно было бы использовать стандартные
параметрические и непараметрические методы (см. <a href="stbasic.html"><i>Основные статистики и таблицы</i></a> и <a href="stnonpar.html"><i>Непараметрические статистики и
распределения</i></a>). Однако в анализируемых
данных есть существенная особенность, связанная
с тем, как вы строите выборку. При завершении
вашего исследования могли найтись пациенты,
которые выжили в течение всего периода
наблюдения, в частности, среди тех, кто поступил в
клинику позже других, а также пациенты, контакт с
которыми был потерян до завершения эксперимента
(например, их перевели в другие клиники).
Естественно, вам не хотелось бы терять собранную
о них информацию, поскольку большинство этих
пациентов являются &quot;выжившими&quot; в течение
того времени, которое вы их наблюдали, и тем самым
свидетельствуют в пользу нового метода лечения.
Наблюдения, которые содержат неполную
информацию, называются <a href="../glossary/gloss_ts.html#Censoring">цензурированными
наблюдениями</a> (например, &quot;пациент <i>A</i> был
жив, по крайней мере, 4 месяца до того, как был
переведен в другую клинику и контакт с ним был
потерян&quot;). Использование в том числе и
цензурированных наблюдений составляет
специфику рассматриваемых здесь методов (термин <i>цензурирование
</i>был впервые использован в работе Hald, 1949). </p>

<table ALIGN="RIGHT">
  <tr>
    <td><font size="1"><a HREF="stsurvan.html#index">В начало</a></font> </td>
  </tr>
</table>

<p><br CLEAR="RIGHT">
&nbsp; <a NAME="censored"></a> </p>

<p><font SIZE="4" COLOR="navy">Цензурированные наблюдения </font></p>

<p>В общем, цензурированные наблюдения типичны,
когда наблюдаемая величина представляет время
до наступления некоторого критического события,
а продолжительность наблюдения ограничена по
времени. Цензурированные наблюдения встречаются
во многих областях. Например, в социальных науках
мы можем изучать &quot;длительность&quot; брака,
интенсивность выбытия студентов из высшего
учебного заведения (времен до выбытия), динамику
численности работников в некоторых организациях
и т.п. В рассмотренных примерах в конце периода
наблюдения некоторые субъекты остаются
состоящими в браке, некоторые студенты
продолжают учебу, а некоторые сотрудники
продолжают работать в компании; таким образом,
данные об этих субъектах являются
цензурированными. Мы не можем дождаться того
момента, когда все выбранные студенты покинут
учебное заведение, а сотрудники компанию.</p>

<p>В экономике мы можем изучать &quot;выживание&quot;
новых предприятий или времена &quot;жизни&quot;
продуктов, таких как, например, автомобили. В
задачах контроля качества типичным является
изучение &quot;выживания&quot; элементов изделий под
нагрузкой (анализ времен отказов). В актуарной
математике в качестве объекта исследований
обычно используют таблицы смертности,
содержащие данные о смертности за выбранные
интервалы времени лиц определенных категорий
(например, мужчин старше 30 лет). </p>

<table ALIGN="RIGHT">
  <tr>
    <td><font size="1"><a HREF="stsurvan.html#index">В начало</a></font> </td>
  </tr>
</table>

<p><br CLEAR="RIGHT">
&nbsp;<a NAME="analytic"></a> </p>

<p><font SIZE="4" COLOR="navy">Аналитические методы </font></p>

<p>Методы <em>Анализа выживаемости</em> в основном
применяются к тем же статистическим задачам, что
и другие методы, однако их особенность в том, что
они применяются к <a href="../glossary/gloss_ts.html#Censoring">цензурированным</a>
или, как иногда говорят, неполным данным. Отметим
также, что более часто, чем обычная функция
распределения, в этих методах используется так
называемая функция выживания, представляющая
собой вероятность того, что объект проживет
время больше t. Построение <i>таблиц времен жизни</i>,
<i>подгонка распределения выживаемости, </i>оценивание
функции выживания с помощью процедуры <i>Каплана-Мейера</i>
являются описательными методами исследования
цензурированных данных. Некоторые из
предложенных методов позволяют сравнивать
выживаемость в двух и более группах. Наконец, <i>Анализ
выживаемости</i> содержит регрессионные модели
для оценивания зависимостей между многомерными
непрерывными переменными со значениями типа
времена жизни. </p>

<table ALIGN="RIGHT">
  <tr>
    <td><font size="1"><a HREF="stsurvan.html#index">В начало</a></font> </td>
  </tr>
</table>

<p><br CLEAR="RIGHT">
&nbsp; <a NAME="life"></a> </p>

<p><font SIZE="4" COLOR="navy">Анализ таблиц времен жизни </font></p>

<p>Наиболее естественным способом описания
выживаемости в выборке явлвется построение <i>Таблиц
времен жизни</i>. Техника таблиц времен жизни -
один из старейших методов анализа данных о
выживаемости (времен отказов) (см., например,
работы Berkson and Gage, 1950; Cutler and Ederer, 1958; Gehan, 1969). Такую
таблицу можно рассматривать как
&quot;расширенную&quot; таблицу частот. Область
возможных времен наступления критических
событий (смертей, отказов и др.) разбивается на
некоторое число интервалов. Для каждого
интервала вычисляется число и долю объектов,
которые в начале рассматриваемого интервала
были &quot;живы&quot;, число и долю объектов, которые
&quot;умерли&quot; в данном интервале, а также число и
долю объектов, которые были изъяты или <a href="../glossary/gloss_ts.html#Censoring">цензурированы</a> в каждом
интервале.</p>

<p>На основании этих величин вычисляются
некоторые дополнительные статистики: 

<ul>
  <li><a HREF="stsurvan.html#lnumber">Число изучаемых объектов</a> </li>
  <li><a HREF="stsurvan.html#lproportion">Доля умерших</a> </li>
  <li><a HREF="stsurvan.html#lsurviving">Доля выживших</a> </li>
  <li><a HREF="stsurvan.html#lcumulative">Кумулятивная доля выживших
    (функция выживания)</a> </li>
  <li><a HREF="stsurvan.html#lprobability">Плотность вероятности</a> </li>
  <li><a HREF="stsurvan.html#lhazard">Функция интенсивности</a> </li>
  <li><a HREF="stsurvan.html#lmedian">Медиана ожидаемого времени
    жизни</a> </li>
  <li><a HREF="stsurvan.html#lrequired">Объем выборки</a> </li>
</ul>

<p><a NAME="lnumber"></a><br>
<b>Число изучаемых объектов. </b>Это число объектов,
которые были &quot;живы&quot; в начале
рассматриваемого временного интервала, минус
половина числа изъятых или <a href="../glossary/gloss_ts.html#Censoring">цензурированных</a>
объектов. <br>
<a NAME="lproportion"></a><br>
<b>Доля умерших. </b>Эта отношение числа объектов,
умерших в соответствующем интервале, к числу
объектов, изучаемых на этом интервале. <br>
<a NAME="lsurviving"></a> <br>
<b>Доля выживших. </b>Эта доля равна единице минус
доля умерших. <br>
<a NAME="lcumulative"></a> <br>
<b>Кумулятивная доля выживших (функция выживания).
</b>Это кумулятивная доля выживших к началу
соответствующего временного интервала.
Поскольку вероятности выживания считаются
независимыми на разных интервалах, эта доля
равна произведению долей выживших объектов по
всем предыдущим интервалам. Полученная доля как
функция от времени называется также <i>выживаемостью
</i>или <i>функцией выживания</i> [точнее, это оценка
функции выживания]. <br>
<a NAME="lprobability"></a><br>
<b>Плотность вероятности. </b>Это оценка
вероятности отказа в соответствующем интервале,
определяемая таким образом:: </p>

<p><font color="blue">F<sub>i</sub> = (P<sub>i</sub>-P<sub>i+1</sub>) /h<sub>i</sub> </font></p>

<p>где <font color="blue">F<sub>i</sub></font><i> </i>- оценка
вероятности отказа в <i>i</i>-ом интервале, <font color="blue">P<sub>i</sub></font> - кумулятивная доля выживших
объектов (функция выживания) к началу <i>i</i>-го<i> </i>интервала,
<font color="blue">h<sub>i</sub></font> - ширина <i>i</i>-ого интервала.<br>
<a NAME="lhazard"></a> <br>
<b>Функция интенсивности. </b>Функция
интенсивности (этот термин был впервые
использован в работе Barlow, 1963) определяется как
вероятность того, что объект, выживший к началу
соответствующего интервала, откажет или умрет в
течение этого интервала. Оценка функции
интенсивности вычисляется как число отказов,
приходящихся на единицу времени
соответствующего интервала, деленное на среднее
число объектов, доживших до момента времени,
находящегося в середине интервала. <br>
<a NAME="lmedian"></a> <br>
<b>Медиана ожидаемого времени жизни. </b>Это точка
на временной оси, в которой кумулятивная функция
выживания равна <i>0.5</i>. Другие процентили
(например, 25- и 75-процентиль или квартили)
кумулятивной функции выживания вычисляются по
такому же принципу. Отмети, что 50-процентиль
(медиана) кумулятивной функции выживаемости
обычно не совпадает с точкой выживания 50%
выборочных наблюдений. (Совпадение происходит
только когда за прошедшее к этому моменту время
не было <a href="../glossary/gloss_ts.html#Censoring">цензурированных</a>
наблюдений). <br>
<a NAME="lrequired"></a> <br>
<b>Объем выборки. </b>Чтобы получить надежные
оценки трех основных функций (функции выживания,
плотности вероятности и функции интенсивности) и
их стандартных ошибок на каждом временном
интервале, рекомендуется использовать не менее 30
наблюдений. </p>

<table ALIGN="RIGHT">
  <tr>
    <td><font size="1"><a HREF="stsurvan.html#index">В начало</a></font> </td>
  </tr>
</table>

<p><br CLEAR="RIGHT">
&nbsp;<a NAME="distribution"></a> </p>

<p><font SIZE="4" COLOR="navy">Подгонка распределения </font>

<ul>
  <li><a HREF="stsurvan.html#dgeneral">Общее знакомство</a> </li>
  <li><a HREF="stsurvan.html#destimation">Оценивание</a> </li>
  <li><a HREF="stsurvan.html#dgoodness">Согласие</a> </li>
  <li><a HREF="stsurvan.html#dplots">Графики</a> </li>
</ul>

<p><a NAME="dgeneral"></a><br>
<strong>Общее знакомство.</strong><b> </b>В общем случае
таблица времен жизни дает хорошее представление
о распределении отказов или смертей объектов во
времени. Однако для прогноза часто необходимо
знать форму рассматриваемой функции выживания.
Наиболее важны следующие семейства
распределений, которые используются для
описания продолжительности жизни или наработки
до отказа: <a href="../glossary/gloss_ae.html#Exponential Distribution">экспоненциальное</a>
(в том числе, линейное экспоненциальное)
распределение, распределение <a href="../glossary/gloss_r.html#Weibull Distribution">Вейбулла</a>
экстремальных значений и распределение
Гомперца. <br>
<a NAME="destimation"></a><br>
<strong>Оценивание.</strong> Процедура оценивания
параметров использует <a href="../glossary/gloss_a.html#Algorithm">алгоритм</a>
метода наименьших квадратов (см. работу Gehan and
Siddiqui, 1973). Для проведения оценивания применима
модель линейной регрессии, поскольку все четыре
перечисленных семейства распределений могут
быть &quot;сведены к линейным&quot; (относительно
параметров) с помощью подходящих преобразований.
Такие преобразования приводят иногда к тому, что
дисперсия остатков зависит от интервалов (т.е.
дисперсия различная на различных интервалах).
Чтобы учесть это, в алгоритмах подгонки
используют оценки взвешенных наименьших
квадратов двух типов. <br>
<a NAME="dgoodness"></a><br>
<strong>Согласие.</strong> Зная параметрическое
семейство распределений, можно вычислить
функцию правдоподобия по имеющимся данным и
найти ее максимум. Такие оценки называются
оценками максимального правдоподобия. При
весьма общих предположениях эти оценки
совпадают с оценками наименьших квадратов.
Аналогичным образом находится максимум функции
правдоподобия при нулевой гипотезе, т.е. для
модели, допускающей различные интенсивности на
разных интервалах. Сформулированная гипотеза
может быть проверена, например, с помощью
критерия отношения правдоподобия, статистика
которого имеет (по крайней мере, асимптотически) <a href="../glossary/gloss_r.html#Chi-square Distribution"><i>хи-квадрат</i></a>
распределение.<br>
<a NAME="dplots"></a><br>
<b>Графики. </b>В модуле можно строить графики как
эмпирических, так и теоретических функций
распределения и интенсивности. Эти графики
представляют собой прекрасное средство проверки
согласия данных с теоретическим распределением.
Ниже показана эмпирическая функция выживания и
функции из семейства распределений <a href="../glossary/gloss_r.html#Weibull Distribution">Вейбулла</a>. </p>

<p><img BORDER="0" SRC="../popups/popup26.gif" alt="График" WIDTH="306" HEIGHT="218"> </p>

<p>На этом графике три линии обозначают
теоретические распределения, полученнные с
помощью трех различных процедур оценивания
(методом наименьших квадратов и двумя методами
взвешенных наименьших квадратов). </p>

<p>&nbsp;<a NAME="kaplan"></a> </p>

<p><font SIZE="4" COLOR="navy">Множительные оценки
Каплана-Мейера </font></p>

<p>Для цензурированных, но не группированных
наблюдений времен жизни, функцию выживания можно
оценить непосредственно (без таблицы времен
жизни). Представьте, что вы создали файл, в
котором каждое наблюдение содержит точно один
временной интервал. Перемножая вероятности
выживания в каждом интервале, получим следующую
формулу для функции выживания:</p>

<p><font color="blue">S(t) = <img src="../graphics/bigpiblu.gif" align="absmiddle" WIDTH="20" HEIGHT="23"><sub>j</sub><sup>t</sup><sub>=
1</sub> [(n-j)/(n-j+1)]<sup><img src="../graphics/deltablu.gif" WIDTH="15" HEIGHT="17">( j )</sup> </font></p>

<p>В этом выражении <i><font color="blue">S(t)</font> </i>- оценка
функции выживания, <i><font color="blue">n</font> </i>- общее
число событий (времен окончания), <i><font color="blue">j</font>
</i>- порядковый (хронологически) номер отдельного
события, d<i>(j) </i>равно <i>1</i>, если <i><font color="blue">j</font>-</i>ое
событие означает отказ (смерть) и <img SRC="../graphics/deltablu.gif" ALIGN="ABSMIDDLE" WIDTH="15" HEIGHT="17"><i><font color="blue">(j)</font> </i>равно
<i>0</i>, если <i><font color="blue">j</font>-</i>ое событие означает
потерю наблюдения (цензурирование). <img SRC="../graphics/bigpiblu.gif" ALIGN="ABSMIDDLE" WIDTH="20" HEIGHT="23"><i> </i>означает
произведение по всем наблюдениям <font color="blue"><i>j</i></font>,
завершившимся к моменту <font color="blue"><i>t</i></font>.
Данная оценка функции выживания, называемая <i>множительной
оценкой</i>, впервые была предложена Капланом и
Мейером (1958). </p>

<p><img BORDER="0" SRC="../popups/popup27.gif" alt="График" WIDTH="306" HEIGHT="218"></p>

<p>Преимущество метода Каплана-Мейера (по
сравнению с методом таблиц жизни) состоит в том,
что оценки не зависят от разбиения времени
наблюдения на интервалы, т.е. от группировки.
Метод множительных оценок и метод таблиц времен
жизни приводят, по существу, к одинаковым
результатам, если временные интервалы содержат,
максимум, по одному наблюдению. </p>

<table ALIGN="RIGHT">
  <tr>
    <td><font size="1"><a HREF="stsurvan.html#index">В начало</a></font> </td>
  </tr>
</table>

<p><br CLEAR="RIGHT">
&nbsp;<a NAME="comparing"></a> </p>

<p><font SIZE="4" COLOR="navy">Сравнение выборок </font>

<ul>
  <li><a HREF="stsurvan.html#cgeneral">Общее знакомство</a> </li>
  <li><a HREF="stsurvan.html#cavailable">Доступные критерии</a> </li>
  <li><a HREF="stsurvan.html#cchoosing">Выбор двухвыборочного
    критерия</a> </li>
  <li><a HREF="stsurvan.html#cmultiple">Критерий для нескольких
    выборок</a> </li>
  <li><a HREF="stsurvan.html#cunequal">Неравные доли
    цензурированных наблюдений</a> </li>
</ul>

<p><a NAME="cgeneral"></a><br>
<br>
<strong>Общее знакомство.</strong> Можно сравнить
времена жизни или, на техническом языке,
наработки до отказа нескольких выборок. В
принципе, т.к. времена жизни не являются
нормально распределенными, можно использовать
непараметрические тесты, основанные на <i>рангах</i>.
Непараметрические статистики предлагают
широкий набор непараметрических критериев,
которые могли бы быть применены для сравнения
времен жизни; однако эти критерии не
&quot;работают&quot; с <a href="../glossary/gloss_ts.html#Censoring">цензурированными</a>
данными. <br>
<a NAME="cavailable"></a><br>
<strong>Доступные критерии.</strong> В <i>Анализе
выживаемости </i>имеется пять различных (в
основном непараметрических) критериев для
цензурированных данных: обобщенный (Геханом)
критерий Вилкоксона, F-критерий Кокса,
логарифмический ранговый критерий, а также
обобщенный Пето (Peto R.и Peto J.) критерий Вилкоксона.
Большинство этих критериев приводят
соответствующие z-значения (значения
стандартного нормального распределения); эти
z-значения могут быть использованы для
статистической проверки любых различий между
группами. Однако критерии дают надежные
результаты лишь при достаточно больших объемах
выборок. При малых объемах выборок их
&quot;поведение&quot; менее поддается осмыслению. <br>
<a NAME="cchoosing"></a><br>
<strong>Выбор двухвыборочного критерия.</strong> Не
существует твердо установленных рекомендаций по
применению определенных критериев. Однако
известно, что <i>F -</i> критерий Кокса обычно более
мощный, чем критерий Вилкоксона - Гехана, если: 

<ol>
  <li>выборочные объемы малы (то есть объем группы <i>n</i>
    меньше 50); </li>
  <li>если выборки извлекаются из <a href="../glossary/gloss_ae.html#Exponential Distribution">экспоненциального</a>
    распределения или распределения <a href="../glossary/gloss_r.html#Weibull Distribution">Вейбулла</a>; </li>
  <li>если нет <a href="../glossary/gloss_ts.html#Censoring">цензурированных</a>
    наблюдений (см. работу Gehan and Thomas, 1969). </li>
</ol>

<p>В работе Lee, Desu, and Gehan (1975) авторы сравнили
критерий Гехана с некоторыми другими критериями
и показали, что критерий Кокса-Ментела и
логарифмически ранговый критерий являются более
мощным (безотносительно к цензурированию), если
выборки извлечены из <a href="../glossary/gloss_ae.html#Exponential Distribution">экспоненциального</a>
распределения или распределения <a href="../glossary/gloss_r.html#Weibull Distribution">Вейбулла</a>; при этих
условиях между критерием Кокса-Ментела и
логарифмически ранговым критерием почти нет
различия. В работе Ли (Lee (1980)) обсуждается
мощность различных критериев более детально.
Если вас затрудняет выбор определенного
критерия, мы рекомендуем обратиться к этим
работам. <br>
<a NAME="cmultiple"></a><br>
</p>

<p><strong>Критерий для нескольких выборок.</strong>
Многовыборочный критерий представляет собой
развитие критерия Вилкоксона, обобщенного
Геханом, критерия Вилкоксона, обобщенного Пето, и
логарифмически рангового критерия. Сначала
каждому времени жизни приписывается его вклад в
соответствии с процедурой Ментела (Mantel, 1967); далее
на основе этих вкладов (по группам) вычисляется
значение статистики <i>хи-квадрат</i>. Если
выделены только две группы, то критерий
эквивалентен критерию Вилкоксона, обобщенному
Геханом. <br>
<a NAME="cunequal"></a><br>
<strong>Неравные доли цензурированных наблюдений.</strong>
Если сравниваются две или более группы, то важно
проверить доли <a href="../glossary/gloss_ts.html#Censoring">цензурированных</a>
наблюдений в каждой. В частности, в медицинских
исследованиях степень цензурирования может
зависеть, например, от различий в методе лечения:
пациенты, которым стало много лучше или стало
хуже, с большой вероятностью теряются из
наблюдения. Различие в степени цензурирования
может привести к смещению в статистических
выводах.</p>

<table ALIGN="RIGHT">
  <tr>
    <td><font size="1"><a HREF="stsurvan.html#index">В начало</a></font> </td>
  </tr>
</table>

<p><br CLEAR="RIGHT">
&nbsp;<a NAME="regression"></a> </p>

<p><font SIZE="4" COLOR="navy">Регрессионные модели </font>

<ul>
  <li><a HREF="stsurvan.html#rgeneral">Общее знакомство</a> </li>
  <li><a HREF="stsurvan.html#rcox">Модель пропорциональных
    интенсивностей Кокса</a> </li>
  <li><a HREF="stsurvan.html#rcoxwith">Модель пропорциональных
    интенсивностей Кокса с зависящими от времени
    ковариатами</a> </li>
  <li><a HREF="stsurvan.html#rexp">Экспоненциальная регрессия</a> </li>
  <li><a HREF="stsurvan.html#rnormal">Нормальная и логнормальная
    регрессия</a> </li>
  <li><a HREF="stsurvan.html#rstrat">Стратифицированный анализ</a> </li>
</ul>

<p>&nbsp;<a NAME="rgeneral"></a></p>

<p><b><font color="navy">Общее знакомство</font></b></p>

<p>Самая большая проблема медицинских,
биологических или инженерных статистических
исследований состоит в выяснении того, являются
ли некоторые непрерывные переменные связанными
с наблюдаемыми временами жизни. Есть две главные
причины, по которым в таких исследованиях не
может быть непосредственно применена
классическая техника множественной регрессии
(см. <a href="stmulreg.html"><i>Множественная регрессия</i></a>).
Во-первых, времена жизни обычно не являются
нормально распределенными, а это является
серьезным нарушением предположений для
оценивания множественной регрессии по методу
наименьших квадратов. Времена жизни обычно имеют
<a href="../glossary/gloss_ae.html#Exponential Distribution">экспоненциальное</a>
распределение или распределение <a href="../glossary/gloss_r.html#Weibull Distribution">Вейбулла</a>.
Во-вторых имеется проблема с <a href="stsurvan.html#censored">цензурированными</a>,
т.е. незавершенными наблюдениями.</p>

<p>&nbsp;<a NAME="rcox"></a></p>

<p><b><font color="navy">Модель пропорциональных
интенсивностей Кокса</font></b></p>

<p>Модель пропорциональных интенсивностей -
наиболее общая регрессионная модель, поскольку
она не связана с какими-либо предположениями
относительно распределения времени выживания.
Эта модель предполагает, что функция
интенсивности имеет некоторый <i>уровень</i> y<i>,</i>
являющийся функцией независимых переменных.
Никаких предположений о виде функции
интенсивности не делается. Поэтому модель Кокса
может рассматриваться как в некотором смысле
непараметрическая. Модель может быть записана в
следующем виде: </p>

<p><font color="blue">h{(t), (z<sub>1</sub>, z<sub>2</sub>, ..., z<sub>m</sub>)} = h<sub>0</sub>(t)*exp(b<sub>1</sub>*z<sub>1</sub>
+ ... + b<sub>m</sub>*z<sub>m</sub>) </font></p>

<p>где <font color="blue"><i>h(t,...)</i></font> обозначает
результирующую интенсивность, при заданных для
соответствующего наблюдения значениях <i><font color="blue">m</font> </i>ковариат (<font color="blue"><i>z<sub>1</sub></i></font>,
<font color="blue"><i>z<sub>2</sub></i></font>, ..., <font color="blue"><i>z<sub>m</sub></i></font>)
и соответствующем времени жизни (<font color="blue"><i>t</i></font>).
Множитель <font color="blue"><i>h<sub>0</sub>(t)</i></font> называется <i>базовой
функцией интенсивности</i>, она равна
интенсивности в случае, когда все независимые
переменные равны нулю. Можно линеаризовать эту
модель, поделив обе части соотношения на <font color="blue"><i>h<sub>0</sub>(t)</i></font> и взяв натуральный
логарифм от обеих частей: </p>

<p><font color="blue">log[h{(t), (z...)}/h<sub>0</sub>(t)] = b<sub>1</sub>*z<sub>1</sub> +
... + b<sub>m</sub>*z<sub>m</sub> </font></p>

<p>Теперь мы имеем достаточно &quot;простую&quot;
линейную модель, которая легко поддается
изучению. </p>

<p><strong>Предположения.</strong> В то время как никаких
прямых предположений о виде функции
интенсивности ранее не делалось, модельное
уравнение, приведенное выше, подразумевает два
предположения. Во-первых, зависимость между
функцией интенсивности и логлинейной функцией
ковариат является мультипликативной. Это
соотношение называется также <i>предположением
(гипотезой) пропорциональности</i>. Реально оно
означает, что для двух заданных наблюдений с
различными значениями независимых переменных
отношения их функций интенсивности не зависит от
времени (чтобы ослабить это предположение,
используются <i>ковариаты, зависящие от времени</i>;
см. ниже). Второе предположение состоит именно в
логарифмической линейности соотношения между
функцией интенсивности и независимыми
переменными.</p>

<p>&nbsp;<a NAME="rcoxwith"></a></p>

<p><b><font color="navy">Модель пропорциональных
интенсивностей Кокса с зависящими от времени
ковариатами</font></b></p>

<p>Обоснованность предположения
пропорциональности интенсивности часто
подвергается сомнению. Например, рассмотрим
гипотетическое исследование, в котором
ковариатой является категориальная (групповая)
переменная, а именно, индикатор того, подвергнут
некоторый пациент или нет хирургической
операции. Пусть пациент 1 подвергнут операции, в
то время как пациент 2 - нет. Согласно
предположению пропорциональности отношение
функций интенсивностей для обоих пациентов не
зависит от времени и означает, что риск для
пациента, подвергнутого операции, постоянно
более высокий (или более низкий), чем риск
пациента, не подвергнутого операции (при условии,
что оба дожили до рассматриваемого момента).
Однако обычно более реалистична другая модель, а
именно: сразу после операции риск
прооперированного пациента выше, однако при
благоприятном исходе операции с течением
времени убывает и становится меньше риска не
оперированного пациента. В этом случае
предпочтительнее ковариаты, зависящие от
времени. Можно привести много других примеров,
где предположение о пропорциональности
неприемлемо. Так, при изучении физического
здоровья возраст является одним из факторов
выживаемости после хирургической операции. Ясно,
что возраст - более важный предиктор для риска
сразу после операции, чем по прошествии
некоторого времени после операции (например,
после первых признаков выздоровления). В
ускоренных испытаниях на надежность иногда
используют нагрузочную ковариату (например,
уровень напряжения), которую медленно наращивают
со временем вплоть до отказа прибора, например,
до пробоя изоляции; см. Lawless, 1982, стр. 393). В этом
случае влияние ковариаты опять зависит от
времени.</p>

<p><strong>Проверка предположения
пропорциональности.</strong> Как отмечалось в
предыдущих примерах, часто предположение
пропорциональности не выполняется. В таком
случае, можно явно определить ковариаты, как
функции времени. Например, рассмотрим набор
данных, представленных Pike (1966), который состоит из
времен жизни двух групп крыс, одна из которых
была контрольной, а другая была подвергнута
воздействию канцерогена (см. также подобный
пример в работе Lawless, 1982, стр. 393). Предположим, что z
- групповая переменная со значениями <i>1</i> и <i>0</i>
для подвергнутых воздействию и контрольных крыс
соответственно. Тогда можно проводить подгонку
функции интенсивности с помощью модели
пропорциональных интенсивностей вида:</p>

<p><font color="blue">h(t,z) = h<sub>0</sub>(t)*exp{b<sub>1</sub>*z + b<sub>2</sub>*[z*log(t)-5.4]}
</font></p>

<p>Обратите внимание, что функция интенсивности в
момент <font color="blue"><i>t</i></font> есть функция: (1)
базовой функции интенсивности <font color="blue"><i>h<sub>0</sub></i></font>,
(2) ковариаты <i><font color="blue">z</font> </i>и (3) <font color="blue"><i>z</i></font>-кратного
логарифма времени. Заметим, что константа <font color="blue"><i>5.4</i></font> использована здесь только как
нормировка, т.к. среднее логарифма времени жизни
для этого множества данных равно <font color="blue"><i>5.4</i></font>.
Другими словами, структурированный моделью
множитель с ковариатами в каждый момент времени
есть функция ковариаты и времени; таким образом,
влияние ковариаты на выживаемость зависит от
времени; отсюда название - <i>ковариата, зависящая
от времени</i>. Эта модель позволяет использовать
специфический критерий проверки предположения
пропорциональности. Если параметр <font color="blue"><i>b<sub>2</sub></i></font>
статистически значим (например, если он, по
крайней мере, в два раза больше своей стандартной
ошибки), то можно сделать вывод, что ковариаты <font color="blue"><i>z</i></font> действительно зависят от
времени, и поэтому предположение
пропорциональности не выполняется.</p>

<p>&nbsp;<a NAME="rexp"></a> </p>

<p><b><font color="navy">Экспоненциальная регрессия</font></b></p>

<p>В своей основе эта модель предполагает, что
распределение продолжительности жизни является
экспоненциальным и связано со значениями
некоторого множества независимых переменных (<i>z<sub>i</sub></i>).
Параметр интенсивности <a href="../glossary/gloss_ae.html#Exponential Distribution">экспоненциального</a>
распределения выражается в виде: </p>

<p><font color="blue">S(z) = exp(a + b<sub>1</sub>*z<sub>1</sub> + b<sub>2</sub>*z<sub>2</sub>
+ ... + b<sub>m</sub>*z<sub>m</sub>) </font></p>
<i>

<p></i>Здесь <font color="blue"><i>S(z)</i></font> обозначает время
жизни, <font color="blue"><i>a</i></font> - константа, а <font color="blue"><i>b<sub>i</sub></i></font>
- параметры регрессии.</p>

<p><strong>Согласие.</strong> Значение критерия <a href="../glossary/gloss_r.html#Chi-square Distribution"><i>хи-квадрат</i></a>
может быть вычислено как функция логарифма
правдоподобия для модели со всеми оцененными
параметрами (<i>L<sub>1</sub></i>) и логарифма
правдоподобия модели, в которой все ковариаты
обращаются в 0 (<i>L<sub>0</sub></i>). Если значение <i>хи-квадрат</i>
статистически значимо, отвергаем нулевую
гипотезу и принимаем, что независимые переменные
значимо влияют на время жизни.</p>

<p><strong>Стандартная экспоненциальная порядковая
статистика.</strong> Один из способов проверки
предположения экспоненциальности - построение
остатков времен жизни и сравнение их со
значениями стандартных экспоненциальных
порядковых статистик <i>альфа</i>.</p>

<p>&nbsp;<a NAME="rnormal"></a></p>

<p><b><font color="navy">Нормальная и логнормальная
регрессия</font></b></p>

<p>В этой модели предполагается, что времена жизни
(или их логарифмы) имеют <a href="../glossary/gloss_n.html#Normal Distribution">нормальное</a>
распределение. Модель в основном идентична
обычной модели множественной регрессии и может
быть описана следующим образом: </p>

<p><font color="blue">t = a + b<sub>1</sub>*z<sub>1</sub> + b<sub>2</sub>*z<sub>2</sub> +
... + b<sub>m</sub>*z<sub>m</sub> </font></p>

<p>Здесь <i><font color="blue">t</font> </i>означает время жизни.
Если принимается модель логнормальной
регрессии, то <i><font color="blue">t</font> </i>заменяется <i><font color="blue">ln t</font></i>. Модель нормальной регрессии
особенно полезна, поскольку часто данные могут
быть преобразованы в нормальные применением
нормализующих аппроксимаций. Таким образом, в
некотором смысле это наиболее общая
параметрическая модель (в противоположность
модели пропорциональных интенсивностей Кокса,
которая является непараметрической), оценки
которой могут быть получены для большого
разнообразия исходных распределений времен
жизни.</p>

<p><strong>Согласие.</strong> Значение <a href="../glossary/gloss_r.html#Chi-square Distribution"><i>хи-квадрат</i></a>
может быть вычислено как функция логарифма
правдоподобия для модели со всеми независимыми
переменными (<i>L<sub>1</sub></i>) логарифма
правдоподобия для модели, в которой все
независимые переменные заменены 0 (<i>L<sub>0</sub></i>). </p>

<p>&nbsp;<a NAME="rstrat"></a></p>

<p><b><font color="navy">Стратифицированный анализ</font></b></p>

<p>Цель стратифицированного анализа - проверить
гипотезу о том, что одна и та же регрессия
является подходящей для разных групп (данных); то
есть зависимость между выживаемостью и
регрессорами одна и та же для разных групп
данных. При стратифицированном анализе <i>Анализ
выживаемости</i> вначале строит регрессионные
модели отдельно для каждой группы. Сумма
логарифмов правдоподобия для разных моделей
представляет собой логарифм правдоподобия
модели с разными коэффициентами регрессии (и
свободными членами, если требуется) в разных
группах. Далее программа подгоняет требуемую
регрессионную модель ко всем данным обычным
образом, не учитывая разбиение на группы, и
вычисляет общий логарифм правдоподобия. По
разности этих двух логарифмов правдоподобия
проверяется статистическая значимость различия
между группами (с точки зрения <a href="../glossary/gloss_r.html#Chi-square Distribution"><i>хи-квадрат</i></a>
статистики). <br>
<br>
</p>

<hr SIZE="1">

<p align="center"><br>
<img SRC="../stathoms.jpg" ALIGN="LEFT" WIDTH="151" HEIGHT="47"> <br CLEAR="ALL">
<font size="1">(c) Copyright StatSoft, Inc., 1984-2001<br>
STATISTICA является торговой маркой StatSoft, Inc. </font></p>

<hr SIZE="1">
</body>
</html>
